var Ut=Object.defineProperty;var Ht=(e,r,i)=>r in e?Ut(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i;var nt=(e,r,i)=>(Ht(e,typeof r!="symbol"?r+"":r,i),i);import{f as qt,e as rt}from"./index.CqiO7bRi.js";import"./index.BU_Tmytt.js";import{p as Bt,i as pt,a as Se,d as He,w as z,b as Yt,c as ke,g as Gt}from"./entry.nsMzfHyC.js";import{p as pe,n as it}from"./stores.DnxqjrNg.js";import{I as Ce,a0 as Ae,K as me}from"./scheduler.DO4friaV.js";const Wt=!0,mt=Wt;function Le(e,r,i){return e[r]=i,"skip"}function zt(e,r){return r.value!==void 0&&typeof r.value!="object"&&r.path.length<e.length}function ne(e,r,i={}){i.modifier||(i.modifier=o=>zt(r,o)?void 0:o.value);const t=J(e,r,i.modifier);if(t)return i.value===void 0||i.value(t.value)?t:void 0}function J(e,r,i){if(!r.length)return;const t=[r[0]];let o=e;for(;o&&t.length<r.length;){const a=t[t.length-1],c=i?i({parent:o,key:String(a),value:o[a],path:t.map(p=>String(p)),isLeaf:!1,set:p=>Le(o,a,p)}):o[a];if(c===void 0)return;o=c,t.push(r[t.length])}if(!o)return;const u=r[r.length-1];return{parent:o,key:String(u),value:o[u],path:r.map(a=>String(a)),isLeaf:!0,set:a=>Le(o,u,a)}}function ee(e,r,i=[]){for(const t in e){const o=e[t],u=o===null||typeof o!="object",a={parent:e,key:t,value:o,path:i.concat([t]),isLeaf:u,set:p=>Le(e,t,p)},c=r(a);if(c==="abort")return c;if(c==="skip")continue;if(!u){const p=ee(o,r,a.path);if(p==="abort")return p}}}function Jt(e,r){return e===r||e.size===r.size&&[...e].every(i=>r.has(i))}function st(e,r){const i=new Map;function t(a,c){return a instanceof Date&&c instanceof Date&&a.getTime()!==c.getTime()||a instanceof Set&&c instanceof Set&&!Jt(a,c)||a instanceof File&&c instanceof File&&a!==c}function o(a){return a instanceof Date||a instanceof Set||a instanceof File}function u(a,c){const p=c?J(c,a.path):void 0;function d(){return i.set(a.path.join(" "),a.path),"skip"}if(o(a.value)&&(!o(p==null?void 0:p.value)||t(a.value,p.value)))return d();a.isLeaf&&(!p||a.value!==p.value)&&d()}return ee(e,a=>u(a,r)),ee(r,a=>u(a,e)),Array.from(i.values())}function X(e,r,i){const t=typeof i=="function";for(const o of r){const u=J(e,o,({parent:a,key:c,value:p})=>((p===void 0||typeof p!="object")&&(a[c]={}),a[c]));u&&(u.parent[u.key]=t?i(o,u):i)}}function ie(e){return e.toString().split(/[[\].]+/).filter(r=>r)}function ue(e){return e.reduce((r,i)=>{const t=String(i);return typeof i=="number"||/^\d+$/.test(t)?r+=`[${t}]`:r?r+=`.${t}`:r+=t,r},"")}var Kt=ye;function ye(e){let r=e;var i={}.toString.call(e).slice(8,-1);if(i=="Set")return new Set([...e].map(o=>ye(o)));if(i=="Map")return new Map([...e].map(o=>[ye(o[0]),ye(o[1])]));if(i=="Date")return new Date(e.getTime());if(i=="RegExp")return RegExp(e.source,Xt(e));if(i=="Array"||i=="Object"){r=Array.isArray(e)?[]:{};for(var t in e)r[t]=ye(e[t])}return r}function Xt(e){if(typeof e.source.flags=="string")return e.source.flags;var r=[];return e.global&&r.push("g"),e.ignoreCase&&r.push("i"),e.multiline&&r.push("m"),e.sticky&&r.push("y"),e.unicode&&r.push("u"),r.join("")}function x(e){return e&&typeof e=="object"?Kt(e):e}function qe(e,r){if(typeof e=="boolean")throw new _e("Schema property cannot be defined as boolean.",r)}const at=e=>{if(typeof e=="object"&&e!==null){if(typeof Object.getPrototypeOf=="function"){const r=Object.getPrototypeOf(e);return r===Object.prototype||r===null}return Object.prototype.toString.call(e)==="[object Object]"}return!1},Z=(...e)=>e.reduce((r,i)=>{if(Array.isArray(i))throw new TypeError("Arguments provided to ts-deepmerge must be objects, not arrays.");return Object.keys(i).forEach(t=>{["__proto__","constructor","prototype"].includes(t)||(Array.isArray(r[t])&&Array.isArray(i[t])?r[t]=Z.options.mergeArrays?Z.options.uniqueArrayItems?Array.from(new Set(r[t].concat(i[t]))):[...r[t],...i[t]]:i[t]:at(r[t])&&at(i[t])?r[t]=Z(r[t],i[t]):r[t]=i[t]===void 0?Z.options.allowUndefinedOverrides?i[t]:r[t]:i[t])}),r},{}),Re={allowUndefinedOverrides:!0,mergeArrays:!0,uniqueArrayItems:!0};Z.options=Re;Z.withOptions=(e,...r)=>{Z.options=Object.assign(Object.assign({},Re),e);const i=Z(...r);return Z.options=Re,i};const Zt=["unix-time","bigint","any","symbol","set"];function yt(e,r,i){var c;if(qe(e,i),e.allOf&&e.allOf.length)return{...Z.withOptions({allowUndefinedOverrides:!1},...e.allOf.map(p=>yt(p,!1,[]))),schema:e};const t=ht(e,i),o=e.items&&t.includes("array")?(Array.isArray(e.items)?e.items:[e.items]).filter(p=>typeof p!="boolean"):void 0,u=e.properties&&t.includes("object")?Object.fromEntries(Object.entries(e.properties).filter(([,p])=>typeof p!="boolean")):void 0,a=(c=Qt(e))==null?void 0:c.filter(p=>p.type!=="null"&&p.const!==null);return{types:t.filter(p=>p!=="null"),isOptional:r,isNullable:t.includes("null"),schema:e,union:a!=null&&a.length?a:void 0,array:o,properties:u,required:e.required}}function ht(e,r){qe(e,r);let i=e.const===null?["null"]:[];if(e.type&&(i=Array.isArray(e.type)?e.type:[e.type]),e.anyOf&&(i=e.anyOf.flatMap(t=>ht(t,r))),i.includes("array")&&e.uniqueItems){const t=i.findIndex(o=>o!="array");i[t]="set"}else if(e.format&&Zt.includes(e.format)&&(i.unshift(e.format),e.format=="unix-time")){const t=i.findIndex(o=>o=="integer");i.splice(t,1)}return e.const&&e.const!==null&&typeof e.const!="function"&&i.push(typeof e.const),Array.from(new Set(i))}function Qt(e){if(!(!e.anyOf||!e.anyOf.length))return e.anyOf.filter(r=>typeof r!="boolean")}class M extends Error{constructor(r){super(r),Object.setPrototypeOf(this,M.prototype)}}class _e extends M{constructor(i,t){super((t&&t.length?`[${Array.isArray(t)?t.join("."):t}] `:"")+i);nt(this,"path");this.path=Array.isArray(t)?t.join("."):t,Object.setPrototypeOf(this,_e.prototype)}}function en(e,r){var o;const i={};function t(u){if("_errors"in i||(i._errors=[]),!Array.isArray(i._errors))if(typeof i._errors=="string")i._errors=[i._errors];else throw new M("Form-level error was not an array.");i._errors.push(u.message)}for(const u of e){if(!u.path||u.path.length==1&&!u.path[0]){t(u);continue}const c=!/^\d$/.test(String(u.path[u.path.length-1]))&&((o=ne(r,u.path.filter(h=>/\D/.test(String(h)))))==null?void 0:o.value),p=J(i,u.path,({value:h,parent:C,key:S})=>(h===void 0&&(C[S]={}),C[S]));if(!p){t(u);continue}const{parent:d,key:v}=p;c?(v in d||(d[v]={}),"_errors"in d[v]?d[v]._errors.push(u.message):d[v]._errors=[u.message]):v in d?d[v].push(u.message):d[v]=[u.message]}return i}function ot(e,r,i){return i?e:(ee(r,t=>{Array.isArray(t.value)&&t.set(void 0)}),ee(e,t=>{!Array.isArray(t.value)&&t.value!==void 0||X(r,[t.path],t.value)}),r)}function tn(e){return bt(e,[])}function bt(e,r){return Object.entries(e).filter(([,t])=>t!==void 0).flatMap(([t,o])=>{if(Array.isArray(o)&&o.length>0){const u=r.concat([t]);return{path:ue(u),messages:o}}else return bt(e[t],r.concat([t]))})}function ut(e){!e.flashMessage||!mt||xe(e)&&(document.cookie=`flash=; Max-Age=0; Path=${e.flashMessage.cookiePath??"/"};`)}function xe(e){return!e.flashMessage||!mt?!1:e.syncFlashMessage}function nn(e){const r=JSON.parse(e);return r.data&&(r.data=Bt(r.data)),r}function ft(e){return HTMLElement.prototype.cloneNode.call(e)}function rn(e,r=()=>{}){const i=async({action:o,result:u,reset:a=!0,invalidateAll:c=!0})=>{u.type==="success"&&(a&&HTMLFormElement.prototype.reset.call(e),c&&await pt()),(location.origin+location.pathname===o.origin+o.pathname||u.type==="redirect"||u.type==="error")&&Se(u)};async function t(o){var H,q,g,D;if(((H=o.submitter)!=null&&H.hasAttribute("formmethod")?o.submitter.formMethod:ft(e).method)!=="post")return;o.preventDefault();const a=new URL((q=o.submitter)!=null&&q.hasAttribute("formaction")?o.submitter.formAction:ft(e).action),c=new FormData(e),p=(g=o.submitter)==null?void 0:g.getAttribute("name");p&&c.append(p,((D=o.submitter)==null?void 0:D.getAttribute("value"))??"");const d=new AbortController;let v=!1;const C=await r({action:a,cancel:()=>v=!0,controller:d,formData:c,formElement:e,submitter:o.submitter})??i;if(v)return;let S;try{const F=await fetch(a,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:c,signal:d.signal});S=nn(await F.text()),S.type==="error"&&(S.status=F.status)}catch(F){if((F==null?void 0:F.name)==="AbortError")return;S={type:"error",error:F}}C({action:a,formData:c,formElement:e,update:F=>i({action:a,result:S,reset:F==null?void 0:F.reset,invalidateAll:F==null?void 0:F.invalidateAll}),result:S})}return HTMLFormElement.prototype.addEventListener.call(e,"submit",t),{destroy(){HTMLFormElement.prototype.removeEventListener.call(e,"submit",t)}}}const gt="noCustomValidity";async function lt(e,r){"setCustomValidity"in e&&e.setCustomValidity(""),!(gt in e.dataset)&&wt(e,r)}function sn(e,r){for(const i of e.querySelectorAll("input,select,textarea,button")){if(gt in i.dataset)continue;const t=J(r,ie(i.name));if(wt(i,t==null?void 0:t.value),t!=null&&t.value)return}}function wt(e,r){const i=r&&r.length?r.join(`
`):"";e.setCustomValidity(i),i&&e.reportValidity()}const an=(e,r=0)=>{const i=e.getBoundingClientRect();return i.top>=r&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)},on=(e,r=1.125,i="smooth")=>{const u=e.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/(2*r);window.scrollTo({left:0,top:u,behavior:i})},un=["checkbox","radio","range","file"];function ct(e){const r=!!e&&(e instanceof HTMLSelectElement||e instanceof HTMLInputElement&&un.includes(e.type)),i=!!e&&e instanceof HTMLSelectElement&&e.multiple,t=!!e&&e instanceof HTMLInputElement&&e.type=="file";return{immediate:r,multiple:i,file:t}}var k;(function(e){e[e.Idle=0]="Idle",e[e.Submitting=1]="Submitting",e[e.Delayed=2]="Delayed",e[e.Timeout=3]="Timeout"})(k||(k={}));const fn=new Set;function ln(e,r,i){let t=k.Idle,o,u;const a=fn;function c(){p(),v(t!=k.Delayed?k.Submitting:k.Delayed),o=window.setTimeout(()=>{o&&t==k.Submitting&&v(k.Delayed)},i.delayMs),u=window.setTimeout(()=>{u&&t==k.Delayed&&v(k.Timeout)},i.timeoutMs),a.add(p)}function p(){clearTimeout(o),clearTimeout(u),o=u=0,a.delete(p),v(k.Idle)}function d(){a.forEach(g=>g()),a.clear()}function v(g){t=g,r.submitting.set(t>=k.Submitting),r.delayed.set(t>=k.Delayed),r.timeout.set(t>=k.Timeout)}const h=e;function C(g){const D=g.target;i.selectErrorText&&D.select()}function S(){i.selectErrorText&&h.querySelectorAll("input").forEach(g=>{g.addEventListener("invalid",C)})}function H(){i.selectErrorText&&h.querySelectorAll("input").forEach(g=>g.removeEventListener("invalid",C))}const q=e;{S();const g=D=>{D.clearAll?d():p(),D.cancelled||setTimeout(()=>Ve(q,i),1)};return Ae(()=>{H(),g({cancelled:!0})}),{submitting(){c()},completed:g,scrollToFirstError(){setTimeout(()=>Ve(q,i),1)},isSubmitting:()=>t===k.Submitting||t===k.Delayed}}}const Ve=async(e,r)=>{if(r.scrollToError=="off")return;const i=r.errorSelector;if(!i)return;await Ce();let t;if(t=e.querySelector(i),!t)return;t=t.querySelector(i)??t;const o=r.stickyNavbar?document.querySelector(r.stickyNavbar):null;typeof r.scrollToError!="string"?t.scrollIntoView(r.scrollToError):an(t,(o==null?void 0:o.offsetHeight)??0)||on(t,void 0,r.scrollToError);function u(c){return typeof r.autoFocusOnError=="boolean"?r.autoFocusOnError:!/iPhone|iPad|iPod|Android/i.test(c)}if(!u(navigator.userAgent))return;let a;if(a=t,["INPUT","SELECT","BUTTON","TEXTAREA"].includes(a.tagName)||(a=a.querySelector('input:not([type="hidden"]):not(.flatpickr-input), select, textarea')),a)try{a.focus({preventScroll:!0}),r.selectErrorText&&a.tagName=="INPUT"&&a.select()}catch{}};class De extends Error{constructor(r,i){super(r),this.name="DevalueError",this.path=i.join("")}}function dt(e){return Object(e)!==e}const cn=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function dn(e){const r=Object.getPrototypeOf(e);return r===Object.prototype||r===null||Object.getOwnPropertyNames(r).sort().join("\0")===cn}function pn(e){return Object.prototype.toString.call(e).slice(8,-1)}function mn(e){switch(e){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e<" "?`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function le(e){let r="",i=0;const t=e.length;for(let o=0;o<t;o+=1){const u=e[o],a=mn(u);a&&(r+=e.slice(i,o)+a,i=o+1)}return`"${i===0?e:r+e.slice(i)}"`}const vt=-1,yn=-2,hn=-3,bn=-4,gn=-5,Et=-6;function wn(e,r){const i=[],t=new Map,o=[];for(const d in r)o.push({key:d,fn:r[d]});const u=[];let a=0;function c(d){if(typeof d=="function")throw new De("Cannot stringify a function",u);if(t.has(d))return t.get(d);if(d===void 0)return vt;if(Number.isNaN(d))return hn;if(d===1/0)return bn;if(d===-1/0)return gn;if(d===0&&1/d<0)return Et;const v=a++;t.set(d,v);for(const{key:C,fn:S}of o){const H=S(d);if(H)return i[v]=`["${C}",${c(H)}]`,v}let h="";if(dt(d))h=Ne(d);else switch(pn(d)){case"Number":case"String":case"Boolean":h=`["Object",${Ne(d)}]`;break;case"BigInt":h=`["BigInt",${d}]`;break;case"Date":h=`["Date","${!isNaN(d.getDate())?d.toISOString():""}"]`;break;case"RegExp":const{source:H,flags:q}=d;h=q?`["RegExp",${le(H)},"${q}"]`:`["RegExp",${le(H)}]`;break;case"Array":h="[";for(let g=0;g<d.length;g+=1)g>0&&(h+=","),g in d?(u.push(`[${g}]`),h+=c(d[g]),u.pop()):h+=yn;h+="]";break;case"Set":h='["Set"';for(const g of d)h+=`,${c(g)}`;h+="]";break;case"Map":h='["Map"';for(const[g,D]of d)u.push(`.get(${dt(g)?Ne(g):"..."})`),h+=`,${c(g)},${c(D)}`,u.pop();h+="]";break;default:if(!dn(d))throw new De("Cannot stringify arbitrary non-POJOs",u);if(Object.getOwnPropertySymbols(d).length>0)throw new De("Cannot stringify POJOs with symbolic keys",u);if(Object.getPrototypeOf(d)===null){h='["null"';for(const g in d)u.push(`.${g}`),h+=`,${le(g)},${c(d[g])}`,u.pop();h+="]"}else{h="{";let g=!1;for(const D in d)g&&(h+=","),g=!0,u.push(`.${D}`),h+=`${le(D)}:${c(d[D])}`,u.pop();h+="}"}}return i[v]=h,v}const p=c(e);return p<0?`${p}`:`[${i.join(",")}]`}function Ne(e){const r=typeof e;return r==="string"?le(e):e instanceof String?le(e.toString()):e===void 0?vt.toString():e===0&&1/e<0?Et.toString():r==="bigint"?`["BigInt","${e}"]`:String(e)}function Te(e,r,i){const t=J(e,r,({parent:o,key:u,value:a})=>(a===void 0&&(o[u]=/\D/.test(u)?{}:[]),o[u]));if(t){const o=i(t.value);t.parent[t.key]=o}return e}function vn(e,r,i){const t=e.form,o=ie(r),u=He(t,a=>{const c=J(a,o);return c==null?void 0:c.value});return{subscribe(...a){const c=u.subscribe(...a);return()=>c()},update(a,c){t.update(p=>Te(p,o,a),c??i)},set(a,c){t.update(p=>Te(p,o,()=>a),c??i)}}}function En(e,r){const i="form"in e;if(!i&&(r==null?void 0:r.taint)!==void 0)throw new M("If options.taint is set, the whole superForm object must be used as a proxy.");return i}function ve(e,r,i){const t=ie(r);if(En(e,i))return vn(e,r,i);const o=He(e,u=>{const a=J(u,t);return a==null?void 0:a.value});return{subscribe(...u){const a=o.subscribe(...u);return()=>a()},update(u){e.update(a=>Te(a,t,u))},set(u){e.update(a=>Te(a,t,()=>u))}}}function Dn(e,r=[]){const i=$e(e,r);if(!i)throw new _e("No shape could be created for schema.",r);return i}function $e(e,r){qe(e,r);const i=yt(e,!1,r);if(i.array||i.union){const t=i.array||[],o=i.union||[];return t.concat(o).reduce((u,a)=>{const c=$e(a,r);return c&&(u={...u??{},...c}),u},t.length?{}:void 0)}if(i.properties){const t={};for(const[o,u]of Object.entries(i.properties)){const a=$e(u,[...r,o]);a&&(t[o]=a)}return t}return i.types.includes("array")||i.types.includes("object")?{}:void 0}function Ue(e){let r={};const i=Array.isArray(e);for(const[t,o]of Object.entries(e))!o||typeof o!="object"||(i?r={...r,...Ue(o)}:r[t]=Ue(o));return r}const Ee=new WeakMap,oe=new WeakMap,St=e=>{console.warn("Unhandled error caught by Superforms, use onError event to handle it:",e.result.error)},Sn={applyAction:!0,invalidateAll:!0,resetForm:!0,autoFocusOnError:"detect",scrollToError:"smooth",errorSelector:'[aria-invalid="true"],[data-invalid]',selectErrorText:!1,stickyNavbar:void 0,taintedMessage:!1,onSubmit:void 0,onResult:void 0,onUpdate:void 0,onUpdated:void 0,onError:St,dataType:"form",validators:void 0,customValidity:!1,clearOnSubmit:"message",delayMs:500,timeoutMs:8e3,multipleSubmits:"prevent",SPA:void 0,validationMethod:"auto"};function An(e){return`Duplicate form id's found: "${e}". Multiple forms will receive the same data. Use the id option to differentiate between them, or if this is intended, set the warnings.duplicateId option to false in superForm to disable this warning. More information: https://superforms.rocks/concepts/multiple-forms`}let At=!1;try{SUPERFORMS_LEGACY&&(At=!0)}catch{}let fe=!1;try{globalThis.STORIES&&(fe=!0)}catch{}function Nn(e,r){var tt;let i,t=r??{},o;{if((t.legacy??At)&&(t.resetForm===void 0&&(t.resetForm=!1),t.taintedMessage===void 0&&(t.taintedMessage=!0)),fe&&t.applyAction===void 0&&(t.applyAction=!1),typeof t.SPA=="string"&&(t.invalidateAll===void 0&&(t.invalidateAll=!1),t.applyAction===void 0&&(t.applyAction=!1)),o=t.validators,t={...Sn,...t},(t.SPA===!0||typeof t.SPA=="object")&&t.validators===void 0&&console.warn("No validators set for superForm in SPA mode. Add a validation adapter to the validators option, or set it to false to disable this warning."),!e)throw new M("No form data sent to superForm. Make sure the output from superValidate is used (usually data.form) and that it's not null or undefined. Alternatively, an object with default values for the form can also be used, but then constraints won't be available.");d(e)===!1&&(e={id:t.id??Math.random().toString(36).slice(2,10),valid:!1,posted:!1,errors:{},data:e,shape:Ue(e)}),e=e;const n=e.id=t.id??e.id,s=me(pe)??(fe?{}:void 0);if(((tt=t.warnings)==null?void 0:tt.duplicateId)!==!1)if(!Ee.has(s))Ee.set(s,new Set([n]));else{const f=Ee.get(s);f!=null&&f.has(n)?console.warn(An(n)):f==null||f.add(n)}if(oe.has(e)||oe.set(e,e),i=oe.get(e),e=x(i),Ae(()=>{var f;Ct(),Ft(),xt();for(const l of Object.values(B))l.length=0;(f=Ee.get(s))==null||f.delete(n)}),t.dataType!=="json"){const f=(l,m)=>{if(!(!m||typeof m!="object")){if(Array.isArray(m))m.length>0&&f(l,m[0]);else if(!(m instanceof Date)&&!(m instanceof File)&&!(m instanceof FileList))throw new M(`Object found in form field "${l}". Set the dataType option to "json" and add use:enhance to use nested data structures. More information: https://superforms.rocks/concepts/nested-data`)}};for(const[l,m]of Object.entries(e.data))f(l,m)}}const u={formId:e.id,form:x(e.data),constraints:e.constraints??{},posted:e.posted,errors:x(e.errors),message:x(e.message),tainted:void 0,valid:e.valid,submitting:!1,shape:e.shape},a=u,c=z(t.id??e.id);function p(n){return Object.values(n).filter(f=>d(f)!==!1)}function d(n){return!n||typeof n!="object"||!("valid"in n&&"errors"in n&&typeof n.valid=="boolean")?!1:"id"in n&&typeof n.id=="string"?n.id:!1}const v=z(e.data),h={subscribe:v.subscribe,set:(n,s={})=>{const f=x(n);return Ke(f,s.taint??!0),v.set(f)},update:(n,s={})=>v.update(f=>{const l=n(f);return Ke(l,s.taint??!0),l})};function C(){return t.SPA===!0||typeof t.SPA=="object"}async function S(n={}){const s=n.formData??a.form;let f={},l;const m=n.adapter??t.validators;if(typeof m=="object"){if(m!=o&&!("jsonSchema"in m))throw new M('Client validation adapter found in options.validators. A full adapter must be used when changing validators dynamically, for example "zod" instead of "zodClient".');if(l=await m.validate(s),!l.success)f=en(l.issues,m.shape??a.shape??{});else if(n.recheckValidData!==!1)return S({...n,recheckValidData:!1})}else l={success:!0,data:{}};const y={...a.form,...s,...l.success?l.data:{}};return{valid:l.success,posted:!1,errors:f,data:y,constraints:a.constraints,message:void 0,id:a.formId,shape:a.shape}}function H(n){if(!t.onChange||!n.paths.length||n.type=="blur")return;let s;const f=n.paths.map(ue);n.type&&n.paths.length==1&&n.formElement&&n.target instanceof Element?s={path:f[0],paths:f,formElement:n.formElement,target:n.target,set(l,m,y){ve({form:h},l,y).set(m)},get(l){return me(ve(h,l))}}:s={paths:f,target:void 0,set(l,m,y){ve({form:h},l,y).set(m)},get(l){return me(ve(h,l))}},t.onChange(s)}async function q(n,s=!1,f){n&&(t.validators=="clear"&&G.update(y=>(X(y,n.paths,void 0),y)),setTimeout(()=>H(n)));let l=!1;if(s||(t.validationMethod=="onsubmit"||t.validationMethod=="submit-only"||t.validationMethod=="onblur"&&(n==null?void 0:n.type)=="input"||t.validationMethod=="oninput"&&(n==null?void 0:n.type)=="blur")&&(l=!0),l||!n||!t.validators||t.validators=="clear"){if(n!=null&&n.paths){const y=(n==null?void 0:n.formElement)??ce();y&&g(y,n.paths)}return}const m=await S({adapter:f});return m.valid&&(n.immediate||n.type!="input")&&h.set(m.data,{taint:"ignore"}),await Ce(),D(m.errors,n,s),m}function g(n,s){const f=new Map;if(t.customValidity&&n)for(const l of s){const m=CSS.escape(ue(l)),y=n.querySelector(`[name="${m}"]`);if(y){const I="validationMessage"in y?String(y.validationMessage):"";f.set(l.join("."),{el:y,message:I}),lt(y,void 0)}}return f}async function D(n,s,f){const{type:l,immediate:m,multiple:y,paths:I}=s,Y=a.errors,_={};let W=new Map;const V=s.formElement??ce();V&&(W=g(V,s.paths)),ee(n,R=>{if(!Array.isArray(R.value))return;const $=[...R.path];$[$.length-1]=="_errors"&&$.pop();const ae=$.join(".");function Q(){if(X(_,[R.path],R.value),t.customValidity&&re&&W.has(ae)){const{el:b,message:w}=W.get(ae);w!=R.value&&(lt(b,R.value),W.clear())}}if(f)return Q();const we=R.path[R.path.length-1]=="_errors",re=R.value&&I.some(b=>we?$&&b&&$.length>0&&$[0]==b[0]:ae==b.join("."));if(re&&t.validationMethod=="oninput"||m&&!y&&re)return Q();if(y){const b=ne(me(G),R.path.slice(0,-1));if(b!=null&&b.value&&typeof(b==null?void 0:b.value)=="object"){for(const w of Object.values(b.value))if(Array.isArray(w))return Q()}}const E=ne(Y,R.path);if(E&&E.key in E.parent)return Q();if(we){if(t.validationMethod=="oninput"||l=="blur"&&kt(ue(R.path.slice(0,-1))))return Q()}else if(l=="blur"&&re)return Q()}),G.set(_)}function F(n,s={}){return s.keepFiles&&ee(a.form,f=>{if(!(f.parent instanceof FileList)&&(f.value instanceof File||f.value instanceof FileList)){const l=ne(n,f.path);(!l||!(l.key in l.parent))&&X(n,[f.path],f.value)}}),h.set(n,s)}function he(n,s){return n&&s&&t.resetForm&&(t.resetForm===!0||t.resetForm())}async function Be(n,s){n.valid&&s&&he(n.valid,s)?Oe({message:n.message,posted:!0}):ge({form:n,untaint:s,keepFiles:!0,skipFormData:t.invalidateAll=="force"}),B.onUpdated.length&&await Ce();for(const f of B.onUpdated)f({form:n})}function Oe(n={}){n.newState&&(i.data={...i.data,...n.newState});const s=x(i);s.data={...s.data,...n.data},n.id!==void 0&&(s.id=n.id),ge({form:s,untaint:!0,message:n.message,keepFiles:!1,posted:n.posted})}async function _t(n){if(n.type=="error")throw new M(`ActionResult of type "${n.type}" cannot be passed to update function.`);if(n.type=="redirect"){he(!0,!0)&&Oe({posted:!0});return}if(typeof n.data!="object")throw new M("Non-object validation data returned from ActionResult.");const s=p(n.data);if(!s.length)throw new M("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const f of s)f.id===a.formId&&await Be(f,n.status>=200&&n.status<300)}const se=z(u.message),Me=z(u.constraints),Fe=z(u.posted),Ye=z(u.shape),je=z(e.errors),G={subscribe:je.subscribe,set(n,s){return je.set(ot(n,a.errors,s==null?void 0:s.force))},update(n,s){return je.update(f=>ot(n(f),a.errors,s==null?void 0:s.force))},clear:()=>G.set({})};let T=null;function Ot(n){var s;T&&n&&Object.keys(n).length==1&&((s=n.paths)!=null&&s.length)&&T.target&&T.target instanceof HTMLInputElement&&T.target.type.toLowerCase()=="file"?T.paths=n.paths:T=n,setTimeout(()=>{q(T)},0)}function Mt(n,s,f,l,m){T===null&&(T={paths:[]}),T.type=n,T.immediate=s,T.multiple=f,T.formElement=l,T.target=m}function Ge(){return(T==null?void 0:T.paths)??[]}function Ft(){T=null}const j={defaultMessage:"Leave page? Changes that you made may not be saved.",state:z(),message:t.taintedMessage,clean:x(e.data),forceRedirection:!1};function We(){return t.taintedMessage&&!a.submitting&&!j.forceRedirection&&Je()}function ze(n){if(!We())return;n.preventDefault(),n.returnValue="";const{taintedMessage:s}=t,l=typeof s=="function"||s===!0?j.defaultMessage:s;return(n||window.event).returnValue=l||j.defaultMessage,l}async function jt(n){if(!We())return;const{taintedMessage:s}=t,f=typeof s=="function";if(f&&n.cancel(),n.type==="leave")return;const l=f||s===!0?j.defaultMessage:s;let m;try{m=f?await s():window.confirm(l||j.defaultMessage)}catch{m=!1}if(m&&n.to)try{j.forceRedirection=!0,await Gt(n.to.url,{...n.to.params});return}finally{j.forceRedirection=!1}else!m&&!f&&n.cancel()}function It(){t.taintedMessage=j.message}function Pt(){return j.state}function kt(n){if(!a.tainted)return!1;if(!n)return!!a.tainted;const s=ne(a.tainted,ie(n));return!!s&&s.key in s.parent}function Je(n){if(typeof n=="boolean")return n;if(typeof n=="object")return be(n);if(!a.tainted)return!1;if(!n)return be(a.tainted);const s=ne(a.tainted,ie(n));return be(s==null?void 0:s.value)}function be(n){if(!n)return!1;if(typeof n=="object"){for(const s of Object.values(n))if(be(s))return!0}return n===!0}function Ke(n,s){if(s=="ignore")return;const f=st(n,a.form),l=st(n,j.clean).map(m=>m.join());f.length&&(s=="untaint-all"||s=="untaint-form"?j.state.set(void 0):j.state.update(m=>(m||(m={}),X(m,f,(y,I)=>{if(!l.includes(y.join()))return;const Y=J(n,y),_=J(j.clean,y);return Y&&_&&Y.value===_.value?void 0:s===!0?!0:s==="untaint"?void 0:I.value}),m))),Ot({paths:f})}function Dt(n,s){j.state.set(n),s&&(j.clean=s)}const Ie=z(!1),Xe=z(!1),Ze=z(!1),Qe=[j.state.subscribe(n=>u.tainted=x(n)),h.subscribe(n=>u.form=x(n)),G.subscribe(n=>u.errors=x(n)),c.subscribe(n=>u.formId=n),Me.subscribe(n=>u.constraints=n),Fe.subscribe(n=>u.posted=n),se.subscribe(n=>u.message=n),Ie.subscribe(n=>u.submitting=n),Ye.subscribe(n=>u.shape=n)];function Nt(n){Qe.push(n)}function Ct(){Qe.forEach(n=>n())}let L;function ce(){return L}function Lt(n){L=document.createElement("form"),L.method="POST",L.action=n,et(L),document.body.appendChild(L)}function Rt(n){L&&(L.action=n)}function xt(){L!=null&&L.parentElement&&L.remove(),L=void 0}const Vt=He(G,n=>n?tn(n):[]);t.taintedMessage=void 0;function ge(n){const s=n.form,f=n.message??s.message;if(n.untaint&&Dt(typeof n.untaint=="boolean"?void 0:n.untaint,s.data),n.skipFormData!==!0&&F(s.data,{taint:"ignore",keepFiles:n.keepFiles}),se.set(f),G.set(s.errors),c.set(s.id),Fe.set(n.posted??s.posted),s.constraints&&Me.set(s.constraints),s.shape&&Ye.set(s.shape),u.valid=s.valid,t.flashMessage&&xe(t)){const l=t.flashMessage.module.getFlash(pe);f&&me(l)===void 0&&l.set(f)}}const B={onSubmit:t.onSubmit?[t.onSubmit]:[],onResult:t.onResult?[t.onResult]:[],onUpdate:t.onUpdate?[t.onUpdate]:[],onUpdated:t.onUpdated?[t.onUpdated]:[],onError:t.onError?[t.onError]:[]};window.addEventListener("beforeunload",ze),Ae(()=>{window.removeEventListener("beforeunload",ze)}),Yt(jt),Nt(pe.subscribe(async n=>{fe&&n===void 0&&(n={status:200});const s=n.status>=200&&n.status<300;if(t.applyAction&&n.form&&typeof n.form=="object"){const f=n.form;if(f.type=="error")return;for(const l of p(f)){const m=oe.has(l);l.id!==a.formId||m||(oe.set(l,l),await Be(l,s))}}else if(n.data&&typeof n.data=="object")for(const f of p(n.data)){const l=oe.has(f);f.id!==a.formId||l||(t.invalidateAll==="force"&&(i.data=f.data),ge({form:f,untaint:s,keepFiles:!he(!0,!0)}))}})),typeof t.SPA=="string"&&Lt(t.SPA);function et(n,s){if(t.SPA!==void 0&&n.method=="get"&&(n.method="post"),typeof t.SPA=="string"?t.SPA.length&&n.action==document.location.href&&(n.action=t.SPA):L=n,s){if(s.onError){if(t.onError==="apply")throw new M('options.onError is set to "apply", cannot add any onError events.');if(s.onError==="apply")throw new M('Cannot add "apply" as onError event in use:enhance.');B.onError.push(s.onError)}s.onResult&&B.onResult.push(s.onResult),s.onSubmit&&B.onSubmit.push(s.onSubmit),s.onUpdate&&B.onUpdate.push(s.onUpdate),s.onUpdated&&B.onUpdated.push(s.onUpdated)}It();let f;async function l(Y){const _=ct(Y.target);_.immediate&&!_.file&&await new Promise(W=>setTimeout(W,0)),f=Ge(),Mt("input",_.immediate,_.multiple,n,Y.target??void 0)}async function m(Y){if(a.submitting||!f||Ge()!=f)return;const _=ct(Y.target);_.immediate&&!_.file&&await new Promise(W=>setTimeout(W,0)),q({paths:f,immediate:_.multiple,multiple:_.multiple,type:"blur",formElement:n,target:Y.target??void 0}),f=void 0}n.addEventListener("focusout",m),n.addEventListener("input",l),Ae(()=>{n.removeEventListener("focusout",m),n.removeEventListener("input",l)});const y=ln(n,{submitting:Ie,delayed:Xe,timeout:Ze},t);let I;return rn(n,async Y=>{let _,W=t.validators;const V={...Y,jsonData(E){if(t.dataType!=="json")throw new M("options.dataType must be set to 'json' to use jsonData.");_=E},validators(E){W=E}},R=V.cancel;let $=!1;function ae(E){var K;const b={...E,posted:!0},w=b.valid?200:(typeof t.SPA=="boolean"||typeof t.SPA=="string"||(K=t.SPA)==null?void 0:K.failStatus)??400,P={form:b},N=b.valid?{type:"success",status:w,data:P}:{type:"failure",status:w,data:P};setTimeout(()=>re({result:N}),0)}function Q(){switch(t.clearOnSubmit){case"errors-and-message":G.clear(),se.set(void 0);break;case"errors":G.clear();break;case"message":se.set(void 0);break}}function de(E={resetTimers:!0}){return $=!0,E.resetTimers&&y.isSubmitting()&&y.completed({cancelled:$}),R()}if(V.cancel=de,y.isSubmitting()&&t.multipleSubmits=="prevent")de({resetTimers:!1});else{y.isSubmitting()&&t.multipleSubmits=="abort"&&I&&I.abort(),y.submitting(),I=V.controller;for(const E of B.onSubmit)await E(V)}if($&&t.flashMessage&&ut(t),!$){const E=!C()&&(n.noValidate||(V.submitter instanceof HTMLButtonElement||V.submitter instanceof HTMLInputElement)&&V.submitter.formNoValidate);let b;const w=async()=>await S({adapter:W});if(Q(),E||(b=await w(),b.valid||(de({resetTimers:!1}),ae(b))),!$){t.flashMessage&&(t.clearOnSubmit=="errors-and-message"||t.clearOnSubmit=="message")&&xe(t)&&t.flashMessage.module.getFlash(pe).set(void 0);const P="formData"in V?V.formData:V.data;if(f=void 0,C())b||(b=await w()),de({resetTimers:!1}),ae(b);else if(t.dataType==="json"){b||(b=await w());const N=x(_??b.data);ee(N,O=>{if(O.value instanceof File){const A="__superform_file_"+ue(O.path);return P.append(A,O.value),O.set(void 0)}else if(Array.isArray(O.value)&&O.value.length&&O.value.every(A=>A instanceof File)){const A="__superform_files_"+ue(O.path);for(const U of O.value)P.append(A,U);return O.set(void 0)}}),Object.keys(N).forEach(O=>{typeof P.get(O)=="string"&&P.delete(O)});const K=we(wn(N),t.jsonChunkSize??5e5);for(const O of K)P.append("__superform_json",O)}if(!P.has("__superform_id")){const N=a.formId;N!==void 0&&P.set("__superform_id",N)}typeof t.SPA=="string"&&Rt(t.SPA)}}function we(E,b){const w=Math.ceil(E.length/b),P=new Array(w);for(let N=0,K=0;N<w;++N,K+=b)P[N]=E.substring(K,K+b);return P}async function re(E){var O;let b=!1;I=null;let w="type"in E.result&&"status"in E.result?E.result:{type:"error",status:parseInt(String(E.result.status))||500,error:E.result.error instanceof Error?E.result.error:E.result};const P=()=>b=!0,N={result:w,formEl:n,formElement:n,cancel:P},K=fe||!C()?()=>{}:it.subscribe(A=>{var U,te;!A||((U=A.from)==null?void 0:U.route.id)===((te=A.to)==null?void 0:te.route.id)||P()});for(const A of B.onResult)await A(N);if(w=N.result,!b){if((w.type==="success"||w.type=="failure")&&w.data){const A=p(w.data);if(!A.length)throw new M("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const U of A){if(U.id!==a.formId)continue;const te={form:U,formEl:n,formElement:n,cancel:()=>b=!0,result:w};for(const Pe of B.onUpdate)await Pe(te);w=te.result,b||(t.customValidity&&sn(n,te.form.errors),he(te.form.valid,w.type=="success")&&te.formElement.querySelectorAll('input[type="file"]').forEach(Pe=>Pe.value=""))}}if(!b){if(w.type!=="error")w.type==="success"&&t.invalidateAll&&await pt(),t.applyAction?await Se(w):await _t(w);else{if(t.applyAction)if(t.onError=="apply")await Se(w);else{const A={type:"failure",status:Math.floor(w.status||500),data:w};await Se(A)}if(t.onError!=="apply"){const A={result:w,message:se};for(const U of B.onError)U!=="apply"&&(U!=St||!((O=t.flashMessage)!=null&&O.onError))&&await U(A)}}t.flashMessage&&w.type=="error"&&t.flashMessage.onError&&await t.flashMessage.onError({result:w,flashMessage:t.flashMessage.module.getFlash(pe)})}}if(b&&t.flashMessage&&ut(t),b||w.type!="redirect")y.completed({cancelled:b});else if(fe)y.completed({cancelled:b,clearAll:!0});else{const A=it.subscribe(U=>{U||(setTimeout(()=>{try{A&&A()}catch{}}),y.isSubmitting()&&y.completed({cancelled:b,clearAll:!0}))})}K()}return re})}function $t(n){const s=[];if(ee(n,l=>{if(l.value instanceof File)return s.push(l.path),"skip";if(Array.isArray(l.value)&&l.value.length&&l.value.every(m=>m instanceof File))return s.push(l.path),"skip"}),!s.length)return{data:n,paths:s};const f=x(n);return X(f,s,l=>{var m;return(m=ne(i.data,l))==null?void 0:m.value}),{data:f,paths:s}}return{form:h,formId:c,errors:G,message:se,constraints:Me,tainted:Pt(),submitting:ke(Ie),delayed:ke(Xe),timeout:ke(Ze),options:t,capture(){const{data:n,paths:s}=$t(a.form);let f=a.tainted;return s.length&&(f=x(f)??{},X(f,s,!1)),{valid:a.valid,posted:a.posted,errors:a.errors,data:n,constraints:a.constraints,message:a.message,id:a.formId,tainted:f,shape:a.shape}},restore:n=>{ge({form:n,untaint:n.tainted??!0})},async validate(n,s={}){if(!t.validators)throw new M("options.validators must be set to use the validate method.");s.update===void 0&&(s.update=!0),s.taint===void 0&&(s.taint=!1),typeof s.errors=="string"&&(s.errors=[s.errors]);let f;const l=ie(n);"value"in s?s.update===!0||s.update==="value"?(h.update(I=>(X(I,[l],s.value),I),{taint:s.taint}),f=a.form):(f=x(a.form),X(f,[l],s.value)):f=a.form;const m=await S({formData:f}),y=ne(m.errors,l);return y&&y.value&&s.errors&&(y.value=s.errors),(s.update===!0||s.update=="errors")&&G.update(I=>(X(I,[l],y==null?void 0:y.value),I)),y==null?void 0:y.value},async validateForm(n={}){if(!t.validators&&!n.schema)throw new M("options.validators or the schema option must be set to use the validateForm method.");const s=n.update?await q({paths:[]},!0,n.schema):S({adapter:n.schema}),f=ce();return n.update&&f&&setTimeout(()=>{f&&Ve(f,{...t,scrollToError:n.focusOnError===!1?"off":t.scrollToError})},1),s||S({adapter:n.schema})},allErrors:Vt,posted:Fe,reset(n){return Oe({message:n!=null&&n.keepMessage?a.message:void 0,data:n==null?void 0:n.data,id:n==null?void 0:n.id,newState:n==null?void 0:n.newState})},submit(n){const s=ce()?ce():n&&n instanceof HTMLElement?n.closest("form"):void 0;if(!s)throw new M("use:enhance must be added to the form to use submit, or pass a HTMLElement inside the form (or the form itself) as an argument.");if(!s.requestSubmit)return s.submit();const f=n&&(n instanceof HTMLButtonElement&&n.type=="submit"||n instanceof HTMLInputElement&&["submit","image"].includes(n.type));s.requestSubmit(f?n:void 0)},isTainted:Je,enhance:et}}let Tn=!1;try{SUPERFORMS_LEGACY&&(Tn=!0)}catch{}function _n(e,r,i,t){t===void 0&&(t={});const o=Array.isArray(i)?i:[i];if(e.errors||(e.errors={}),r===null||r==="")e.errors._errors||(e.errors._errors=[]),e.errors._errors=t.overwrite?o:e.errors._errors.concat(o);else{const a=ie(r),c=J(e.errors,a,({parent:p,key:d,value:v})=>(v===void 0&&(p[d]={}),p[d]));c&&(c.parent[c.key]=Array.isArray(c.value)&&!t.overwrite?c.value.concat(o):o)}e.valid=!1;const u=t.removeFiles===!1?{form:e}:Tt({form:e});return qt(t.status??400,u)}function Tt(e){if(typeof e!="object")return e;for(const r in e){const i=e[r];i instanceof File?delete e[r]:i&&typeof i=="object"&&Tt(i)}return e}function Cn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}async function Ln(e,r){const i=await e("/api/testruns/"+r).then(o=>(o.ok||rt(o.status,o.statusText),o.json())),t=await e("/api/testruns/measurements/"+i.id).then(o=>(o.ok||rt(o.status,o.statusText),o.json()));return{run:i,measurements:t}}async function Rn(e,r,i){let t="POST";return r.data.id&&(e+="/"+r.data.id,t="PUT"),await On(t,e,r,i)}async function On(e,r,i,t){let o="/api/"+r;const u=await fetch(o,{headers:{"Content-Type":"application/json"},method:e,body:JSON.stringify(t||i.data)}),a=await u.json();if(console.log(u),!u.ok)if(u.status==422)"error"in a&&"type"in a.error&&(a.error.type=="unique_violation"?_n(i,a.error.field,"An entry with this value already exists"):console.log("TODO: implement this error type"));else throw new Error("TODO");return a}export{_e as S,qe as a,M as b,Dn as c,Cn as d,Nn as e,Rn as f,Ln as g,On as h,Z as m,yt as s};
