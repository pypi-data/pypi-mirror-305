import{e as le}from"../chunks/index.CDaw0oyz.js";import{s as se,e as v,a as I,c as g,b as A,f,g as D,p as O,q as y,i as w,h as _,w as J,n as T,x as xe,k as Y,J as je,t as X,d as G,j as fe,r as ve}from"../chunks/scheduler.C2stUBFB.js";import{S as oe,i as re,b as Z,d as ee,m as te,a as V,t as F,e as ne,c as ge,g as ke}from"../chunks/index.DZ7RTCBW.js";import{w as Se,r as Pe,g as ye}from"../chunks/entry.B0jkFxvj.js";import{c as E,a as ce,S as Te}from"../chunks/SimpleTable.DIjwKG4a.js";import{g as $e}from"../chunks/stores.B9dGorOJ.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.B34LZcCf.js";import{I as we,P as Ne,T as Ee}from"../chunks/Icon.Byo3hxh-.js";import{g as Ie}from"../chunks/stores.BdfEXcca.js";const De=async({fetch:r,params:e})=>{const n=await r("/api/projects/"+e.slug).then(t=>(t.ok||le(t.status,t.statusText),t.json()));return{testruns:await r("/api/testruns/project/"+n.id).then(t=>(t.ok||le(t.status,t.statusText),t.json())),specifications:await r("/api/specifications/project/"+n.id).then(t=>(t.ok||le(t.status,t.statusText),t.json())),project:n}},lt=Object.freeze(Object.defineProperty({__proto__:null,load:De},Symbol.toStringTag,{value:"Module"})),R=Se([]),ue=Se(new Set);function Ue(r){let e,n,t,o,s,a="Edit",d,u,p,c,i,l,C="Delete",$,m,j;return t=new we({props:{size:"12",src:Ne}}),c=new we({props:{size:"12",src:Ee}}),{c(){e=v("button"),n=v("span"),Z(t.$$.fragment),o=I(),s=v("span"),s.textContent=a,d=I(),u=v("button"),p=v("span"),Z(c.$$.fragment),i=I(),l=v("span"),l.textContent=C,this.h()},l(h){e=g(h,"BUTTON",{class:!0});var x=A(e);n=g(x,"SPAN",{});var L=A(n);ee(t.$$.fragment,L),L.forEach(f),o=D(x),s=g(x,"SPAN",{"data-svelte-h":!0}),O(s)!=="svelte-bi7592"&&(s.textContent=a),x.forEach(f),d=D(h),u=g(h,"BUTTON",{class:!0});var z=A(u);p=g(z,"SPAN",{});var U=A(p);ee(c.$$.fragment,U),U.forEach(f),i=D(z),l=g(z,"SPAN",{"data-svelte-h":!0}),O(l)!=="svelte-gz26bx"&&(l.textContent=C),z.forEach(f),this.h()},h(){y(e,"class","chip variant-soft hover:variant-filled"),y(u,"class","chip variant-soft hover:variant-filled")},m(h,x){w(h,e,x),_(e,n),te(t,n,null),_(e,o),_(e,s),w(h,d,x),w(h,u,x),_(u,p),te(c,p,null),_(u,i),_(u,l),$=!0,m||(j=[J(e,"click",r[1]),J(u,"click",r[0])],m=!0)},p:T,i(h){$||(V(t.$$.fragment,h),V(c.$$.fragment,h),$=!0)},o(h){F(t.$$.fragment,h),F(c.$$.fragment,h),$=!1},d(h){h&&(f(e),f(d),f(u)),ne(t),ne(c),m=!1,xe(j)}}}function Ae(r,e,n){let t;Y(r,R,c=>n(3,t=c));let{row:o}=e;const s=$e(),a=Ie();async function d(c){try{const i=new Headers;i.append("X-WebAuth-User","default");const l=await fetch("/api/specifications/"+c,{method:"DELETE",headers:i});if(l.ok){const C={message:"Specification deleted",background:"variant-filled-success"};a.trigger(C);let $=t.findIndex(m=>m.id==c);t.splice($,1),R.set(t)}else{const C={message:"An error occurred: "+l.statusText,background:"variant-filled-error",timeout:5e3};a.trigger(C)}}catch(i){const l={message:"An error occurred while sending the request to the server: "+i,background:"variant-filled-error",autohide:!1};a.trigger(l)}}async function u(c){const l={type:"confirm",title:"Please Confirm",body:'Are you sure you want to delete "'+o.name+'"',response:async C=>{C&&await d(o.id)}};s.trigger(l)}async function p(c){const i={type:"component",title:"Updating Specification "+o.name,body:"",meta:{row:o,method:"PUT"},component:"modalSpecificationForm",response:async l=>{if(l){let C=t.findIndex($=>$.id==l.id);je(R,t[C]=l,t),R.set(t),s.close()}}};s.trigger(i)}return r.$$set=c=>{"row"in c&&n(2,o=c.row)},[u,p,o]}class Oe extends oe{constructor(e){super(),re(this,e,Ae,Ue,se,{row:2})}}function ze(r){let e,n=r[0].id+"",t,o;return{c(){e=v("a"),t=X(n),this.h()},l(s){e=g(s,"A",{href:!0});var a=A(e);t=G(a,n),a.forEach(f),this.h()},h(){y(e,"href",o="/testrun/"+r[0].id)},m(s,a){w(s,e,a),_(e,t)},p(s,[a]){a&1&&n!==(n=s[0].id+"")&&fe(t,n),a&1&&o!==(o="/testrun/"+s[0].id)&&y(e,"href",o)},i:T,o:T,d(s){s&&f(e)}}}function He(r,e,n){let{row:t}=e;return r.$$set=o=>{"row"in o&&n(0,t=o.row)},[t]}class qe extends oe{constructor(e){super(),re(this,e,He,ze,se,{row:0})}}function Be(r){let e;return{c(){e=v("input"),this.h()},l(n){e=g(n,"INPUT",{class:!0,type:!0}),this.h()},h(){y(e,"class","checkbox"),y(e,"type","checkbox"),e.disabled=!0},m(n,t){w(n,e,t)},p:T,d(n){n&&f(e)}}}function Me(r){let e,n,t;return{c(){e=v("input"),this.h()},l(o){e=g(o,"INPUT",{class:!0,type:!0}),this.h()},h(){y(e,"class","checkbox"),y(e,"type","checkbox")},m(o,s){w(o,e,s),e.checked=r[0],n||(t=[J(e,"change",r[4]),J(e,"change",r[2])],n=!0)},p(o,s){s&1&&(e.checked=o[0])},d(o){o&&f(e),n=!1,xe(t)}}}function Ve(r){let e;function n(s,a){return s[1]?Me:Be}let o=n(r)(r);return{c(){o.c(),e=ve()},l(s){o.l(s),e=ve()},m(s,a){o.m(s,a),w(s,e,a)},p(s,[a]){o.p(s,a)},i:T,o:T,d(s){s&&f(e),o.d(s)}}}function Fe(r,e,n){var u;let{row:t}=e,o=!!((u=t.data)!=null&&u.vega_lite),s=!1;function a(){s?ue.update(p=>p.add(t.id)):ue.update(p=>(p.delete(t.id),p))}function d(){s=this.checked,n(0,s)}return r.$$set=p=>{"row"in p&&n(3,t=p.row)},[s,o,a,t,d]}class Re extends oe{constructor(e){super(),re(this,e,Fe,Ve,se,{row:3})}}function Ce(r){let e,n=r[0].project.number+"",t,o;return{c(){e=X("("),t=X(n),o=X(")")},l(s){e=G(s,"("),t=G(s,n),o=G(s,")")},m(s,a){w(s,e,a),w(s,t,a),w(s,o,a)},p(s,a){a&1&&n!==(n=s[0].project.number+"")&&fe(t,n)},d(s){s&&(f(e),f(t),f(o))}}}function Je(r){let e,n="No testruns available.";return{c(){e=v("p"),e.textContent=n},l(t){e=g(t,"P",{"data-svelte-h":!0}),O(e)!=="svelte-19qnwi6"&&(e.textContent=n)},m(t,o){w(t,e,o)},p:T,i:T,o:T,d(t){t&&f(e)}}}function Le(r){let e,n,t,o="Only testruns with charts can be compared for now.",s,a,d;function u(i,l){return i[1].size>1?Xe:We}let p=u(r),c=p(r);return a=new Te({props:{data:r[4],columns:r[6],rowsPerPage:10}}),a.$on("selected",r[9]),{c(){e=v("div"),c.c(),n=I(),t=v("p"),t.textContent=o,s=I(),Z(a.$$.fragment)},l(i){e=g(i,"DIV",{});var l=A(e);c.l(l),n=D(l),t=g(l,"P",{"data-svelte-h":!0}),O(t)!=="svelte-cw2v9o"&&(t.textContent=o),l.forEach(f),s=D(i),ee(a.$$.fragment,i)},m(i,l){w(i,e,l),c.m(e,null),_(e,n),_(e,t),w(i,s,l),te(a,i,l),d=!0},p(i,l){p===(p=u(i))&&c?c.p(i,l):(c.d(1),c=p(i),c&&(c.c(),c.m(e,n)))},i(i){d||(V(a.$$.fragment,i),d=!0)},o(i){F(a.$$.fragment,i),d=!1},d(i){i&&(f(e),f(s)),c.d(),ne(a,i)}}}function We(r){let e,n="Compare Selected";return{c(){e=v("button"),e.textContent=n,this.h()},l(t){e=g(t,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-v41ftl"&&(e.textContent=n),this.h()},h(){y(e,"class","btn variant-filled"),e.disabled=!0},m(t,o){w(t,e,o)},p:T,d(t){t&&f(e)}}}function Xe(r){let e,n="Compare Selected",t,o;return{c(){e=v("button"),e.textContent=n,this.h()},l(s){e=g(s,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-19z10pc"&&(e.textContent=n),this.h()},h(){y(e,"class","btn variant-filled")},m(s,a){w(s,e,a),t||(o=J(e,"click",r[8]),t=!0)},p:T,d(s){s&&f(e),t=!1,o()}}}function Ge(r){let e,n="No specification data available.";return{c(){e=v("p"),e.textContent=n},l(t){e=g(t,"P",{"data-svelte-h":!0}),O(e)!=="svelte-1ancpzf"&&(e.textContent=n)},m(t,o){w(t,e,o)},p:T,i:T,o:T,d(t){t&&f(e)}}}function Ke(r){let e,n;return e=new Te({props:{data:R,columns:r[5],rowsPerPage:10}}),{c(){Z(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,o){te(e,t,o),n=!0},p:T,i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){F(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Qe(r){let e,n,t=r[0].project.name+"",o,s,a,d,u,p="Testruns",c,i,l,C,$,m,j,h,x,L="Specifications",z,U,de="New",ae,P,N,W,ie,pe,S=r[0].project.number&&Ce(r);const me=[Le,Je],H=[];function _e(b,k){return b[3].length>0?0:1}i=_e(r),l=H[i]=me[i](r);const he=[Ke,Ge],q=[];function be(b,k){return b[2].length>0?0:1}return P=be(r),N=q[P]=he[P](r),{c(){e=v("div"),n=v("h1"),o=X(t),s=I(),S&&S.c(),a=I(),d=v("section"),u=v("h2"),u.textContent=p,c=I(),l.c(),C=I(),$=v("hr"),m=I(),j=v("section"),h=v("div"),x=v("h2"),x.textContent=L,z=I(),U=v("button"),U.textContent=de,ae=I(),N.c(),this.h()},l(b){e=g(b,"DIV",{class:!0});var k=A(e);n=g(k,"H1",{class:!0});var B=A(n);o=G(B,t),s=D(B),S&&S.l(B),B.forEach(f),a=D(k),d=g(k,"SECTION",{class:!0});var M=A(d);u=g(M,"H2",{class:!0,"data-svelte-h":!0}),O(u)!=="svelte-uwi6xt"&&(u.textContent=p),c=D(M),l.l(M),M.forEach(f),C=D(k),$=g(k,"HR",{}),m=D(k),j=g(k,"SECTION",{class:!0});var K=A(j);h=g(K,"DIV",{class:!0});var Q=A(h);x=g(Q,"H2",{class:!0,"data-svelte-h":!0}),O(x)!=="svelte-lqesz5"&&(x.textContent=L),z=D(Q),U=g(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),O(U)!=="svelte-g87gly"&&(U.textContent=de),Q.forEach(f),ae=D(K),N.l(K),K.forEach(f),k.forEach(f),this.h()},h(){y(n,"class","h1"),y(u,"class","h2"),y(d,"class","space-y-2"),y(x,"class","h2"),y(U,"class","btn variant-filled"),y(h,"class","flex justify-between"),y(j,"class","space-y-2"),y(e,"class","container mx-auto p-8 space-y-8")},m(b,k){w(b,e,k),_(e,n),_(n,o),_(n,s),S&&S.m(n,null),_(e,a),_(e,d),_(d,u),_(d,c),H[i].m(d,null),_(e,C),_(e,$),_(e,m),_(e,j),_(j,h),_(h,x),_(h,z),_(h,U),_(j,ae),q[P].m(j,null),W=!0,ie||(pe=J(U,"click",r[7]),ie=!0)},p(b,[k]){(!W||k&1)&&t!==(t=b[0].project.name+"")&&fe(o,t),b[0].project.number?S?S.p(b,k):(S=Ce(b),S.c(),S.m(n,null)):S&&(S.d(1),S=null);let B=i;i=_e(b),i===B?H[i].p(b,k):(ke(),F(H[B],1,1,()=>{H[B]=null}),ge(),l=H[i],l?l.p(b,k):(l=H[i]=me[i](b),l.c()),V(l,1),l.m(d,null));let M=P;P=be(b),P===M?q[P].p(b,k):(ke(),F(q[M],1,1,()=>{q[M]=null}),ge(),N=q[P],N?N.p(b,k):(N=q[P]=he[P](b),N.c()),V(N,1),N.m(j,null))},i(b){W||(V(l),V(N),W=!0)},o(b){F(l),F(N),W=!1},d(b){b&&f(e),S&&S.d(),H[i].d(),q[P].d(),ie=!1,pe()}}}function Ye(r,e,n){let t,o,s;Y(r,ue,m=>n(1,t=m)),Y(r,R,m=>n(2,o=m));let{data:a}=e;const d=$e();R.set(a.specifications);let u=Pe(a.testruns);Y(r,u,m=>n(3,s=m));const p=[E("id","ID"),E("project_id","Project ID"),E("name","Name"),E("minimum","Minimum"),E("typical","Typical"),E("maximum","Maximum"),E("unit","Unit"),ce("Actions",Oe)],c=[ce("Select",Re),ce("ID",qe),E("short_code","Short code"),E("dut_id","DUT ID"),E("machine_hostname","Machine Hostname"),E("user_name","Username"),E("test_name","Test Name")],i={type:"component",title:"New specification for "+a.project.name,body:"",meta:{project_id:a.project.id},component:"modalSpecificationForm",response:async m=>{m&&(o.push(m),R.set(o),d.close())}};function l(){d.trigger(i)}function C(){let m=Array.from(t.values());ye(`/project/compare?id=${a.project.id}&testruns=${m.join()}`)}function $(m){ye(`/testrun/${m.detail.id}`)}return r.$$set=m=>{"data"in m&&n(0,a=m.data)},[a,t,o,s,u,p,c,l,C,$]}class ct extends oe{constructor(e){super(),re(this,e,Ye,Qe,se,{data:0})}}export{ct as component,lt as universal};
