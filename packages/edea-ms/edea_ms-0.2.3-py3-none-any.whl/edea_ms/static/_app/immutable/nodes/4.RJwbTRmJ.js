import{e as le}from"../chunks/index.wrO0Lkaj.js";import{s as se,e as b,a as D,c as v,b as A,f,g as U,p as O,q as y,i as C,h,w as J,n as S,x as we,k as Y,J as $e,t as X,d as G,j as fe,r as be}from"../chunks/scheduler.rpzzQWFm.js";import{S as oe,i as re,b as Z,d as ee,m as te,a as B,t as M,e as ne,c as ve,g as ge}from"../chunks/index.mx9HPA7V.js";import{w as xe,r as je,g as ke}from"../chunks/entry.3G61wjjA.js";import{c as N,a as ce,S as Se}from"../chunks/SimpleTable.pRY_QPGa.js";import{g as Te}from"../chunks/stores.Zgx289xP.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.I74cdcab.js";import{I as ye,P as Pe,T as Ne}from"../chunks/Icon.HjRuGJsp.js";import{g as Ee}from"../chunks/stores.TcXA9woL.js";const Ie=async({fetch:r,params:e})=>{const n=await r("/api/projects/"+e.slug).then(t=>(t.ok||le(t.status,t.statusText),t.json()));return{testruns:r("/api/testruns/project/"+n.id).then(t=>(t.ok||le(t.status,t.statusText),t.json())),specifications:r("/api/specifications/project/"+n.id).then(t=>(t.ok||le(t.status,t.statusText),t.json())),project:n}},it=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"})),V=xe([]),ue=xe(new Set);function De(r){let e,n,t,o,s,a="Edit",p,m,d,l,i,c,w="Delete",T,u,E;return t=new ye({props:{size:"12",src:Pe}}),l=new ye({props:{size:"12",src:Ne}}),{c(){e=b("button"),n=b("span"),Z(t.$$.fragment),o=D(),s=b("span"),s.textContent=a,p=D(),m=b("button"),d=b("span"),Z(l.$$.fragment),i=D(),c=b("span"),c.textContent=w,this.h()},l(g){e=v(g,"BUTTON",{class:!0});var I=A(e);n=v(I,"SPAN",{});var R=A(n);ee(t.$$.fragment,R),R.forEach(f),o=U(I),s=v(I,"SPAN",{"data-svelte-h":!0}),O(s)!=="svelte-bi7592"&&(s.textContent=a),I.forEach(f),p=U(g),m=v(g,"BUTTON",{class:!0});var $=A(m);d=v($,"SPAN",{});var L=A(d);ee(l.$$.fragment,L),L.forEach(f),i=U($),c=v($,"SPAN",{"data-svelte-h":!0}),O(c)!=="svelte-gz26bx"&&(c.textContent=w),$.forEach(f),this.h()},h(){y(e,"class","chip variant-soft hover:variant-filled"),y(m,"class","chip variant-soft hover:variant-filled")},m(g,I){C(g,e,I),h(e,n),te(t,n,null),h(e,o),h(e,s),C(g,p,I),C(g,m,I),h(m,d),te(l,d,null),h(m,i),h(m,c),T=!0,u||(E=[J(e,"click",r[1]),J(m,"click",r[0])],u=!0)},p:S,i(g){T||(B(t.$$.fragment,g),B(l.$$.fragment,g),T=!0)},o(g){M(t.$$.fragment,g),M(l.$$.fragment,g),T=!1},d(g){g&&(f(e),f(p),f(m)),ne(t),ne(l),u=!1,we(E)}}}function Ue(r,e,n){let t;Y(r,V,l=>n(3,t=l));let{row:o}=e;const s=Te(),a=Ee();async function p(l){try{const i=new Headers;i.append("X-WebAuth-User","default");const c=await fetch("/api/specifications/"+l,{method:"DELETE",headers:i});if(c.ok){const w={message:"Specification deleted",background:"variant-filled-success"};a.trigger(w);let T=t.findIndex(u=>u.id==l);t.splice(T,1),V.set(t)}else{const w={message:"An error occured: "+c.statusText,background:"variant-filled-error",timeout:5e3};a.trigger(w)}}catch(i){const c={message:"An error occured while sending the request to the server: "+i,background:"variant-filled-error",autohide:!1};a.trigger(c)}}async function m(l){const c={type:"confirm",title:"Please Confirm",body:'Are you sure you want to delete "'+o.name+'"',response:async w=>{w&&await p(o.id)}};s.trigger(c)}async function d(l){const i={type:"component",title:"Updating Specification "+o.name,body:"",meta:{row:o,method:"PUT"},component:"modalSpecificationForm",response:async c=>{if(c){let w=t.findIndex(T=>T.id==c.id);$e(V,t[w]=c,t),V.set(t),s.close()}}};s.trigger(i)}return r.$$set=l=>{"row"in l&&n(2,o=l.row)},[m,d,o]}class Ae extends oe{constructor(e){super(),re(this,e,Ue,De,se,{row:2})}}function Oe(r){let e,n=r[0].id+"",t,o;return{c(){e=b("a"),t=X(n),this.h()},l(s){e=v(s,"A",{href:!0});var a=A(e);t=G(a,n),a.forEach(f),this.h()},h(){y(e,"href",o="/testrun/"+r[0].id)},m(s,a){C(s,e,a),h(e,t)},p(s,[a]){a&1&&n!==(n=s[0].id+"")&&fe(t,n),a&1&&o!==(o="/testrun/"+s[0].id)&&y(e,"href",o)},i:S,o:S,d(s){s&&f(e)}}}function ze(r,e,n){let{row:t}=e;return r.$$set=o=>{"row"in o&&n(0,t=o.row)},[t]}class He extends oe{constructor(e){super(),re(this,e,ze,Oe,se,{row:0})}}function qe(r){let e;return{c(){e=b("input"),this.h()},l(n){e=v(n,"INPUT",{class:!0,type:!0}),this.h()},h(){y(e,"class","checkbox"),y(e,"type","checkbox"),e.disabled=!0},m(n,t){C(n,e,t)},p:S,d(n){n&&f(e)}}}function Be(r){let e,n,t;return{c(){e=b("input"),this.h()},l(o){e=v(o,"INPUT",{class:!0,type:!0}),this.h()},h(){y(e,"class","checkbox"),y(e,"type","checkbox")},m(o,s){C(o,e,s),e.checked=r[0],n||(t=[J(e,"change",r[4]),J(e,"change",r[2])],n=!0)},p(o,s){s&1&&(e.checked=o[0])},d(o){o&&f(e),n=!1,we(t)}}}function Me(r){let e;function n(s,a){return s[1]?Be:qe}let o=n(r)(r);return{c(){o.c(),e=be()},l(s){o.l(s),e=be()},m(s,a){o.m(s,a),C(s,e,a)},p(s,[a]){o.p(s,a)},i:S,o:S,d(s){s&&f(e),o.d(s)}}}function Ve(r,e,n){var m;let{row:t}=e,o=!!((m=t.data)!=null&&m.vega_lite),s=!1;function a(){s?ue.update(d=>d.add(t.id)):ue.update(d=>(d.delete(t.id),d))}function p(){s=this.checked,n(0,s)}return r.$$set=d=>{"row"in d&&n(3,t=d.row)},[s,o,a,t,p]}class Fe extends oe{constructor(e){super(),re(this,e,Ve,Me,se,{row:3})}}function Ce(r){let e,n=r[0].project.number+"",t,o;return{c(){e=X("("),t=X(n),o=X(")")},l(s){e=G(s,"("),t=G(s,n),o=G(s,")")},m(s,a){C(s,e,a),C(s,t,a),C(s,o,a)},p(s,a){a&1&&n!==(n=s[0].project.number+"")&&fe(t,n)},d(s){s&&(f(e),f(t),f(o))}}}function Re(r){let e,n="No testruns available.";return{c(){e=b("p"),e.textContent=n},l(t){e=v(t,"P",{"data-svelte-h":!0}),O(e)!=="svelte-19qnwi6"&&(e.textContent=n)},m(t,o){C(t,e,o)},p:S,i:S,o:S,d(t){t&&f(e)}}}function Je(r){let e,n,t,o="Only testruns with charts can be compared for now.",s,a,p;function m(i,c){return i[1].size>1?We:Le}let d=m(r),l=d(r);return a=new Se({props:{data:r[4],columns:r[6],rowsPerPage:10}}),a.$on("selected",r[9]),{c(){e=b("div"),l.c(),n=D(),t=b("p"),t.textContent=o,s=D(),Z(a.$$.fragment)},l(i){e=v(i,"DIV",{});var c=A(e);l.l(c),n=U(c),t=v(c,"P",{"data-svelte-h":!0}),O(t)!=="svelte-cw2v9o"&&(t.textContent=o),c.forEach(f),s=U(i),ee(a.$$.fragment,i)},m(i,c){C(i,e,c),l.m(e,null),h(e,n),h(e,t),C(i,s,c),te(a,i,c),p=!0},p(i,c){d===(d=m(i))&&l?l.p(i,c):(l.d(1),l=d(i),l&&(l.c(),l.m(e,n)))},i(i){p||(B(a.$$.fragment,i),p=!0)},o(i){M(a.$$.fragment,i),p=!1},d(i){i&&(f(e),f(s)),l.d(),ne(a,i)}}}function Le(r){let e,n="Compare Selected";return{c(){e=b("button"),e.textContent=n,this.h()},l(t){e=v(t,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-v41ftl"&&(e.textContent=n),this.h()},h(){y(e,"class","btn variant-filled"),e.disabled=!0},m(t,o){C(t,e,o)},p:S,d(t){t&&f(e)}}}function We(r){let e,n="Compare Selected",t,o;return{c(){e=b("button"),e.textContent=n,this.h()},l(s){e=v(s,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-19z10pc"&&(e.textContent=n),this.h()},h(){y(e,"class","btn variant-filled")},m(s,a){C(s,e,a),t||(o=J(e,"click",r[8]),t=!0)},p:S,d(s){s&&f(e),t=!1,o()}}}function Xe(r){let e,n="No specification data available.";return{c(){e=b("p"),e.textContent=n},l(t){e=v(t,"P",{"data-svelte-h":!0}),O(e)!=="svelte-1ancpzf"&&(e.textContent=n)},m(t,o){C(t,e,o)},p:S,i:S,o:S,d(t){t&&f(e)}}}function Ge(r){let e,n;return e=new Se({props:{data:V,columns:r[5],rowsPerPage:10}}),{c(){Z(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,o){te(e,t,o),n=!0},p:S,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Ke(r){let e,n,t=r[0].project.name+"",o,s,a,p,m="Testruns",d,l,i,c,w,T,u,E,g,I="Specifications",R,$,L="New",ae,j,P,W,ie,de,x=r[0].project.number&&Ce(r);const pe=[Je,Re],z=[];function me(_,k){return _[3].length>0?0:1}l=me(r),i=z[l]=pe[l](r);const _e=[Ge,Xe],H=[];function he(_,k){return _[2].length>0?0:1}return j=he(r),P=H[j]=_e[j](r),{c(){e=b("div"),n=b("h1"),o=X(t),x&&x.c(),s=D(),a=b("section"),p=b("h2"),p.textContent=m,d=D(),i.c(),c=D(),w=b("hr"),T=D(),u=b("section"),E=b("div"),g=b("h2"),g.textContent=I,R=D(),$=b("button"),$.textContent=L,ae=D(),P.c(),this.h()},l(_){e=v(_,"DIV",{class:!0});var k=A(e);n=v(k,"H1",{class:!0});var F=A(n);o=G(F,t),x&&x.l(F),F.forEach(f),s=U(k),a=v(k,"SECTION",{class:!0});var q=A(a);p=v(q,"H2",{class:!0,"data-svelte-h":!0}),O(p)!=="svelte-uwi6xt"&&(p.textContent=m),d=U(q),i.l(q),q.forEach(f),c=U(k),w=v(k,"HR",{}),T=U(k),u=v(k,"SECTION",{class:!0});var K=A(u);E=v(K,"DIV",{class:!0});var Q=A(E);g=v(Q,"H2",{class:!0,"data-svelte-h":!0}),O(g)!=="svelte-lqesz5"&&(g.textContent=I),R=U(Q),$=v(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),O($)!=="svelte-g87gly"&&($.textContent=L),Q.forEach(f),ae=U(K),P.l(K),K.forEach(f),k.forEach(f),this.h()},h(){y(n,"class","h1"),y(p,"class","h2"),y(a,"class","space-y-2"),y(g,"class","h2"),y($,"class","btn variant-filled"),y(E,"class","flex justify-between"),y(u,"class","space-y-2"),y(e,"class","container mx-auto p-8 space-y-8")},m(_,k){C(_,e,k),h(e,n),h(n,o),x&&x.m(n,null),h(e,s),h(e,a),h(a,p),h(a,d),z[l].m(a,null),h(e,c),h(e,w),h(e,T),h(e,u),h(u,E),h(E,g),h(E,R),h(E,$),h(u,ae),H[j].m(u,null),W=!0,ie||(de=J($,"click",r[7]),ie=!0)},p(_,[k]){(!W||k&1)&&t!==(t=_[0].project.name+"")&&fe(o,t),_[0].project.number?x?x.p(_,k):(x=Ce(_),x.c(),x.m(n,null)):x&&(x.d(1),x=null);let F=l;l=me(_),l===F?z[l].p(_,k):(ge(),M(z[F],1,1,()=>{z[F]=null}),ve(),i=z[l],i?i.p(_,k):(i=z[l]=pe[l](_),i.c()),B(i,1),i.m(a,null));let q=j;j=he(_),j===q?H[j].p(_,k):(ge(),M(H[q],1,1,()=>{H[q]=null}),ve(),P=H[j],P?P.p(_,k):(P=H[j]=_e[j](_),P.c()),B(P,1),P.m(u,null))},i(_){W||(B(i),B(P),W=!0)},o(_){M(i),M(P),W=!1},d(_){_&&f(e),x&&x.d(),z[l].d(),H[j].d(),ie=!1,de()}}}function Qe(r,e,n){let t,o,s;Y(r,ue,u=>n(1,t=u)),Y(r,V,u=>n(2,o=u));let{data:a}=e;const p=Te();V.set(a.specifications);let m=je(a.testruns);Y(r,m,u=>n(3,s=u));const d=[N("id","ID"),N("project_id","Project ID"),N("name","Name"),N("minimum","Minimum"),N("typical","Typical"),N("maximum","Maximum"),N("unit","Unit"),ce("Actions",Ae)],l=[ce("Select",Fe),ce("ID",He),N("short_code","Short code"),N("dut_id","DUT ID"),N("machine_hostname","Machine Hostname"),N("user_name","Username"),N("test_name","Test Name")],i={type:"component",title:"New specification for "+a.project.name,body:"",meta:{project_id:a.project.id},component:"modalSpecificationForm",response:async u=>{u&&(o.push(u),V.set(o),p.close())}};function c(){p.trigger(i)}function w(){let u=Array.from(t.values());ke(`/project/compare?id=${a.project.id}&testruns=${u.join()}`)}function T(u){ke(`/testrun/${u.detail.id}`)}return r.$$set=u=>{"data"in u&&n(0,a=u.data)},[a,t,o,s,m,d,l,c,w,T]}class lt extends oe{constructor(e){super(),re(this,e,Qe,Ke,se,{data:0})}}export{lt as component,it as universal};
