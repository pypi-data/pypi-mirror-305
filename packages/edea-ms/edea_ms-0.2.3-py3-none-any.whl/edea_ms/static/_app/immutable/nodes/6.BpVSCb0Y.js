import{s as L,e as b,a as $,c as v,b as k,f as h,g as E,p as N,q as P,i as S,h as w,w as T,n as x,x as W,k as U,l as R,J as X}from"../chunks/scheduler.DO4friaV.js";import{S as V,i as K,b as q,d as z,m as B,a as A,t as D,e as F,c as Y,g as Z}from"../chunks/index.BU_Tmytt.js";import{w as ee,g as te}from"../chunks/entry.nsMzfHyC.js";import{c as O,a as ne,S as oe}from"../chunks/SimpleTable.8VnLZlp_.js";import{g as Q}from"../chunks/stores.BcCpVjbU.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.B6g3S38p.js";import{I as H,P as se,T as re}from"../chunks/Icon.Cd03PMDn.js";import{g as ae}from"../chunks/stores.Dy1Sz5Ny.js";const le=async({fetch:l,params:e})=>({projects:await await(await l("/api/projects")).json()}),Ce=Object.freeze(Object.defineProperty({__proto__:null,load:le},Symbol.toStringTag,{value:"Module"})),C=ee([]);function ce(l){let e,o,t,u,c,p="Edit",i,r,g,a,y,n,_="Delete",s,f,m;return t=new H({props:{size:"12",src:se}}),a=new H({props:{size:"12",src:re}}),{c(){e=b("button"),o=b("span"),q(t.$$.fragment),u=$(),c=b("span"),c.textContent=p,i=$(),r=b("button"),g=b("span"),q(a.$$.fragment),y=$(),n=b("span"),n.textContent=_,this.h()},l(d){e=v(d,"BUTTON",{class:!0});var j=k(e);o=v(j,"SPAN",{});var M=k(o);z(t.$$.fragment,M),M.forEach(h),u=E(j),c=v(j,"SPAN",{"data-svelte-h":!0}),N(c)!=="svelte-bi7592"&&(c.textContent=p),j.forEach(h),i=E(d),r=v(d,"BUTTON",{class:!0});var I=k(r);g=v(I,"SPAN",{});var G=k(g);z(a.$$.fragment,G),G.forEach(h),y=E(I),n=v(I,"SPAN",{"data-svelte-h":!0}),N(n)!=="svelte-gz26bx"&&(n.textContent=_),I.forEach(h),this.h()},h(){P(e,"class","chip variant-soft hover:variant-filled"),P(r,"class","chip variant-soft hover:variant-filled")},m(d,j){S(d,e,j),w(e,o),B(t,o,null),w(e,u),w(e,c),S(d,i,j),S(d,r,j),w(r,g),B(a,g,null),w(r,y),w(r,n),s=!0,f||(m=[T(e,"click",l[2]),T(e,"keypress",l[2]),T(r,"click",l[1]),T(r,"keypress",l[1])],f=!0)},p:x,i(d){s||(A(t.$$.fragment,d),A(a.$$.fragment,d),s=!0)},o(d){D(t.$$.fragment,d),D(a.$$.fragment,d),s=!1},d(d){d&&(h(e),h(i),h(r)),F(t),F(a),f=!1,W(m)}}}function ie(l,e,o){let t,u;U(l,C,n=>o(4,t=n));let{row:c}=e;const p=Q(),i=ae(),r=R("user");U(l,r,n=>o(5,u=n));async function g(n){try{const _=await fetch("/api/projects/"+n,{method:"DELETE"});if(_.ok){const s={message:"Project deleted",background:"variant-filled-success"};i.trigger(s);let f=t.findIndex(m=>m.id==n);t.splice(f,1),C.set(t)}else{const s={message:"An error occured: "+_.statusText,background:"variant-filled-error",timeout:5e3};i.trigger(s)}}catch(_){const s={message:"An error occured while sending the request to the server: "+_,background:"variant-filled-error",autohide:!1};i.trigger(s)}}async function a(n){const s={type:"confirm",title:"Please Confirm",body:'Are you sure you want to delete "'+c.name+'"',response:async f=>{f&&await g(c.id)}};p.trigger(s)}async function y(n){const _={type:"component",title:"Updating "+c.name,body:"",meta:{row:c,method:"PUT",groups:u.groups},component:"modalProjectForm",response:async s=>{if(s){let f=t.findIndex(m=>m.id==s.message.id);X(C,t[f]=s.message,t),C.set(t),p.close()}}};p.trigger(_)}return l.$$set=n=>{"row"in n&&o(3,c=n.row)},[r,a,y,c]}class ue extends V{constructor(e){super(),K(this,e,ie,ce,L,{row:3})}}function J(l){let e,o="New",t,u;return{c(){e=b("button"),e.textContent=o,this.h()},l(c){e=v(c,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-32nq53"&&(e.textContent=o),this.h()},h(){P(e,"class","btn bg-gradient-to-br variant-filled")},m(c,p){S(c,e,p),t||(u=T(e,"click",l[4]),t=!0)},p:x,d(c){c&&h(e),t=!1,u()}}}function fe(l){let e,o="No project data available.";return{c(){e=b("p"),e.textContent=o},l(t){e=v(t,"P",{"data-svelte-h":!0}),N(e)!=="svelte-r7a4lf"&&(e.textContent=o)},m(t,u){S(t,e,u)},p:x,i:x,o:x,d(t){t&&h(e)}}}function pe(l){let e,o;return e=new oe({props:{data:C,columns:l[3],rowsPerPage:10}}),e.$on("selected",l[5]),{c(){q(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,u){B(e,t,u),o=!0},p:x,i(t){o||(A(e.$$.fragment,t),o=!0)},o(t){D(e.$$.fragment,t),o=!1},d(t){F(e,t)}}}function me(l){let e,o,t,u="Projects",c,p,i,r,g,a=l[1]!==void 0&&J(l);const y=[pe,fe],n=[];function _(s,f){return s[0].length>0?0:1}return i=_(l),r=n[i]=y[i](l),{c(){e=b("div"),o=b("section"),t=b("h1"),t.textContent=u,c=$(),a&&a.c(),p=$(),r.c(),this.h()},l(s){e=v(s,"DIV",{class:!0});var f=k(e);o=v(f,"SECTION",{class:!0});var m=k(o);t=v(m,"H1",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-1d00lg2"&&(t.textContent=u),c=E(m),a&&a.l(m),m.forEach(h),p=E(f),r.l(f),f.forEach(h),this.h()},h(){P(t,"class","h1"),P(o,"class","flex justify-between"),P(e,"class","container mx-auto p-8 space-y-8")},m(s,f){S(s,e,f),w(e,o),w(o,t),w(o,c),a&&a.m(o,null),w(e,p),n[i].m(e,null),g=!0},p(s,[f]){s[1]!==void 0?a?a.p(s,f):(a=J(s),a.c(),a.m(o,null)):a&&(a.d(1),a=null);let m=i;i=_(s),i===m?n[i].p(s,f):(Z(),D(n[m],1,1,()=>{n[m]=null}),Y(),r=n[i],r?r.p(s,f):(r=n[i]=y[i](s),r.c()),A(r,1),r.m(e,null))},i(s){g||(A(r),g=!0)},o(s){D(r),g=!1},d(s){s&&h(e),a&&a.d(),n[i].d()}}}function de(l,e,o){let t,u;U(l,C,n=>o(0,t=n));let{data:c}=e;const p=Q();C.set(c.projects);const i=R("user");U(l,i,n=>o(1,u=n));const r=[O("id","ID"),O("short_code","Short Code"),O("name","Name"),O("groups","Groups"),ne("Actions",ue)],g={type:"component",title:"New Project",body:"",meta:{groups:u==null?void 0:u.groups},component:"modalProjectForm",response:async n=>{n&&(t.push(n),C.set(t),p.close())}};function a(){p.trigger(g)}function y(n){te(`/project/${n.detail.id}`)}return l.$$set=n=>{"data"in n&&o(6,c=n.data)},[t,u,i,r,a,y,c]}class ke extends V{constructor(e){super(),K(this,e,de,me,L,{data:6})}}export{ke as component,Ce as universal};
