"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[50575],{84563:function(e,r,t){var o,n,i=t(82275),a=t(64782),s=t(64599),l=t(35806),c=t(71008),d=t(62193),u=t(2816),h=t(27927),g=t(35890),f=(t(81027),t(82386),t(39805),t(89655),t(39790),t(22871),t(36016),t(36604),t(253),t(54846),t(66555),t(15112)),v=t(29818);(0,h.A)([(0,v.EM)("ha-ansi-to-html")],(function(e,r){var t=function(r){function t(){var r;(0,c.A)(this,t);for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return r=(0,d.A)(this,t,[].concat(n)),e(r),r}return(0,u.A)(t,r),(0,l.A)(t)}(r);return{F:t,d:[{kind:"field",decorators:[(0,v.MZ)()],key:"content",value:void 0},{kind:"field",decorators:[(0,v.P)("pre")],key:"_pre",value:void 0},{kind:"field",decorators:[(0,v.wk)()],key:"_filter",value:function(){return""}},{kind:"method",key:"render",value:function(){return(0,f.qy)(o||(o=(0,s.A)(["<pre></pre>"])))}},{kind:"method",key:"firstUpdated",value:function(e){(0,g.A)(t,"firstUpdated",this,3)([e]),this.content&&this.parseTextToColoredPre(this.content)}},{kind:"get",static:!0,key:"styles",value:function(){return(0,f.AH)(n||(n=(0,s.A)(["pre{overflow-x:auto;white-space:pre-wrap;overflow-wrap:break-word;margin:0}.bold{font-weight:700}.italic{font-style:italic}.underline{text-decoration:underline}.strikethrough{text-decoration:line-through}.underline.strikethrough{text-decoration:underline line-through}.fg-red{color:var(--error-color)}.fg-green{color:var(--success-color)}.fg-yellow{color:var(--warning-color)}.fg-blue{color:var(--info-color)}.fg-magenta{color:#762671}.fg-cyan{color:#2cb5e9}.fg-white{color:#ccc}.bg-black{background-color:#000}.bg-red{background-color:var(--error-color)}.bg-green{background-color:var(--success-color)}.bg-yellow{background-color:var(--warning-color)}.bg-blue{background-color:var(--info-color)}.bg-magenta{background-color:#762671}.bg-cyan{background-color:#2cb5e9}.bg-white{background-color:#ccc}::highlight(search-results){background-color:var(--primary-color);color:var(--text-primary-color)}"])))}},{kind:"method",key:"parseLinesToColoredPre",value:function(e){var r,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=(0,a.A)(e);try{for(o.s();!(r=o.n()).done;){var n=r.value;this.parseLineToColoredPre(n,t)}}catch(i){o.e(i)}finally{o.f()}}},{kind:"method",key:"parseLineToColoredPre",value:function(e){for(var r,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=document.createElement("div"),n=/\x1b(?:\[(.*?)[@-~]|\].*?(?:\x07|\x1b\\))/g,i=0,a={bold:!1,italic:!1,underline:!1,strikethrough:!1,foregroundColor:null,backgroundColor:null},s=function(e){var r=document.createElement("span");a.bold&&r.classList.add("bold"),a.italic&&r.classList.add("italic"),a.underline&&r.classList.add("underline"),a.strikethrough&&r.classList.add("strikethrough"),null!==a.foregroundColor&&r.classList.add("fg-".concat(a.foregroundColor)),null!==a.backgroundColor&&r.classList.add("bg-".concat(a.backgroundColor)),r.appendChild(document.createTextNode(e)),o.appendChild(r)};null!==(r=n.exec(e));){var l=r.index,c=e.substring(i,l);c&&s(c),i=l+r[0].length,void 0!==r[1]&&r[1].split(";").forEach((function(e){switch(parseInt(e,10)){case 0:a.bold=!1,a.italic=!1,a.underline=!1,a.strikethrough=!1,a.foregroundColor=null,a.backgroundColor=null;break;case 1:a.bold=!0;break;case 3:a.italic=!0;break;case 4:a.underline=!0;break;case 9:a.strikethrough=!0;break;case 22:a.bold=!1;break;case 23:a.italic=!1;break;case 24:a.underline=!1;break;case 29:a.strikethrough=!1;break;case 30:case 39:a.foregroundColor=null;break;case 31:a.foregroundColor="red";break;case 32:a.foregroundColor="green";break;case 33:a.foregroundColor="yellow";break;case 34:a.foregroundColor="blue";break;case 35:a.foregroundColor="magenta";break;case 36:a.foregroundColor="cyan";break;case 37:a.foregroundColor="white";break;case 40:a.backgroundColor="black";break;case 41:a.backgroundColor="red";break;case 42:a.backgroundColor="green";break;case 43:a.backgroundColor="yellow";break;case 44:a.backgroundColor="blue";break;case 45:a.backgroundColor="magenta";break;case 46:a.backgroundColor="cyan";break;case 47:a.backgroundColor="white";break;case 49:a.backgroundColor=null}}))}var d,u,h=e.substring(i);(h&&s(h),t)?(null===(d=this._pre)||void 0===d||d.prepend(o),o.animate([{opacity:0},{opacity:1}],{duration:500})):null===(u=this._pre)||void 0===u||u.appendChild(o);this._filter&&this.filterLines(this._filter)}},{kind:"method",key:"parseTextToColoredPre",value:function(e){var r,t=e.split("\n"),o=(0,a.A)(t);try{for(o.s();!(r=o.n()).done;){var n=r.value;this.parseLineToColoredPre(n)}}catch(i){o.e(i)}finally{o.f()}}},{kind:"method",key:"filterLines",value:function(e){var r;this._filter=e;var t=(null===(r=this.shadowRoot)||void 0===r?void 0:r.querySelectorAll("div"))||[],o=0;if(e){var n=[];t.forEach((function(r){var t;null!==(t=r.textContent)&&void 0!==t&&t.toLowerCase().includes(e.toLowerCase())?(r.style.display="",o++,CSS.highlights&&null!==r.firstChild&&r.textContent&&r.querySelectorAll("span").forEach((function(r){for(var t=r.textContent.toLowerCase(),o=[],i=0;i<t.length;){var a=t.indexOf(e.toLowerCase(),i);if(-1===a)break;o.push(a),i=a+e.length}o.forEach((function(t){var o=new Range;o.setStart(r.firstChild,t),o.setEnd(r.firstChild,t+e.length),n.push(o)}))}))):r.style.display="none"})),CSS.highlights&&CSS.highlights.set("search-results",(0,i.A)(Highlight,n))}else t.forEach((function(e){e.style.display=""})),o=t.length,CSS.highlights&&CSS.highlights.delete("search-results");return!!o}},{kind:"method",key:"clear",value:function(){this._pre&&(this._pre.innerHTML="")}}]}}),f.WF)},37629:function(e,r,t){t.r(r),t.d(r,{HaCircularProgress:function(){return v}});var o,n=t(64599),i=t(41981),a=t(35806),s=t(71008),l=t(62193),c=t(2816),d=t(27927),u=t(35890),h=(t(81027),t(99322)),g=t(15112),f=t(29818),v=(0,d.A)([(0,f.EM)("ha-circular-progress")],(function(e,r){var t=function(r){function t(){var r;(0,s.A)(this,t);for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return r=(0,l.A)(this,t,[].concat(n)),e(r),r}return(0,c.A)(t,r),(0,a.A)(t)}(r);return{F:t,d:[{kind:"field",decorators:[(0,f.MZ)({attribute:"aria-label",type:String})],key:"ariaLabel",value:function(){return"Loading"}},{kind:"field",decorators:[(0,f.MZ)()],key:"size",value:function(){return"medium"}},{kind:"method",key:"updated",value:function(e){if((0,u.A)(t,"updated",this,3)([e]),e.has("size"))switch(this.size){case"tiny":this.style.setProperty("--md-circular-progress-size","16px");break;case"small":this.style.setProperty("--md-circular-progress-size","28px");break;case"medium":this.style.setProperty("--md-circular-progress-size","48px");break;case"large":this.style.setProperty("--md-circular-progress-size","68px")}}},{kind:"field",static:!0,key:"styles",value:function(){return[].concat((0,i.A)((0,u.A)(t,"styles",this)),[(0,g.AH)(o||(o=(0,n.A)([":host{--md-sys-color-primary:var(--primary-color);--md-circular-progress-size:48px}"])))])}}]}}),h.U)},95753:function(e,r,t){t.d(r,{L:function(){return o},_:function(){return n}});var o=function(e){return e.callApi("GET","error_log")},n="/api/error_log"},15066:function(e,r,t){t.d(r,{GM:function(){return h},MU:function(){return g},OV:function(){return u},RE:function(){return f},Vo:function(){return p},Yd:function(){return k},w9:function(){return m},y0:function(){return v}});var o,n,i,a,s=t(33994),l=t(22858),c=(t(81027),t(82386),t(36604),t(95266)),d=t(26025),u=33524==t.j?(o=(0,l.A)((0,s.A)().mark((function e(r){return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,c.v)(r.config.version,2021,2,4)){e.next=4;break}return e.next=3,r.callWS({type:"supervisor/api",endpoint:"/supervisor/reload",method:"post"});case 3:return e.abrupt("return");case 4:return e.next=6,r.callApi("POST","hassio/supervisor/reload");case 6:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)}):null,h=33524==t.j?(n=(0,l.A)((0,s.A)().mark((function e(r){return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,c.v)(r.config.version,2021,2,4)){e.next=2;break}return e.abrupt("return",r.callWS({type:"supervisor/api",endpoint:"/supervisor/info",method:"get"}));case 2:return e.t0=d.PS,e.next=5,r.callApi("GET","hassio/supervisor/info");case 5:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 7:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}):null,g=33524==t.j?(i=(0,l.A)((0,s.A)().mark((function e(r){return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,c.v)(r.config.version,2021,2,4)){e.next=2;break}return e.abrupt("return",r.callWS({type:"supervisor/api",endpoint:"/info",method:"get"}));case 2:return e.t0=d.PS,e.next=5,r.callApi("GET","hassio/info");case 5:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 7:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)}):null,f=function(){var e=(0,l.A)((0,s.A)().mark((function e(r,t,o){return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.callApiRaw("GET","hassio/".concat(t.includes("_")?"addons/".concat(t):t,"/logs"),void 0,o?{Range:o}:void 0));case 1:case"end":return e.stop()}}),e)})));return function(r,t,o){return e.apply(this,arguments)}}(),v=function(){var e=(0,l.A)((0,s.A)().mark((function e(r,t,o){var n,i=arguments;return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>3&&void 0!==i[3]?i[3]:100,e.abrupt("return",r.callApiRaw("GET","hassio/".concat(t.includes("_")?"addons/".concat(t):t,"/logs/follow?lines=").concat(n),void 0,void 0,o));case 2:case"end":return e.stop()}}),e)})));return function(r,t,o){return e.apply(this,arguments)}}(),p=function(e){return"/api/hassio/".concat(e.includes("_")?"addons/".concat(e):e,"/logs")},k=function(e,r){return"/api/hassio/".concat(e.includes("_")?"addons/".concat(e):e,"/logs?lines=").concat(r)},m=33524==t.j?(a=(0,l.A)((0,s.A)().mark((function e(r,t){return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,c.v)(r.config.version,2021,2,4)){e.next=4;break}return e.next=3,r.callWS({type:"supervisor/api",endpoint:"/supervisor/options",method:"post",data:t});case 3:return e.abrupt("return");case 4:return e.next=6,r.callApi("POST","hassio/supervisor/options",t);case 6:case"end":return e.stop()}}),e)}))),function(e,r){return a.apply(this,arguments)}):null},50575:function(e,r,t){var o,n,i,a,s,l,c,d,u,h=t(33994),g=t(22858),f=t(64599),v=t(35806),p=t(71008),k=t(62193),m=t(2816),b=t(27927),_=t(35890),y=(t(71499),t(81027),t(13025),t(53165),t(97099),t(50693),t(39790),t(36016),t(55228),t(43037),t(79641),t(253),t(2075),t(67056),t(15112)),w=t(85323),x=t(60493),A=t(29818),C=(t(13292),t(84563),t(13082),t(77372),t(28066),t(88400),t(37629),t(94526)),S=t(95753),T=t(26025),L=t(15066),E=t(30489),P=t(95266),H=t(33922),M=t(18409),z=(t(95737),t(66457),t(99019),t(96858),t(34897)),B="M19.92,12.08L12,20L4.08,12.08L5.5,10.67L11,16.17V2H13V16.17L18.5,10.66L19.92,12.08M12,20H2V22H22V20H12Z",F="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z";(0,b.A)([(0,A.EM)("error-log-card")],(function(e,r){var b,R,q,I=function(r){function t(){var r;(0,p.A)(this,t);for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return r=(0,k.A)(this,t,[].concat(n)),e(r),r}return(0,m.A)(t,r),(0,v.A)(t)}(r);return{F:I,d:[{kind:"field",decorators:[(0,A.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,A.MZ)()],key:"filter",value:function(){return""}},{kind:"field",decorators:[(0,A.MZ)()],key:"header",value:void 0},{kind:"field",decorators:[(0,A.MZ)()],key:"provider",value:void 0},{kind:"field",decorators:[(0,A.MZ)({type:Boolean,attribute:!0})],key:"show",value:function(){return!1}},{kind:"field",decorators:[(0,A.P)(".error-log")],key:"_logElement",value:void 0},{kind:"field",decorators:[(0,A.P)("#scroll-top-marker")],key:"_scrollTopMarkerElement",value:void 0},{kind:"field",decorators:[(0,A.P)("#scroll-bottom-marker")],key:"_scrollBottomMarkerElement",value:void 0},{kind:"field",decorators:[(0,A.P)("ha-ansi-to-html")],key:"_ansiToHtmlElement",value:void 0},{kind:"field",decorators:[(0,A.wk)()],key:"_firstCursor",value:void 0},{kind:"field",decorators:[(0,A.wk)()],key:"_scrolledToBottomController",value:function(){return new x.Q(this,{callback:function(e){return e[0].isIntersecting}})}},{kind:"field",decorators:[(0,A.wk)()],key:"_scrolledToTopController",value:function(){return new x.Q(this,{})}},{kind:"field",decorators:[(0,A.wk)()],key:"_newLogsIndicator",value:void 0},{kind:"field",decorators:[(0,A.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,A.wk)()],key:"_logStreamAborter",value:void 0},{kind:"field",decorators:[(0,A.wk)()],key:"_streamSupported",value:void 0},{kind:"field",decorators:[(0,A.wk)()],key:"_loadingState",value:function(){return"loading"}},{kind:"field",decorators:[(0,A.wk)()],key:"_loadingPrevState",value:void 0},{kind:"field",decorators:[(0,A.wk)()],key:"_noSearchResults",value:function(){return!1}},{kind:"field",decorators:[(0,A.wk)()],key:"_numberOfLines",value:void 0},{kind:"method",key:"render",value:function(){return(0,y.qy)(o||(o=(0,f.A)([' <div class="error-log-intro"> ',' <ha-card outlined class="','"> <div class="header"> <h1 class="card-header"> ',' </h1> <div class="action-buttons"> <ha-icon-button .path="','" @click="','" .label="','"></ha-icon-button> ',' </div> </div> <div class="card-content error-log"> <div id="scroll-top-marker"></div> '," "," ",' <ha-ansi-to-html></ha-ansi-to-html> <div id="scroll-bottom-marker"></div> </div> <ha-button class="new-logs-indicator ','" @click="','"> <ha-svg-icon .path="','" slot="icon"></ha-svg-icon> ',' <ha-svg-icon .path="','" slot="trailingIcon"></ha-svg-icon> </ha-button> </ha-card> '," </div> "])),this._error?(0,y.qy)(n||(n=(0,f.A)(['<ha-alert alert-type="error">',"</ha-alert>"])),this._error):"",(0,w.H)({hidden:!1===this.show}),this.header||this.hass.localize("ui.panel.config.logs.show_full_logs"),F,this._downloadFullLog,this.hass.localize("ui.panel.config.logs.download_full_log"),!this._streamSupported||this._error?(0,y.qy)(i||(i=(0,f.A)(['<ha-icon-button .path="','" @click="','" .label="','"></ha-icon-button>'])),"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z",this._loadLogs,this.hass.localize("ui.common.refresh")):y.s6,"loading"===this._loadingPrevState?(0,y.qy)(a||(a=(0,f.A)(['<div class="loading-old"> <ha-circular-progress .indeterminate="','"></ha-circular-progress> </div>'])),"loading"===this._loadingPrevState):y.s6,"loading"===this._loadingState?(0,y.qy)(s||(s=(0,f.A)(["<div> "," </div>"])),this.hass.localize("ui.panel.config.logs.loading_log")):"empty"===this._loadingState?(0,y.qy)(l||(l=(0,f.A)(["<div> "," </div>"])),this.hass.localize("ui.panel.config.logs.no_errors")):y.s6,"loaded"===this._loadingState&&this.filter&&this._noSearchResults?(0,y.qy)(c||(c=(0,f.A)(["<div> "," </div>"])),this.hass.localize("ui.panel.config.logs.no_issues_search",{term:this.filter})):y.s6,(0,w.H)({visible:this._newLogsIndicator&&!this._scrolledToBottomController.value||!1}),this._scrollToBottom,B,this.hass.localize("ui.panel.config.logs.scroll_down_button"),B,!1===this.show?(0,y.qy)(d||(d=(0,f.A)([' <ha-button outlined @click="','"> <ha-svg-icon .path="','"></ha-svg-icon> ',' </ha-button> <mwc-button raised @click="','"> '," </mwc-button> "])),this._downloadFullLog,F,this.hass.localize("ui.panel.config.logs.download_full_log"),this._showLogs,this.hass.localize("ui.panel.config.logs.load_logs")):"")}},{kind:"method",key:"connectedCallback",value:function(){(0,_.A)(I,"connectedCallback",this,3)([]),void 0===this._streamSupported&&(this._streamSupported=(0,P.v)(this.hass.config.version,2024,11))}},{kind:"method",key:"firstUpdated",value:function(e){var r;(0,_.A)(I,"firstUpdated",this,3)([e]),this._scrolledToBottomController.observe(this._scrollBottomMarkerElement),this._scrolledToTopController.callback=this._handleTopScroll,this._scrolledToTopController.observe(this._scrollTopMarkerElement),window.addEventListener("connection-status",this._handleConnectionStatus),(null!==(r=this.hass)&&void 0!==r&&r.config.recovery_mode||this.show)&&this.hass.loadFragmentTranslation("config")}},{kind:"method",key:"updated",value:function(e){(0,_.A)(I,"updated",this,3)([e]),(e.has("show")&&this.show||e.has("provider")&&this.show)&&this._loadLogs(),this._newLogsIndicator&&this._scrolledToBottomController.value&&(this._newLogsIndicator=!1),e.has("filter")&&this._debounceSearch(),e.has("_loadingState")&&"loaded"===this._loadingState&&this._scrolledToTopController.value&&this._firstCursor&&!this._loadingPrevState&&this._loadMoreLogs()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,_.A)(I,"disconnectedCallback",this,3)([]),this._logStreamAborter&&this._logStreamAborter.abort(),window.removeEventListener("connection-status",this._handleConnectionStatus)}},{kind:"method",key:"_downloadFullLog",value:(q=(0,g.A)((0,h.A)().mark((function e(){var r,o,n,i;return(0,h.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._streamSupported){e.next=4;break}a=this,s={header:this.header,provider:this.provider,defaultLineCount:this._numberOfLines},(0,z.r)(a,"show-dialog",{dialogTag:"dialog-download-logs",dialogImport:function(){return Promise.all([t.e(14691),t.e(24500),t.e(70346),t.e(61293)]).then(t.bind(t,74817))},dialogParams:s}),e.next=11;break;case 4:return r=(new Date).toISOString().replace(/:/g,"-"),o=this.provider&&"core"!==this.provider?(0,L.Vo)(this.provider):S._,n=this.provider&&"core"!==this.provider?"".concat(this.provider,"_").concat(r,".log"):"home-assistant_".concat(r,".log"),e.next=9,(0,C.e0)(this.hass,o);case 9:i=e.sent,(0,E.R)(i.path,n);case 11:case"end":return e.stop()}var a,s}),e,this)}))),function(){return q.apply(this,arguments)})},{kind:"method",key:"_showLogs",value:function(){this.show=!0}},{kind:"method",key:"_loadLogs",value:(R=(0,g.A)((0,h.A)().mark((function e(){var r,t,o,n,i,a,s,l,c,d,u,g,f,v,p,k,m=this;return(0,h.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._error=void 0,this._loadingState="loading",this._loadingPrevState=void 0,this._firstCursor=void 0,this._numberOfLines=0,null===(r=this._ansiToHtmlElement)||void 0===r||r.clear(),e.prev=6,this._logStreamAborter&&this._logStreamAborter.abort(),this._logStreamAborter=new AbortController,!(this._streamSupported&&(0,H.x)(this.hass,"hassio")&&this.provider)){e.next=33;break}return e.next=12,(0,L.y0)(this.hass,this.provider,this._logStreamAborter.signal,100);case 12:if((t=e.sent).headers.has("X-First-Cursor")&&(this._firstCursor=t.headers.get("X-First-Cursor")),t.body){e.next=16;break}throw new Error("No stream body found");case 16:this._loadingState="empty",o="",n=t.body.getReader(),i=new TextDecoder,a=!1;case 21:if(a){e.next=31;break}return e.next=24,n.read();case 24:s=e.sent,l=s.value,c=s.done,a=c,l&&(d=i.decode(l,{stream:!a}),u=this._scrolledToBottomController.value,g="".concat(o).concat(d).split("\n").filter((function(e){return""!==e.trim()})),o=d.endsWith("\n")?"":g.splice(-1,1)[0],g.length&&(null===(f=this._ansiToHtmlElement)||void 0===f||f.parseLinesToColoredPre(g),this._numberOfLines+=g.length,"empty"===this._loadingState&&setTimeout((function(){m._loadingState="loaded"}),100)),u&&this._logElement?this._scrollToBottom():this._newLogsIndicator=!0),e.next=21;break;case 31:e.next=48;break;case 33:if(this._streamSupported=!1,v="",!(0,H.x)(this.hass,"hassio")||!this.provider){e.next=44;break}return e.next=38,(0,L.RE)(this.hass,this.provider);case 38:return p=e.sent,e.next=41,p.text();case 41:v=e.sent,e.next=47;break;case 44:return e.next=46,(0,S.L)(this.hass);case 46:v=e.sent;case 47:v&&(null===(k=this._ansiToHtmlElement)||void 0===k||k.parseTextToColoredPre(v),this._loadingState="loaded",this._scrollToBottom());case 48:e.next=55;break;case 50:if(e.prev=50,e.t0=e.catch(6),"AbortError"!==e.t0.name){e.next=54;break}return e.abrupt("return");case 54:this._error=this.hass.localize("ui.panel.config.logs.failed_get_logs",{provider:this.provider,error:(0,T.VR)(e.t0)});case 55:case"end":return e.stop()}}),e,this,[[6,50]])}))),function(){return R.apply(this,arguments)})},{kind:"field",key:"_debounceSearch",value:function(){var e=this;return(0,M.s)((function(){var r;e._noSearchResults=!(null!==(r=e._ansiToHtmlElement)&&void 0!==r&&r.filterLines(e.filter)),e.filter||e._scrollToBottom()}),150)}},{kind:"field",key:"_debounceScrollToBottom",value:function(){var e=this;return(0,M.s)((function(){e._logElement.scrollTop=e._logElement.scrollHeight}),300)}},{kind:"method",key:"_scrollToBottom",value:function(){this._logElement&&(this._newLogsIndicator=!1,"core"!==this.provider?this._logElement.scrollTo(0,this._logElement.scrollHeight):this._debounceScrollToBottom())}},{kind:"field",key:"_handleConnectionStatus",value:function(){var e=this;return function(r){"disconnected"===r.detail&&e._logStreamAborter&&e._logStreamAborter.abort(),"connected"===r.detail&&e.show&&e._loadLogs()}}},{kind:"method",key:"_loadMoreLogs",value:(b=(0,g.A)((0,h.A)().mark((function e(){var r,t,o,n,i,a,s=this;return(0,h.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._firstCursor||"loading"===this._loadingPrevState||"loaded"!==this._loadingState||!this._logElement){e.next=17;break}return r=this._scrolledToBottomController.value,t=this._logElement.scrollHeight-this._logElement.scrollTop,this._loadingPrevState="loading",e.next=6,(0,L.RE)(this.hass,this.provider,"entries=".concat(this._firstCursor,":-100:100"));case 6:if(!(o=e.sent).headers.has("X-First-Cursor")){e.next=12;break}if(this._firstCursor!==o.headers.get("X-First-Cursor")){e.next=11;break}return this._loadingPrevState="end",e.abrupt("return");case 11:this._firstCursor=o.headers.get("X-First-Cursor");case 12:return e.next=14,o.text();case 14:(n=e.sent)?(a=n.split("\n").filter((function(e){return""!==e.trim()})).reverse(),null===(i=this._ansiToHtmlElement)||void 0===i||i.parseLinesToColoredPre(a,!0),this._numberOfLines+=a.length,this._loadingPrevState="loaded"):this._loadingPrevState="end",r?this._scrollToBottom():"end"!==this._loadingPrevState&&this._logElement&&window.requestAnimationFrame((function(){s._logElement.scrollTop=s._logElement.scrollHeight-t}));case 17:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{kind:"field",key:"_handleTopScroll",value:function(){var e=this;return function(r){var t=r[0].isIntersecting;return!e._firstCursor||!t||"loaded"!==e._loadingState||e._loadingPrevState&&"loaded"!==e._loadingPrevState||e.filter||e._loadMoreLogs(),t}}},{kind:"field",static:!0,key:"styles",value:function(){return(0,y.AH)(u||(u=(0,f.A)([".error-log-intro{text-align:center;margin:16px}ha-card{padding-top:8px;position:relative}ha-card.hidden{display:none}ha-card .action-buttons{display:flex;align-items:center;height:100%}.header{display:flex;justify-content:space-between;padding:0 16px}.card-header{color:var(--ha-card-header-color,var(--primary-text-color));font-family:var(--ha-card-header-font-family, inherit);font-size:var(--ha-card-header-font-size, 24px);letter-spacing:-.012em;line-height:48px;display:block;margin-block-start:0px;font-weight:400;white-space:nowrap;max-width:calc(100% - 150px);overflow:hidden;text-overflow:ellipsis}ha-icon-button{float:right}.error-log{position:relative;font-family:var(--code-font-family, monospace);clear:both;text-align:left;padding-top:12px;padding-bottom:12px;overflow-y:scroll;min-height:var(--error-log-card-height,calc(100vh - 240px));max-height:var(--error-log-card-height,calc(100vh - 240px));border-top:1px solid var(--divider-color)}@media all and (max-width:870px){.error-log{min-height:var(--error-log-card-height,calc(100vh - 190px));max-height:var(--error-log-card-height,calc(100vh - 190px))}}.error-log>div{overflow:auto;overflow-wrap:break-word}.error-log>div:hover{background-color:var(--secondary-background-color)}.new-logs-indicator{--mdc-theme-primary:var(--text-primary-color);overflow:hidden;position:absolute;bottom:0;left:0;right:0;height:0;background-color:var(--primary-color);border-radius:8px;transition:height .4s ease-out;display:flex;justify-content:space-between;align-items:center}.new-logs-indicator.visible{height:24px}.error{color:var(--error-color)}.warning{color:var(--warning-color)}.loading-old{display:flex;width:100%;justify-content:center;padding:16px}"])))}}]}}),y.WF)},30489:function(e,r,t){t.d(r,{R:function(){return o}});var o=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=document.createElement("a");t.target="_blank",t.href=e,t.download=r,document.body.appendChild(t),t.dispatchEvent(new MouseEvent("click")),document.body.removeChild(t)}}}]);
//# sourceMappingURL=50575.313CpFa1nqI.js.map