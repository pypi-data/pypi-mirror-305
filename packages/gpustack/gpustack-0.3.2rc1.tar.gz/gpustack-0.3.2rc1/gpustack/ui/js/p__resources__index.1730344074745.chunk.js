"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[485],{91845:function(e,t,n){n.r(t),n.d(t,{default:function(){return ge}});var r=n(48305),a=n.n(r),s=n(54562),o=n(99178),l=n(71162),i=n(50959),d=n(90228),c=n.n(d),u=n(87999),m=n.n(u),x=n(26068),f=n.n(x),p=n(33883),g=n(40198),h=n(45348),v=n(65421),j=n(11527),y=(0,i.memo)((function(e){var t=e.percent,n=(e.steps,e.download),r=e.label,a=(0,i.useMemo)((function(){return n?"var(--ant-color-primary)":t<=50?"var(--color-progress-green)":t<=80?"var(--ant-color-warning)":"var(--ant-color-error)"}),[t]);return(0,j.jsx)(j.Fragment,{children:r?(0,j.jsx)(h.Z,{title:r,children:(0,j.jsx)(v.Z,{percentPosition:{align:"center",type:"inner"},size:[void 0,16],format:function(){return(0,j.jsxs)("span",{style:{color:"#fff"},children:[t,"%"]})},percent:t,strokeColor:a})}):(0,j.jsx)(v.Z,{type:"line",percentPosition:{align:"center",type:"inner"},size:[void 0,16],format:function(){return(0,j.jsxs)("span",{style:{color:"#fff"},children:[t,"%"]})},percent:t,strokeColor:a})})})),b=n(51980),k=n(71239),w=n(56838),Z=n(44901),M=n(30720),C=n(79302),P=n(21363),I=n(32699),S=n.n(I),_=n(13172),z=Z.Z.Column,O=function(){var e=(0,o.useIntl)(),t=(0,b.Z)({defaultSortOrder:"descend"}),n=(t.sortOrder,t.setSortOrder),r=(0,i.useState)({dataList:[],loading:!1,total:0}),s=a()(r,2),l=s[0],d=s[1],u=(0,i.useState)({page:1,perPage:10,search:""}),x=a()(u,2),h=x[0],v=x[1],I=function(){var e=m()(c()().mark((function e(){var t,n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d((function(e){return e.loading=!0,f()({},e)})),e.prev=1,t=f()({},S().pickBy(h,(function(e){return!!e}))),e.next=5,(0,_.oz)(t);case 5:n=e.sent,d({dataList:n.items||[],loading:!1,total:n.pagination.total}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),d({dataList:[],loading:!1,total:l.total});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){I()}),[h]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(g.Z,{marginBottom:10,marginTop:10,left:(0,j.jsxs)(M.Z,{children:[(0,j.jsx)(C.Z,{placeholder:e.formatMessage({id:"common.filter.name"}),style:{width:300},allowClear:!0,onChange:function(e){v(f()(f()({},h),{},{search:e.target.value}))}}),(0,j.jsx)(P.ZP,{type:"text",style:{color:"var(--ant-color-text-tertiary)"},onClick:function(e){I()},icon:(0,j.jsx)(w.Z,{})})]})}),(0,j.jsxs)(Z.Z,{dataSource:l.dataList,loading:l.loading,rowKey:"id",onChange:function(e,t,r){n(r.order)},pagination:{showSizeChanger:!0,pageSize:h.perPage,current:h.page,total:l.total,hideOnSinglePage:10===h.perPage,onChange:function(e,t){v(f()(f()({},h),{},{page:e,perPage:t||10}))}},children:[(0,j.jsx)(z,{title:e.formatMessage({id:"common.table.name"}),dataIndex:"name",render:function(e,t){return(0,j.jsx)(p.Z,{ghost:!0,style:{width:"100%"},children:e})}},"name"),(0,j.jsx)(z,{title:e.formatMessage({id:"resources.table.index"}),dataIndex:"index",render:function(e,t){return(0,j.jsx)("span",{children:t.index})}},"index"),(0,j.jsx)(z,{title:e.formatMessage({id:"resources.table.workername"}),dataIndex:"worker_name",width:200,render:function(e,t){return(0,j.jsx)("span",{style:{display:"flex",width:"100%"},children:(0,j.jsx)(p.Z,{ghost:!0,maxWidth:340,children:e})})}},"worker_name"),(0,j.jsx)(z,{title:e.formatMessage({id:"resources.table.vender"}),dataIndex:"vendor"},"vendor"),(0,j.jsx)(z,{title:"".concat(e.formatMessage({id:"resources.table.temperature"})," (Â°C)"),dataIndex:"temperature",render:function(e,t){return(0,j.jsx)("span",{children:e?S().round(e,1):"-"})}},"Temperature"),(0,j.jsx)(z,{title:e.formatMessage({id:"resources.table.gpuutilization"}),dataIndex:"gpuUtil",render:function(e,t){var n;return(0,j.jsx)(j.Fragment,{children:t.core?(0,j.jsx)(y,{percent:S().round(null===(n=t.core)||void 0===n?void 0:n.utilization_rate,2)}):"-"})}},"gpuUtil"),(0,j.jsx)(z,{title:e.formatMessage({id:"resources.table.vramutilization"}),dataIndex:"VRAM",render:function(t,n){var r,a,s,o,l,i,d;return(0,j.jsx)(y,{percent:null!==(r=n.memory)&&void 0!==r&&r.used?S().round(null===(a=n.memory)||void 0===a?void 0:a.utilization_rate,0):S().round((null===(s=n.memory)||void 0===s?void 0:s.allocated)/(null===(o=n.memory)||void 0===o?void 0:o.total),0),label:(0,j.jsxs)("span",{className:"flex-column",children:[(0,j.jsxs)("span",{children:[e.formatMessage({id:"resources.table.total"}),":"," ",(0,k.hy)(null===(l=n.memory)||void 0===l?void 0:l.total,0)]}),(0,j.jsxs)("span",{children:[e.formatMessage({id:"resources.table.used"}),":"," ",(0,k.hy)((null===(i=n.memory)||void 0===i?void 0:i.used)||(null===(d=n.memory)||void 0===d?void 0:d.allocated),0)]})]})})}},"VRAM")]})]})},N=(0,i.memo)(O),W=n(94186),R=n(16056),T=n(60073),L=n(93495),U=n(34531),A=n(48660),B=n(69070),F=n(19019),V=n(4423),E=n(14251),K=n(94299),G=n(82092),D=n.n(G),q=n(12526),H="ready",$="not_ready",J=D()(D()({},H,"Ready"),$,"Not Ready"),Q=D()(D()({},H,q.iE.success),$,q.iE.error),X={getToken:"cat /var/lib/gpustack/token",registerWorker:function(e){return"curl -sfL https://get.gpustack.ai | sh -s - --server-url ".concat(e," --token mytoken")}},Y={getToken:'Get-Content -Path (Join-Path -Path $env:APPDATA -ChildPath "gpustack\\token") -Raw',registerWorker:function(e){return'Invoke-Expression "& { $((Invoke-WebRequest -Uri "https://get.gpustack.ai" -UseBasicParsing).Content) } --server-url '.concat(e,' --token mytoken"')}},ee=n(16333),te=n(95600),ne=function(e){var t=e||{},n=t.open,r=t.onCancel,a=(0,o.useIntl)(),s=window.location.origin;return(0,j.jsx)(te.Z,{title:a.formatMessage({id:"resources.button.create"}),open:n,centered:!0,onCancel:r,destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:(0,j.jsxs)("div",{children:[(0,j.jsxs)("h3",{children:["1. ",a.formatMessage({id:"resources.worker.add.step1"})]}),(0,j.jsx)("h4",{children:a.formatMessage({id:"resources.worker.linuxormaxos"})}),(0,j.jsx)(ee.Z,{code:X.getToken,theme:"dark"}),(0,j.jsx)("h4",{children:"Windows "}),(0,j.jsx)(ee.Z,{code:Y.getToken,theme:"dark"}),(0,j.jsxs)("h3",{children:["2. ",a.formatMessage({id:"resources.worker.add.step2"})," ",(0,j.jsx)("span",{className:"font-size-12",style:{color:"var(--ant-color-text-tertiary)"},dangerouslySetInnerHTML:{__html:"(".concat(a.formatMessage({id:"resources.worker.add.step2.tips"}),")")}})]}),(0,j.jsx)("h4",{children:a.formatMessage({id:"resources.worker.linuxormaxos"})}),(0,j.jsx)(ee.Z,{code:X.registerWorker(s),theme:"dark"}),(0,j.jsx)("h4",{children:"Windows "}),(0,j.jsx)(ee.Z,{theme:"dark",code:Y.registerWorker(s)}),(0,j.jsxs)("h3",{children:["3. ",a.formatMessage({id:"resources.worker.add.step3"})]})]})})},re=i.memo(ne),ae=n(77674),se=n(7215),oe=n(92233),le=n(78681),ie=n(56377),de=(n(9763),function(e){var t=e||{},n=t.open,r=t.onCancel,s=t.data,l=t.onOk,i=(0,o.useIntl)(),d=le.Z.useForm(),c=a()(d,1)[0],u=le.Z.useWatch("labels",c);return(0,j.jsx)(te.Z,{title:i.formatMessage({id:"resources.button.edit"}),open:n,centered:!0,onCancel:r,destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,styles:{content:{padding:"0px"},header:{padding:"var(--ant-modal-content-padding)",paddingBottom:"0"},body:{padding:"0"},footer:{padding:"0 var(--ant-modal-content-padding)"}},footer:(0,j.jsx)(se.Z,{onOk:function(){c.submit()},onCancel:r}),children:(0,j.jsx)(ie.Z,{style:{maxHeight:"550px"},children:(0,j.jsxs)(le.Z,{name:"deployModel",form:c,onFinish:l,preserve:!1,clearOnDestroy:!0,initialValues:{name:s.name,labels:s.labels},style:{padding:"var(--ant-modal-content-padding)",paddingBlock:0},children:[(0,j.jsx)(le.Z.Item,{name:"name",children:(0,j.jsx)(oe.Z.Input,{label:i.formatMessage({id:"common.table.name"}),disabled:!0})}),(0,j.jsx)(le.Z.Item,{name:"labels",rules:[function(){return{validator:function(e,t){return S().keys(t).length>0&&S().some(S().keys(t),(function(e){return!t[e]}))?Promise.reject(i.formatMessage({id:"common.validate.value"},{name:i.formatMessage({id:"resources.form.label"})})):Promise.resolve()}}}],children:(0,j.jsx)(ae.Z,{label:i.formatMessage({id:"resources.table.labels"}),labels:u,btnText:"common.button.addLabel",onChange:function(e){c.setFieldValue("labels",e)}})})]})})})}),ce=i.memo(de),ue=Z.Z.Column,me=[{label:"common.button.edit",key:"edit",icon:(0,j.jsx)(A.Z,{})},{label:"common.button.delete",key:"delete",props:{danger:!0},icon:(0,j.jsx)(B.Z,{})}],xe=function(){var e=(0,b.Z)({defaultSortOrder:"descend"}),t=(e.sortOrder,e.setSortOrder),n=(0,i.useRef)(null),r=(0,U.Z)(),s=(0,o.useIntl)(),l=(0,i.useState)(!1),d=a()(l,2),u=d[0],x=d[1],v=(0,i.useState)({dataList:[],loading:!1,total:0}),I=a()(v,2),z=I[0],O=I[1],N=(0,i.useState)({page:1,perPage:10,search:""}),A=a()(N,2),G=A[0],D=A[1],q=(0,i.useState)({open:!1,data:{}}),H=a()(q,2),$=H[0],X=H[1],Y=(0,i.useCallback)(m()(c()().mark((function e(){var t,n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O((function(e){return e.loading=!0,f()({},e)})),e.prev=1,t=f()({},S().pickBy(G,(function(e){return!!e}))),e.next=5,(0,_.Sw)(t);case 5:n=e.sent,O({dataList:n.items,loading:!1,total:n.pagination.total}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),O({dataList:[],loading:!1,total:z.total});case 13:case"end":return e.stop()}}),e,null,[[1,9]])}))),[G]),ee=(0,i.useCallback)((function(e,n,r){t(r.order)}),[]),te=function(e,t){return t&&e?S().round(e/t*100,0):0},ne=function(){x(!0)},ae=function(e){var t=S().find(e,(function(e){return"/"===e.mount_point}));return t?(0,j.jsxs)("span",{className:"flex-column",children:[(0,j.jsxs)("span",{children:[s.formatMessage({id:"resources.table.total"}),":"," ",(0,k.hy)(null==t?void 0:t.total,0)]}),(0,j.jsxs)("span",{children:[s.formatMessage({id:"resources.table.used"}),":"," ",(0,k.hy)(null==t?void 0:t.used,0)]})]}):0},se=(0,i.useCallback)(function(){var e=m()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,(0,_.Vq)($.data.id,f()(f()({},$.data),{},{labels:t.labels}));case 4:E.ZP.success(s.formatMessage({id:"common.message.success"})),Y(),X({open:!1,data:{}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),[$,Y]),oe=(0,i.useCallback)((function(){X(f()(f()({},$),{},{open:!1}))}),[]),le=function(e,t){var r;"edit"!==e?"delete"===e&&(r=t,n.current.show({content:"worker",name:r.name,onOk:function(){return m()(c()().mark((function e(){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,(0,_.lM)(r.id);case 3:Y();case 4:case"end":return e.stop()}}),e)})))()}})):function(e){X({open:!0,data:f()({},e)})}(t)};return(0,i.useEffect)((function(){Y()}),[G]),(0,K.y1)(L.ZP.CREATE.join(","),ne,{enabled:!u}),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(g.Z,{marginBottom:10,marginTop:10,left:(0,j.jsxs)(M.Z,{children:[(0,j.jsx)(C.Z,{placeholder:s.formatMessage({id:"common.filter.name"}),style:{width:300},allowClear:!0,onChange:function(e){D(f()(f()({},G),{},{search:e.target.value}))}}),(0,j.jsx)(P.ZP,{type:"text",style:{color:"var(--ant-color-text-tertiary)"},onClick:function(e){Y()},icon:(0,j.jsx)(w.Z,{})})]}),right:(0,j.jsxs)(M.Z,{size:20,children:[(0,j.jsx)(P.ZP,{icon:(0,j.jsx)(F.Z,{}),type:"primary",onClick:ne,children:s.formatMessage({id:"resources.button.create"})}),(0,j.jsx)(P.ZP,{icon:(0,j.jsx)(B.Z,{}),danger:!0,onClick:function(){n.current.show({content:"wokers",selection:!0,onOk:function(){return m()(c()().mark((function e(){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.D6)(r.selectedRowKeys,_.lM);case 2:r.clearSelections(),Y();case 4:case"end":return e.stop()}}),e)})))()}})},disabled:!r.selectedRowKeys.length,children:s.formatMessage({id:"common.button.delete"})})]})}),(0,j.jsxs)(Z.Z,{style:{width:"100%"},dataSource:z.dataList,loading:z.loading,rowKey:"id",onChange:ee,rowSelection:r,pagination:{showSizeChanger:!0,pageSize:G.perPage,current:G.page,total:z.total,hideOnSinglePage:10===G.perPage,onChange:function(e,t){D(f()(f()({},G),{},{page:e,perPage:t||10}))}},children:[(0,j.jsx)(ue,{title:s.formatMessage({id:"common.table.name"}),dataIndex:"name",width:100,render:function(e,t){return(0,j.jsx)(p.Z,{ghost:!0,maxWidth:240,children:(0,j.jsx)("span",{children:t.name})})}},"name"),(0,j.jsx)(ue,{title:s.formatMessage({id:"resources.table.labels"}),dataIndex:"labels",width:200,render:function(e,t){return(0,j.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,maxWidth:200},children:S().map(t.labels,(function(e,t){return(0,j.jsxs)(p.Z,{className:"m-r-0",maxWidth:120,children:[t,":",e]},t)}))})}},"labels"),(0,j.jsx)(ue,{title:s.formatMessage({id:"common.table.status"}),dataIndex:"state",render:function(e,t){return(0,j.jsx)(T.Z,{statusValue:{status:Q[t.state],text:J[t.state],message:t.state_message}})}},"state"),(0,j.jsx)(ue,{title:"IP",dataIndex:"ip"},"address"),(0,j.jsx)(ue,{title:"CPU",dataIndex:"CPU",render:function(e,t){var n;return(0,j.jsx)(y,{percent:S().round(null==t||null===(n=t.status)||void 0===n||null===(n=n.cpu)||void 0===n?void 0:n.utilization_rate,0)})}},"CPU"),(0,j.jsx)(ue,{title:s.formatMessage({id:"resources.table.memory"}),dataIndex:"memory",render:function(e,t){var n,r,a,o;return(0,j.jsx)(y,{percent:te(null==t||null===(n=t.status)||void 0===n||null===(n=n.memory)||void 0===n?void 0:n.used,null==t||null===(r=t.status)||void 0===r||null===(r=r.memory)||void 0===r?void 0:r.total),label:(0,j.jsxs)("span",{className:"flex-column",children:[(0,j.jsxs)("span",{children:[s.formatMessage({id:"resources.table.total"}),":"," ",(0,k.hy)(null==t||null===(a=t.status)||void 0===a||null===(a=a.memory)||void 0===a?void 0:a.total,0)]}),(0,j.jsxs)("span",{children:[s.formatMessage({id:"resources.table.used"}),":"," ",(0,k.hy)(null==t||null===(o=t.status)||void 0===o||null===(o=o.memory)||void 0===o?void 0:o.used,0)]})]})})}},"Memory"),(0,j.jsx)(ue,{title:"GPU",dataIndex:"GPU",render:function(e,t){var n;return(0,j.jsx)("span",{className:"flex-column flex-gap-2",children:S().map(S().sortBy((null==t||null===(n=t.status)||void 0===n?void 0:n.gpu_devices)||[],["index"]),(function(e,t){var n;return(0,j.jsxs)("span",{className:"flex-center",children:[(0,j.jsxs)("span",{className:"m-r-5",style:{display:"flex",width:25},children:["[",e.index,"]"]}),e.core?(0,j.jsx)(y,{percent:S().round(null===(n=e.core)||void 0===n?void 0:n.utilization_rate,0)},t):"-"]},t)}))})}},"GPU"),(0,j.jsx)(ue,{title:s.formatMessage({id:"resources.table.vram"}),dataIndex:"VRAM",render:function(e,t){var n;return(0,j.jsx)("span",{className:"flex-column flex-gap-2",children:S().map(S().sortBy((null==t||null===(n=t.status)||void 0===n?void 0:n.gpu_devices)||[],["index"]),(function(e,t){var n,r,a,o,l,i,d;return(0,j.jsx)("span",{children:(0,j.jsxs)("span",{className:"flex-center",children:[(0,j.jsxs)("span",{className:"m-r-5",style:{display:"flex",width:25},children:["[",e.index,"]"]}),(0,j.jsx)(y,{percent:null!==(n=e.memory)&&void 0!==n&&n.used?S().round(null===(r=e.memory)||void 0===r?void 0:r.utilization_rate,0):S().round((null===(a=e.memory)||void 0===a?void 0:a.allocated)/(null===(o=e.memory)||void 0===o?void 0:o.total)*100,0),label:(0,j.jsxs)("span",{className:"flex-column",children:[(0,j.jsxs)("span",{children:[s.formatMessage({id:"resources.table.total"}),": ",(0,k.hy)(null===(l=e.memory)||void 0===l?void 0:l.total,0)]}),(0,j.jsxs)("span",{children:[s.formatMessage({id:"resources.table.used"}),":"," ",(0,k.hy)((null===(i=e.memory)||void 0===i?void 0:i.used)||(null===(d=e.memory)||void 0===d?void 0:d.allocated),0)]})]})},t),e.memory.is_unified_memory&&(0,j.jsx)(h.Z,{title:s.formatMessage({id:"resources.table.unified"}),children:(0,j.jsx)(V.Z,{className:"m-l-5"})})]})},t)}))})}},"VRAM"),(0,j.jsx)(ue,{title:s.formatMessage({id:"resources.table.disk"}),dataIndex:"storage",render:function(e,t){var n,r,a;return(0,j.jsx)(y,{percent:(r=null===(n=t.status)||void 0===n?void 0:n.filesystem,a=S().find(r,(function(e){return"/"===e.mount_point})),a?te(a.used,a.total):0),label:ae(t.status.filesystem)})}},"storage"),(0,j.jsx)(ue,{title:s.formatMessage({id:"common.table.operation"}),render:function(e,t){return(0,j.jsx)(R.Z,{items:me,onSelect:function(e){return le(e,t)}})}},"operation")]}),(0,j.jsx)(W.Z,{ref:n}),(0,j.jsx)(re,{open:u,onCancel:function(){return x(!1)}}),(0,j.jsx)(ce,{open:$.open,onOk:se,onCancel:oe,data:{name:$.data.name,labels:$.data.labels}})]})},fe=(0,i.memo)(xe),pe=[{key:"workers",label:"Workers",children:(0,j.jsx)(fe,{})},{key:"gpus",label:"GPUs",children:(0,j.jsx)(N,{})}],ge=function(){var e=(0,i.useState)("workers"),t=a()(e,2),n=t[0],r=t[1],d=(0,o.useIntl)(),c=(0,i.useCallback)((function(e){r(e)}),[]);return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(s._z,{ghost:!0,header:{title:d.formatMessage({id:"resources.title"})},extra:[],children:(0,j.jsx)("div",{style:{marginTop:30},children:(0,j.jsx)(l.Z,{type:"card",defaultActiveKey:"workers",items:pe,accessKey:n,onChange:c})})})})}}}]);