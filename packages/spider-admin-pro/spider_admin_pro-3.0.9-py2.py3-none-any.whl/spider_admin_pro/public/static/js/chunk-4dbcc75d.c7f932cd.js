(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dbcc75d"],{"4a11":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"flex items-center"},[r("SelectScrapydServer",{attrs:{value:e.scrapydServerId},on:{"update:value":function(t){e.scrapydServerId=t},"on-init":e.handleSelectScrapydServerInit,change:e.resetData}}),e._v(" "),r("ProjectAdd",{staticClass:"ml-md",attrs:{scrapydServerId:e.scrapydServerId},on:{success:e.getData}})],1),e._v(" "),r("div",{staticStyle:{height:"20px"}}),e._v(" "),r("ProjectTable",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,scrapydServerId:e.scrapydServerId},on:{success:e.getData}})],1)},n=[],s=r("6194"),c=(r("5dce"),r("29ca")),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{},[r("mo-table",e._g(e._b({},"mo-table",e.$attrs,!1),e.$listeners),[r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index+1)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"项目名","header-align":"center",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.project)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"查看版本",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("router-link",{attrs:{to:{name:"project-version",query:{project:t.row.project,scrapydServerId:e.scrapydServerId}}}},[r("i",{staticClass:"el-icon-folder-opened"}),e._v(" 版本\n        ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"查看Spider",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("router-link",{attrs:{to:{name:"spider-list",query:{project:t.row.project,scrapydServerId:e.scrapydServerId}}}},[r("i",{staticClass:"el-icon-tickets"}),e._v(" Spider\n        ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"查看任务",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("router-link",{attrs:{to:{name:"job-list",query:{project:t.row.project,scrapydServerId:e.scrapydServerId}}}},[r("i",{staticClass:"el-icon-date"}),e._v(" 任务\n        ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"查看日志",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("router-link",{attrs:{to:{name:"logs-project",query:{project:t.row.project,scrapydServerId:e.scrapydServerId}}}},[r("i",{staticClass:"el-icon-document"}),e._v(" 日志\n        ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"更新版本",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("ProjectAdd",{attrs:{scrapydServerId:e.scrapydServerId,project:t.row.project,type:"edit"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"删除项目",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("ProjectDelete",{attrs:{scrapydServerId:e.scrapydServerId,project:t.row.project},on:{success:function(t){return e.$emit("success")}}})]}}])})],1)],1)},l=[],o=(r("0ef1"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-popconfirm",{attrs:{title:"确定删除？"},on:{confirm:e.handleDelete}},[r("el-button",e._b({staticClass:"color--danger",attrs:{slot:"reference",size:"mini",icon:"el-icon-delete",type:"text"},slot:"reference"},"el-button",e.$attrs,!1),[e._v("删除")])],1)}),u=[],d={name:"",props:{project:{type:String},scrapydServerId:{type:String|Number,default:null}},components:{},data:function(){return{}},computed:{},methods:{handleDelete:function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(){var t;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$Http.scrapydDeleteProject({project:this.project,scrapydServerId:this.scrapydServerId});case 2:t=e.sent,0==t.code?(this.$message.success("删除成功"),this.$emit("success")):this.$message.error(t.msg);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){}},p=d,f=r("c9cd"),v=Object(f["a"])(p,o,u,!1,null,"6e43784c",null),h=v.exports,m=r("f794"),y={name:"",props:{scrapydServerId:{type:String|Number,default:null}},components:{ProjectDelete:h,ProjectAdd:m["a"]},data:function(){return{}},computed:{},methods:{getData:function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.getData()}},g=y,b=Object(f["a"])(g,i,l,!1,null,"575b5aaa",null),S=b.exports,_=r("61e0"),j={components:{ProjectTable:S,ProjectAdd:m["a"],SelectScrapydServer:_["a"]},data:function(){return{list:null,listLoading:!0,scrapydServerId:null}},created:function(){this.scrapydServerId=this.$route.query.scrapydServerId,this.scrapydServerId&&(this.scrapydServerId=this.scrapydServerId+"")},methods:{resetData:function(){this.getData()},getData:function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(){var t;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.scrapydServerId){e.next=2;break}return e.abrupt("return");case 2:return this.listLoading=!0,e.next=5,this.$Http.scrapydListProjects({scrapydServerId:this.scrapydServerId});case 5:t=e.sent,this.listLoading=!1,this.list=t.data;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSelectScrapydServerInit:function(e){var t=e.list;console.log(t),this.scrapydServerId||t&&t.length>0&&(this.scrapydServerId=t[0].value),this.getData()}}},w=j,I=Object(f["a"])(w,a,n,!1,null,"58db3e3c",null);t["default"]=I.exports},"61e0":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",e._g(e._b({attrs:{placeholder:"选择服务"},model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}},"el-select",e.$attrs,!1),e.$listeners),e._l(e.list,(function(e){return r("el-option",{attrs:{label:e.label,value:e.value}})})),1)},n=[],s=r("6194"),c=(r("5dce"),r("29ca")),i={name:"",props:{value:{type:String}},components:{},data:function(){return{list:[]}},computed:{_value:{get:function(){return this.value},set:function(e){this.$emit("update:value",e)}}},methods:{getData:function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(){var t,r;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$Http.getScrapydServerPage();case 2:t=e.sent,r=t.data.list.map((function(e){return{label:e.server_name,value:e.id+""}})),this.list=r,this.$emit("on-init",{list:r});case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.getData()}},l=i,o=r("c9cd"),u=Object(o["a"])(l,a,n,!1,null,"a9e36160",null);t["a"]=u.exports},f794:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{},["edit"==e.type?r("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"text"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("编辑")]):r("el-button",{attrs:{size:"mini",icon:"el-icon-document-add",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加")]),e._v(" "),r("el-dialog",{attrs:{title:"添加项目",visible:e.dialogVisible,width:"500px",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"status-icon":"","label-width":"80px",size:"small"}},[r("el-form-item",{attrs:{label:"项目名称",prop:"project",required:""}},[r("ProjectSearch",{staticStyle:{width:"360px"},attrs:{value:e.form.project,scrapydServerId:e.scrapydServerId,disabled:null!=e.project},on:{"update:value":function(t){return e.$set(e.form,"project",t)}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"项目文件",prop:"egg",required:""}},[r("el-upload",{ref:"upload",attrs:{drag:"",action:"",accept:".egg","auto-upload":!1,multiple:!1,"show-file-list":!1,"on-change":e.handleChange}},[r("i",{staticClass:"el-icon-upload"}),e._v(" "),r("div",{staticClass:"el-upload__text"},[e._v("\n            将文件拖到此处，或"),r("em",[e._v("点击上传")])]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[r("span",[e._v("只能上传egg文件。")]),r("span",[e._v("推荐使用：")]),r("a",{staticClass:"mo-link",attrs:{href:"https://pypi.org/project/scrapyd-client/",target:"_blank"}},[e._v("scrapyd-client")])])]),e._v(" "),r("span",[e._v(e._s(e.form.egg.name))])],1)],1),e._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addVersion}},[e._v("确 定")])],1)],1)],1)},n=[],s=(r("8354"),r("4294"),r("6194")),c=(r("5dce"),r("29ca")),i=(r("0ef1"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-autocomplete",e._b({attrs:{"fetch-suggestions":e.querySearch},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[r("span",[e._v(e._s(a.project))])]}}]),model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}},"el-autocomplete",e.$attrs,!1))}),l=[],o={name:"",props:{value:{type:String},scrapydServerId:{type:String|Number,default:null}},components:{},data:function(){return{list:[]}},computed:{_value:{get:function(){return this.value},set:function(e){this.$emit("update:value",e)}}},methods:{querySearch:function(e,t){var r=e?this.filterItem(e):this.list;t(r)},filterItem:function(e){return this.list.filter((function(t){return 0==t.project.toLowerCase().indexOf(e.toLowerCase())}))},handleSelect:function(e){this._value=e.project},getData:function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(){var t;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.scrapydServerId){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.$Http.scrapydListProjects({scrapydServerId:this.scrapydServerId});case 4:t=e.sent,this.list=t.data;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.getData()}},u=o,d=r("c9cd"),p=Object(d["a"])(u,i,l,!1,null,"6d26cbfe",null),f=p.exports,v={name:"",props:{type:{type:String,default:"add"},project:{type:String,default:null},scrapydServerId:{type:String|Number,default:null}},components:{ProjectSearch:f},data:function(){return{dialogVisible:!1,form:{project:"",egg:""}}},computed:{disabled:function(){return!Boolean(this.scrapydServerId)}},watch:{dialogVisible:function(e){e&&(this.form.project=this.project)}},methods:{addVersion:function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(){var t,r,a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$loading({fullscreen:!0}),r=new FormData,r.append("project",this.form.project),r.append("egg",this.form.egg),r.append("scrapydServerId",this.scrapydServerId),e.next=7,this.$Http.scrapydAddVersion(r);case 7:a=e.sent,0==a.code?(this.$message.success("上传成功"),this.$emit("success"),this.dialogVisible=!1):this.$message.error(a.msg),t.close();case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleChange:function(e,t){console.log(e),this.form.egg=e.raw,this.form.project=e.name.replace(".egg","")},resetForm:function(){this.$refs.form.resetFields()}},created:function(){}},h=v,m=Object(d["a"])(h,a,n,!1,null,"0a138223",null);t["a"]=m.exports}}]);