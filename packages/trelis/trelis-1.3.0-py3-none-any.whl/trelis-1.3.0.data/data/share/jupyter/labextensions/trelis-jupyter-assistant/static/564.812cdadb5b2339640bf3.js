"use strict";(self.webpackChunktrelis_jupyter_assistant=self.webpackChunktrelis_jupyter_assistant||[]).push([[564],{564:(e,n,t)=>{t.r(n),t.d(n,{default:()=>E});var o=t(869),a=t(918),r=t(528),i=t(439),s=t(256);const c="https://jupyter.trelis.com";class l extends s.Widget{constructor(e,n){super(),this.notebookTracker=e,this.chatHistory=[],this.addClass("jp-ChatbotWidget"),this.chatContainer=document.createElement("div"),this.inputArea=document.createElement("textarea"),this.rendermime=n,this.initializeWidget(),this.checkStoredApiKey()}initializeWidget(){this.node.style.display="flex",this.node.style.flexDirection="column",this.node.style.height="100%",this.apiKeyContainer=document.createElement("div"),this.apiKeyContainer.className="api-key-container";const e=document.createElement("div");e.className="api-key-input-group";const n=document.createElement("label");n.innerHTML=`API Key (<a href="${c}" target="_blank">Get one here</a>)`,this.apiKeyInput=document.createElement("input"),this.apiKeyInput.type="password",this.apiKeyInput.className="api-key-input";const t=document.createElement("div");t.className="save-key-container";const o=document.createElement("input");o.type="checkbox",o.id="save-key";const a=document.createElement("label");a.htmlFor="save-key",a.textContent="Remember API key";const r=document.createElement("button");r.textContent="Save",r.className="save-button",r.onclick=()=>this.saveApiKey(),t.appendChild(o),t.appendChild(a),t.appendChild(r),e.appendChild(n),e.appendChild(this.apiKeyInput),e.appendChild(t),this.apiKeyContainer.appendChild(e);const i=document.createElement("div");i.className="chat-interface",this.chatContainer=document.createElement("div"),this.chatContainer.className="chat-container";const s=document.createElement("div");s.className="input-container",this.inputArea=document.createElement("textarea"),this.inputArea.rows=3,this.inputArea.className="input-area",this.inputArea.addEventListener("keydown",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),this.handleSend())}));const l=document.createElement("div");l.className="send-button-container";const d=document.createElement("div");d.style.display="flex",d.style.alignItems="center";const p=document.createElement("button");p.textContent="Send",p.className="send-button",p.onclick=()=>this.handleSend();const u=document.createElement("span");u.className="send-button-hint",u.textContent="(or press Enter)";const h=document.createElement("div");h.style.display="flex",h.style.alignItems="center";const m=document.createElement("button");m.textContent="New Chat",m.className="new-chat-button",m.onclick=()=>this.startNewChat();const g=document.createElement("a");g.textContent="(Log Out)",g.className="logout-link",g.onclick=()=>this.handleLogout(),d.appendChild(p),d.appendChild(u),h.appendChild(m),h.appendChild(g),l.appendChild(d),l.appendChild(h),s.appendChild(this.inputArea),s.appendChild(l);const b=document.createElement("div");b.className="chat-footer";const y=document.createElement("a");y.href="https://github.com/TrelisResearch/Trelis-Assistant/",y.target="_blank",y.textContent="FAQ & Support",y.className="support-link",b.appendChild(y),i.appendChild(this.chatContainer),i.appendChild(s),i.appendChild(b),this.node.appendChild(this.apiKeyContainer),this.node.appendChild(i)}startNewChat(){this.chatContainer.innerHTML="",this.inputArea.value="",this.chatHistory=[],console.log("Chat history cleared")}async addMessage(e,n){const t=document.createElement("div");if(t.className=`chat-message ${e}-message`,"user"===e){const e=document.createElement("div");e.className="message-header";const o=document.createElement("button");o.className="edit-message-button",o.innerHTML="✎ Edit",o.onclick=()=>this.handleMessageEdit(t,n),e.appendChild(o),t.appendChild(e);const a=await this.renderMarkdown(n);t.appendChild(a)}else{const e=await this.renderAssistantMessage(n);t.appendChild(e)}this.chatContainer.appendChild(t),this.chatContainer.scrollTop=this.chatContainer.scrollHeight}async validateApiKey(e){console.log("Attempting to validate API key...");try{const n=`${c}/api/v1/validate-key`;console.log("Sending request to:",n);const t=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:e})});return console.log("Validation response:",t.status),t.ok?!0===(await t.json()).valid:!1}catch(e){return console.error("Detailed error validating API key:",e),!1}}async handleSend(e){var n,t,o,a,r,i,s;const l=e||this.inputArea.value.trim();if(!l)return void alert("Please enter a message");const d=this.apiKeyInput.value.trim();if(!d)return alert("Please enter an API key first"),void(this.apiKeyContainer.style.display="block");const p=new AbortController,{signal:u}=p;try{this.setLoadingState(!0);const e=this.node.querySelector(".send-button"),h=document.createElement("button");h.textContent="Cancel",h.className="cancel-button",h.onclick=()=>{p.abort(),this.cleanupAfterRequest()},null===(n=e.parentElement)||void 0===n||n.appendChild(h),this.chatHistory.push({role:"user",content:l}),await this.addMessage("user",l),this.inputArea.value="";const m=document.createElement("div");m.className="chat-message assistant-message generating-message",this.chatContainer.appendChild(m);const g=150;this.chatContainer.scrollTo({top:this.chatContainer.scrollHeight-this.chatContainer.clientHeight+g,behavior:"smooth"});const b=this.notebookTracker.currentWidget;if(!b||!b.model)return console.warn("No active notebook found"),void await this.addMessage("assistant","Please open a notebook to use this feature.");const y=this.getNotebookCells(b.content);console.log("Sending notebook cells to backend:",y);const f=await fetch(`${c}/api/v1/chat`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":d},body:JSON.stringify({message:l,chat_history:this.chatHistory,notebook_cells:y,stream:!0}),signal:u});if(!f.ok){const e=await f.json();if(401===f.status)return localStorage.removeItem("trelis_api_key"),this.apiKeyContainer.style.display="block",this.apiKeyInput.value="",void await this.addMessage("assistant","Invalid API key. Please enter a valid API key.");if(429===f.status){const n=(null===(t=e.detail)||void 0===t?void 0:t.message)||"Rate limit exceeded",s=(null===(o=e.detail)||void 0===o?void 0:o.resets_at)||"every 30 days",l=(null===(a=e.detail)||void 0===a?void 0:a.subscription_url)||c;return void await this.addMessage("assistant",`⚠️ ${n}. Your quota will reset ${s}.\nUsed: ${null===(r=e.detail)||void 0===r?void 0:r.used}/${null===(i=e.detail)||void 0===i?void 0:i.limit} requests.\n\n[Click here to upgrade your plan](${l})`)}throw new Error(e.detail||"An error occurred")}const x=f.body.getReader(),v=new TextDecoder;let k="";const C=document.createElement("div");for(C.className="streaming-content",C.style.width="100%",C.style.position="relative",m.innerHTML="",m.appendChild(C);;){const{value:e,done:n}=await x.read();if(n)break;k+=v.decode(e);const t=await this.renderMarkdown(k),o=C.offsetHeight;t.style.minHeight=`${o}px`;const a=document.createElement("div");a.className="streaming-content",a.appendChild(t),C.innerHTML="",C.appendChild(a)}const w=document.createElement("div");w.className="chat-message assistant-message";const A=await this.renderMarkdown(k);w.appendChild(A);const E=null===(s=this.chatContainer.querySelector(".streaming-content"))||void 0===s?void 0:s.parentElement;E&&E.replaceWith(w),this.addCodeBlockButtons(w,k),this.chatHistory.push({role:"assistant",content:k})}catch(e){if(e instanceof Error&&"AbortError"===e.name){console.log("Request cancelled by user"),this.chatHistory.pop();const e=this.chatContainer.lastElementChild;e&&this.chatContainer.removeChild(e),this.inputArea.value=l;const n=this.chatContainer.querySelector(".generating-message");n&&this.chatContainer.removeChild(n)}else console.error("Error:",e),this.chatHistory.pop(),await this.addMessage("assistant","An error occurred while fetching the response.")}finally{this.cleanupAfterRequest(),this.setLoadingState(!1)}}cleanupAfterRequest(){this.inputArea.disabled=!1;const e=this.node.querySelector(".send-button");e.disabled=!1,e.textContent="Send";const n=this.node.querySelector(".cancel-button");n&&n.remove(),this.chatContainer.querySelectorAll(".generating-message, .streaming-content").forEach((e=>e.remove()))}async checkStoredApiKey(){console.log("Checking stored API key...");const e=localStorage.getItem("trelis_api_key");e&&(console.log("Found stored key"),this.apiKeyInput.value=e,await this.validateApiKey(e)?this.apiKeyContainer.style.display="none":localStorage.removeItem("trelis_api_key"))}async saveApiKey(){console.log("Save API key triggered");const e=this.apiKeyInput.value.trim(),n=this.node.querySelector("#save-key");e?await this.validateApiKey(e)?((null==n?void 0:n.checked)&&localStorage.setItem("trelis_api_key",e),this.apiKeyContainer.style.display="none"):alert("Invalid API key. Please check and try again."):alert("Please enter an API key")}async renderAssistantMessage(e){const n=document.createElement("div");try{const t=await this.renderMarkdown(e);n.appendChild(t);const o=n.querySelectorAll("pre code"),a=this.parseCodeSuggestions(e);o.forEach((e=>{var n;const t=e.textContent||"",o=e.parentElement;if(!o)return;const r=document.createElement("div");r.className="code-container",null===(n=o.parentNode)||void 0===n||n.replaceChild(r,o),r.appendChild(o);const i=document.createElement("div");i.className="button-container";const s=a.find((([e,n])=>n.trim()===t.trim()));if(s){const[e,n]=s,o=this.createScrollButton(e),a=this.createReplaceButton(e,t);i.appendChild(o),i.appendChild(a)}const c=this.createCopyButton(t);i.appendChild(c),r.appendChild(i)}))}catch(t){console.error("Error rendering markdown:",t),n.textContent=e}return n}createReplaceButton(e,n){const t=document.createElement("button");return t.textContent=`Replace cell ${e}`,t.className="replace-button",t.onclick=()=>this.replaceCode(e,n),t}createScrollButton(e){const n=document.createElement("button");return n.textContent=`Scroll to ${e}`,n.className="scroll-button",n.onclick=()=>this.scrollToCell(e),n}scrollToCell(e){const n=this.notebookTracker.currentWidget;if(n){const t=e-1;n.content.activeCellIndex=t;const o=n.content.widgets[t];o&&o.node.scrollIntoView({behavior:"smooth",block:"center"})}}createCopyButton(e){const n=document.createElement("button");return n.innerHTML='<svg width="16" height="16" fill="currentColor" class="bi bi-files" viewBox="0 0 16 16">\n        <path d="M13 0H3a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM3 1h10a1 1 0 0 1 1 1v1H2V2a1 1 0 0 1 1-1zm10 14H3a1 1 0 0 1-1-1V4h10v10a1 1 0 0 1-1 1z"/>\n    </svg>',n.className="copy-button",n.onclick=()=>{navigator.clipboard.writeText(e).then((()=>{console.log("Code copied to clipboard")}))},n}async renderMarkdown(e){const n="text/markdown",t=new i.MimeModel({data:{[n]:e},metadata:{}}),o=this.rendermime.createRenderer(n);return await o.renderModel(t),o.node}parseCodeSuggestions(e){const n=[],t=/```(?:\w*)\n([\s\S]+?)\n```/g;let o;for(;null!==(o=t.exec(e));){const t=o[1].trim(),a=Math.max(0,o.index-75),r=[...e.substring(a,o.index).matchAll(/(?:In\s+)?cell\s+(?:\[)?(\d+)(?:\])?/gi)],i=r[r.length-1];if(i){const e=parseInt(i[1]);isNaN(e)||n.push([e,t])}}return n}replaceCode(e,n){const t=this.notebookTracker.currentWidget;if(t){const o=e-1,a=t.content.widgets[o];if(a&&"code"===a.model.type){const e=n.replace(/\n+$/,"");a.model.sharedModel.setSource(e)}}}setLoadingState(e){const n=this.node.querySelector(".input-area"),t=this.node.querySelector(".send-button");e?(n.disabled=!0,t.disabled=!0,t.textContent="Generating..."):(n.disabled=!1,t.disabled=!1,t.textContent="Send")}handleLogout(){localStorage.removeItem("trelis_api_key"),this.apiKeyInput.value="",this.apiKeyContainer.style.display="block"}async handleMessageEdit(e,n){const t=document.createElement("textarea");t.className="edit-message-textarea",t.value=n;const o=document.createElement("div");o.className="edit-buttons-container";const a=document.createElement("button");a.className="edit-save-button",a.textContent="Save";const r=document.createElement("button");r.className="edit-cancel-button",r.textContent="Cancel";const i=document.createElement("div");i.className="edit-wrapper";const s=async()=>{var o;const a=t.value.trim();if(a!==n){const n=Array.from(this.chatContainer.children).indexOf(e);-1!==n&&(this.chatHistory[n].content=a,this.chatHistory=this.chatHistory.slice(0,n+1),console.log("Updated chat history after edit:",this.chatHistory));let t=e.nextElementSibling;for(;t;){const e=t;t=t.nextElementSibling,e.remove()}e.remove(),await this.handleSend(a)}else{const t=await this.renderMarkdown(n);null===(o=e.querySelector(".edit-wrapper"))||void 0===o||o.replaceWith(t)}};t.addEventListener("keydown",(async e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),await s())})),a.onclick=s,r.onclick=async()=>{var t;const o=await this.renderMarkdown(n);null===(t=e.querySelector(".edit-wrapper"))||void 0===t||t.replaceWith(o)},o.appendChild(a),o.appendChild(r),i.appendChild(t),i.appendChild(o);const c=e.querySelector(".chat-message > :not(.message-header)");c&&c.replaceWith(i),t.focus()}getNotebookCells(e){if(!e||!e.model)return console.warn("No active notebook found"),[];const n=e.model.toJSON();return n&&n.cells?n.cells.map(((e,n)=>e.outputs&&0!==e.outputs.length?{...e,execution_count:e.execution_count||n+1,outputs:e.outputs.map((e=>{var n;if("error"===e.output_type)return{output_type:"error",content:{error_type:e.ename,error_message:e.evalue,traceback:e.traceback}};let t="";return"stream"===e.output_type?t=e.text||"":"execute_result"!==e.output_type&&"display_data"!==e.output_type||(t=(null===(n=e.data)||void 0===n?void 0:n["text/plain"])||JSON.stringify(e.data||{})),{output_type:e.output_type,content:t}})).filter(Boolean)}:{...e,execution_count:e.execution_count||n+1})):(console.warn("No cells found in notebook"),[])}addCodeBlockButtons(e,n){const t=e.querySelectorAll("pre code"),o=this.parseCodeSuggestions(n);t.forEach((e=>{var n;const t=e.textContent||"",a=e.parentElement;if(!a)return;const r=document.createElement("div");r.className="code-container",null===(n=a.parentNode)||void 0===n||n.replaceChild(r,a),r.appendChild(a);const i=document.createElement("div");i.className="button-container";const s=o.find((([e,n])=>n.trim()===t.trim()));if(s){const[e,n]=s,o=this.createScrollButton(e),a=this.createReplaceButton(e,t);i.appendChild(o),i.appendChild(a)}const c=this.createCopyButton(t);i.appendChild(c),r.appendChild(i)}))}}var d=t(72),p=t.n(d),u=t(825),h=t.n(u),m=t(659),g=t.n(m),b=t(56),y=t.n(b),f=t(540),x=t.n(f),v=t(113),k=t.n(v),C=t(646),w={};w.styleTagTransform=k(),w.setAttributes=y(),w.insert=g().bind(null,"head"),w.domAPI=h(),w.insertStyleElement=x(),p()(C.A,w),C.A&&C.A.locals&&C.A.locals;const A={id:"trelis-jupyter-assistant:plugin",description:"A JupyterLab Code Assistant",autoStart:!0,requires:[r.INotebookTracker,i.IRenderMimeRegistry],optional:[a.ISettingRegistry,o.ILayoutRestorer],activate:(e,n,t,o,a)=>{console.log("JupyterLab extension trelis-jupyter-assistant is activated!");const r=new l(n,t);r.id="trelis-chatbot",r.title.label="Trelis",r.title.closable=!0,e.shell.add(r,"right",{rank:1e3}),a&&a.add(r,"trelis-chatbot"),o&&o.load(A.id).then((e=>{console.log("trelis-jupyter-assistant settings loaded:",e.composite)})).catch((e=>{console.error("Failed to load settings for trelis-jupyter-assistant.",e)}))}},E=A},475:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),a=t.n(o),r=t(314),i=t.n(r)()(a());i.push([e.id,"/*\n    See the JupyterLab Developer Guide for useful CSS Patterns:\n\n    https://jupyterlab.readthedocs.io/en/stable/developer/css.html\n*/\n",""]);const s=i},646:(e,n,t)=>{t.d(n,{A:()=>l});var o=t(601),a=t.n(o),r=t(314),i=t.n(r),s=t(475),c=i()(a());c.i(s.A),c.push([e.id,'#trelis-chatbot {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n}\n\n.jp-ChatbotWidget {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n  padding: 10px;\n}\n\n.chat-interface {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.chat-container {\n  flex-grow: 1;\n  overflow-y: auto;\n  margin-bottom: 20px;\n  padding: 10px;\n}\n\n.chat-message {\n  margin: 10px 0;\n  padding: 10px;\n  border-radius: 8px;\n  position: relative;\n  padding-left: 20px;\n  transition: height 0.3s ease-out, opacity 0.3s ease-out;\n  width: calc(100% - 20px);\n  box-sizing: border-box;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  hyphens: auto;\n}\n\n.user-message {\n  border-left: 4px solid #4CAF50;\n  background-color: #f5f9f5;\n  width: calc(100% - 20px);\n  box-sizing: border-box;\n  margin: 10px 0;\n}\n\n.assistant-message {\n  border-left: 4px solid #0f579b;\n  background-color: #f8f9fa;\n  width: calc(100% - 20px);\n  box-sizing: border-box;\n  margin: 10px 0;\n}\n\n/* Remove the "You:" and "Trelis Assistant:" labels from the messages */\n.chat-message strong {\n  display: none;\n}\n\n/* Style for the generating message */\n.generating-message {\n  color: #666;\n  padding: 10px;\n  margin: 10px 0;\n  background-color: #f8f9fa;\n  border-left: 4px solid #0f579b;\n  padding-left: 20px;\n  transition: opacity 0.3s ease-out;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.generating-message::after {\n  content: "...";\n  animation: loading-dots 1.5s infinite;\n  width: 1em;\n  display: inline-block;\n  font-style: italic;\n}\n\n@keyframes loading-dots {\n  0% { content: "."; }\n  33% { content: ".."; }\n  66% { content: "..."; }\n}\n\n.code-container {\n  display: flex;\n  flex-direction: column; /* Stack children vertically */\n  position: relative;\n  margin: 0.5rem 0;\n  padding: 0.25rem;\n  background-color: #f8f8f8;\n  border-radius: 4px;\n}\n\n.code-container pre {\n  padding: 0.25rem;\n  margin: 0;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.button-container {\n  display: flex;\n  gap: 8px; /* Space between buttons */\n  align-items: center;\n  margin-top: 8px; /* Space between code and buttons */\n}\n\n.replace-button {\n  background-color: #0f579b;\n  color: white;\n  border: none;\n  padding: 5px 10px;\n  cursor: pointer;\n  border-radius: 4px;\n  font-size: 12px;\n}\n\n.input-container {\n  display: flex;\n  flex-direction: column;\n  border-top: 1px solid #ccc;\n  padding-top: 10px;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.input-area {\n  width: 100%;\n  min-height: 10rem;\n  max-height: 25rem;\n  margin-bottom: 1rem;\n  resize: vertical;\n  overflow-y: auto;\n  padding: 8px;\n  border-radius: 4px;\n  border: 1px solid #ccc;\n  box-sizing: border-box;\n}\n\n.send-button-container {\n  display: flex;\n  flex-direction: column;\n  gap: 10px; /* Space between buttons */\n}\n\n/* Style for the send button and hint */\n.send-button {\n  background-color: #0f579b;\n  color: white;\n  border: none;\n  padding: 8px 15px;\n  cursor: pointer;\n  border-radius: 4px;\n  width: 100px;\n}\n\n.send-button-hint {\n  font-style: italic;\n  color: #666;\n  margin-left: 10px;\n}\n\n.copy-button {\n  background-color: transparent;\n  border: none;\n  cursor: pointer;\n  display: inline-flex;\n  align-items: center;\n}\n\n.copy-button svg {\n  width: 16px; /* Adjust size as needed */\n  height: 16px; /* Adjust size as needed */\n  fill: #0f579b; /* Match the theme color */\n}\n\n/* Optional: Add hover effect */\n.copy-button:hover {\n  opacity: 0.7; /* Slightly fade on hover */\n}\n\n.api-key-container {\n  padding: 15px;\n  margin-bottom: 15px;\n  border-bottom: 1px solid #ccc;\n}\n\n.api-key-input-group {\n  margin-bottom: 10px;\n}\n\n.api-key-input-group label {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: 500;\n}\n\n.api-key-input-group label a {\n  color: #0f579b;\n  text-decoration: none;\n}\n\n.api-key-input-group label a:hover {\n  text-decoration: underline;\n}\n\n.api-key-input {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  font-size: 14px;\n  margin-bottom: 10px;\n}\n\n.api-key-actions-group {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.get-api-key-link {\n  color: #0f579b;\n  text-decoration: none;\n  font-size: 14px;\n}\n\n.get-api-key-link:hover {\n  text-decoration: underline;\n}\n\n.save-key-container {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.save-key-container input[type="checkbox"] {\n  margin: 0;\n}\n\n.save-key-container label {\n  font-size: 14px;\n}\n\n.save-button {\n  background-color: #0f579b;\n  color: white;\n  border: none;\n  padding: 6px 12px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.save-button:hover {\n  background-color: #0d4a84;\n}\n\n.error-message {\n  background-color: #ffebee;\n  border-left: 4px solid #f44336;\n  padding: 10px;\n  margin: 10px 0;\n  font-family: monospace;\n  white-space: pre-wrap;\n}\n\n.send-button:disabled {\n  background-color: #cccccc;\n  cursor: not-allowed;\n}\n\n.input-area:disabled {\n  background-color: #f5f5f5;\n  cursor: not-allowed;\n}\n\n/* Add styles for the button container */\n.action-buttons-container {\n  display: flex;\n  gap: 10px;\n  margin-top: 10px;\n}\n\n/* Style for the New Chat button */\n.new-chat-button {\n  background-color: #4CAF50;\n  color: white;\n  border: none;\n  padding: 8px 15px;\n  cursor: pointer;\n  border-radius: 4px;\n  width: 100px;\n  align-self: flex-start; /* Align with the Send button */\n}\n\n.new-chat-button:hover {\n  background-color: #45a049;\n}\n\n/* Add style for the scroll button */\n.scroll-button {\n  background-color: #6c757d;  /* Different color to distinguish from replace button */\n  color: white;\n  border: none;\n  padding: 5px 10px;\n  cursor: pointer;\n  border-radius: 4px;\n  font-size: 12px;\n}\n\n.scroll-button:hover {\n  background-color: #5a6268;\n}\n\n.logout-link {\n  margin-left: 10px;\n  color: #666;\n  text-decoration: none;\n  font-style: italic;\n}\n\n.logout-link:hover {\n  text-decoration: underline;\n  cursor: pointer;\n}\n\n/* Add these styles for markdown headings */\n.chat-message h1 {\n  font-size: 1.3em;\n  margin: 0.5em 0;\n}\n\n.chat-message h2 {\n  font-size: 1.2em;\n  margin: 0.4em 0;\n}\n\n.chat-message h3 {\n  font-size: 1.1em;\n  margin: 0.3em 0;\n}\n\n.chat-message h4, .chat-message h5, .chat-message h6 {\n  font-size: 1em;\n  margin: 0.2em 0;\n}\n\n/* Add styles for the support link footer */\n.chat-footer {\n    padding: 8px 0;\n    text-align: center;\n    border-top: 1px solid #eee;\n    margin-top: 10px;\n}\n\n.support-link {\n    color: #666;\n    text-decoration: none;\n    font-size: 0.9em;\n}\n\n.support-link:hover {\n    text-decoration: underline;\n    color: #0f579b;\n}\n\n.cancel-button {\n    background-color: #dc3545;\n    color: white;\n    border: none;\n    padding: 8px 15px;\n    cursor: pointer;\n    border-radius: 4px;\n    margin-left: 10px;\n}\n\n.cancel-button:hover {\n    background-color: #c82333;\n}\n\n/* Add styles for message editing */\n.message-header {\n    display: flex;\n    justify-content: flex-end;\n    margin-bottom: 4px;\n}\n\n.edit-message-button {\n    background: none;\n    border: none;\n    color: #666;\n    cursor: pointer;\n    padding: 2px 6px;\n    font-size: 14px;\n}\n\n.edit-message-button:hover {\n    color: #333;\n}\n\n.edit-wrapper {\n    width: 100%;\n    padding: 0;  /* Match the padding of the message */\n    box-sizing: border-box;\n}\n\n.edit-message-textarea {\n    width: 100%;\n    min-height: 60px;\n    padding: 8px;\n    margin: 4px 0;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    font-family: inherit;\n    font-size: inherit;\n    resize: vertical;\n    box-sizing: border-box;\n}\n\n.edit-buttons-container {\n    display: flex;\n    gap: 8px;\n    justify-content: flex-end;\n    margin-top: 8px;\n}\n\n.edit-save-button, .edit-cancel-button {\n    padding: 4px 12px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 12px;\n}\n\n.edit-save-button {\n    background-color: #4CAF50;\n    color: white;\n}\n\n.edit-cancel-button {\n    background-color: #6c757d;\n    color: white;\n}\n\n.edit-save-button:hover {\n    background-color: #45a049;\n}\n\n.edit-cancel-button:hover {\n    background-color: #5a6268;\n}\n\n/* Ensure smooth transitions for markdown content */\n.chat-message p,\n.chat-message h1,\n.chat-message h2,\n.chat-message h3,\n.chat-message pre,\n.chat-message code {\n    transition: opacity 0.2s ease-out;\n    width: 100%;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n}\n\n/* Add a subtle fade-in effect for new content */\n.chat-message.new-content {\n    animation: fade-in 0.3s ease-out;\n}\n\n@keyframes fade-in {\n    from { opacity: 0; }\n    to { opacity: 1; }\n}\n\n/* Add these styles to prevent text jittering */\n.generating-message {\n    /* ... existing styles ... */\n    contain: content;  /* Contain layout recalculations */\n    width: 100%;\n    box-sizing: border-box;\n}\n\n/* Add a stable container for streaming content */\n.streaming-content {\n    contain: content;\n    width: calc(100% - 20px);\n    box-sizing: border-box;\n    overflow-wrap: break-word;\n    word-wrap: break-word;\n    word-break: break-word;\n    hyphens: auto;\n    margin: 10px 0;\n}\n\n/* Ensure all inline elements maintain their width */\n.streaming-content * {\n    max-width: 100%;\n    box-sizing: border-box;\n}\n',""]);const l=c},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,o,a,r){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);o&&i[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),n.push(d))}},n}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var r={},i=[],s=0;s<e.length;s++){var c=e[s],l=o.base?c[0]+o.base:c[0],d=r[l]||0,p="".concat(l," ").concat(d);r[l]=d+1;var u=t(p),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)n[u].references++,n[u].updater(h);else{var m=a(h,o);o.byIndex=s,n.splice(s,0,{identifier:p,updater:m,references:1})}i.push(p)}return i}function a(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,a){var r=o(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<r.length;i++){var s=t(r[i]);n[s].references--}for(var c=o(e,a),l=0;l<r.length;l++){var d=t(r[l]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}r=c}}},659:e=>{var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var a=void 0!==t.layer;a&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,a&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var r=t.sourceMap;r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}}}]);