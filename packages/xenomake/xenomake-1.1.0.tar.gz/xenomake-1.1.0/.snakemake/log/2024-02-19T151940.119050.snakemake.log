Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job stats:
job                            count
---------------------------  -------
DGE_Human                          1
DGE_Mouse                          1
Expression_QC                      1
Extract_Xenograft_Readnames        1
Filter_MultiMapped_Human           1
Filter_MultiMapped_Mouse           1
H5ad_Human                         1
H5ad_Mouse                         1
HDF5_Human                         1
HDF5_Mouse                         1
Human_Downstream                   1
Human_Xenograft_BAM_Files          1
Merge_Human                        1
Merge_Mouse                        1
Mouse_Downstream                   1
Mouse_Xenograft_BAM_Files          1
Xengsort_Clasify                   1
all                                1
create_tissue_file                 1
filter_mm_ambiguous                1
filter_mm_both                     1
total                             21

Select jobs to execute...

[Mon Feb 19 15:19:40 2024]
rule Xengsort_Clasify:
    input: test/sub/sorting/overlapped.fastq, species/idx.info, species/idx.hash
    output: test/sub/xengsort/sub-host.fq.gz, test/sub/xengsort/sub-graft.fq.gz, test/sub/xengsort/sub-ambiguous.fq.gz, test/sub/xengsort/sub-neither.fq.gz, test/sub/xengsort/sub-both.fq.gz
    jobid: 14
    reason: Missing output files: test/sub/xengsort/sub-host.fq.gz, test/sub/xengsort/sub-neither.fq.gz, test/sub/xengsort/sub-ambiguous.fq.gz, test/sub/xengsort/sub-both.fq.gz, test/sub/xengsort/sub-graft.fq.gz
    wildcards: OUTDIR=test, sample=sub
    threads: 4
    resources: tmpdir=/tmp

[Mon Feb 19 15:20:05 2024]
Finished job 14.
1 of 21 steps (5%) done
Removing temporary output test/sub/sorting/overlapped.fastq.
Select jobs to execute...

[Mon Feb 19 15:20:05 2024]
rule Extract_Xenograft_Readnames:
    input: test/sub/xengsort/sub-host.fq.gz, test/sub/xengsort/sub-graft.fq.gz, test/sub/xengsort/sub-ambiguous.fq.gz, test/sub/xengsort/sub-neither.fq.gz, test/sub/xengsort/sub-both.fq.gz
    output: test/sub/xengsort/sub-host.txt, test/sub/xengsort/sub-graft.txt, test/sub/xengsort/sub-ambiguous.txt, test/sub/xengsort/sub-neither.txt, test/sub/xengsort/sub-both.txt
    jobid: 13
    reason: Missing output files: test/sub/xengsort/sub-host.txt, test/sub/xengsort/sub-ambiguous.txt, test/sub/xengsort/sub-both.txt; Input files updated by another job: test/sub/xengsort/sub-ambiguous.fq.gz, test/sub/xengsort/sub-both.fq.gz, test/sub/xengsort/sub-graft.fq.gz, test/sub/xengsort/sub-host.fq.gz, test/sub/xengsort/sub-neither.fq.gz
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp

[Mon Feb 19 15:20:16 2024]
Finished job 13.
2 of 21 steps (10%) done
Select jobs to execute...

[Mon Feb 19 15:20:16 2024]
rule Mouse_Xenograft_BAM_Files:
    input: test/sub/sorting/mouse_overlapped.bam, test/sub/xengsort/sub-host.txt, test/sub/xengsort/sub-ambiguous.txt, test/sub/xengsort/sub-both.txt
    output: test/sub/xengsort/mouse/sub-host.bam, test/sub/xengsort/mouse/sub-ambiguous.bam, test/sub/xengsort/mouse/sub-both.bam
    jobid: 18
    reason: Missing output files: test/sub/xengsort/mouse/sub-host.bam, test/sub/xengsort/mouse/sub-ambiguous.bam, test/sub/xengsort/mouse/sub-both.bam; Input files updated by another job: test/sub/xengsort/sub-host.txt, test/sub/xengsort/sub-ambiguous.txt, test/sub/xengsort/sub-both.txt
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp


[Mon Feb 19 15:20:16 2024]
rule Human_Xenograft_BAM_Files:
    input: test/sub/sorting/human_overlapped.bam, test/sub/xengsort/sub-host.txt, test/sub/xengsort/sub-ambiguous.txt, test/sub/xengsort/sub-both.txt
    output: test/sub/xengsort/human/sub-graft.bam, test/sub/xengsort/human/sub-ambiguous.bam, test/sub/xengsort/human/sub-both.bam
    jobid: 11
    reason: Missing output files: test/sub/xengsort/human/sub-ambiguous.bam, test/sub/xengsort/human/sub-graft.bam, test/sub/xengsort/human/sub-both.bam; Input files updated by another job: test/sub/xengsort/sub-host.txt, test/sub/xengsort/sub-ambiguous.txt, test/sub/xengsort/sub-both.txt
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp

[Mon Feb 19 15:20:53 2024]
Finished job 18.
3 of 21 steps (14%) done
Removing temporary output test/sub/sorting/mouse_overlapped.bam.
[Mon Feb 19 15:20:54 2024]
Finished job 11.
4 of 21 steps (19%) done
Removing temporary output test/sub/sorting/human_overlapped.bam.
Select jobs to execute...

[Mon Feb 19 15:20:55 2024]
rule filter_mm_both:
    input: test/sub/xengsort/mouse/sub-both.bam, test/sub/xengsort/human/sub-both.bam
    output: test/sub/xengsort/mouse/sub-both.filtered.bam, test/sub/xengsort/human/sub-both.filtered.bam
    jobid: 17
    reason: Missing output files: test/sub/xengsort/mouse/sub-both.filtered.bam, test/sub/xengsort/human/sub-both.filtered.bam; Input files updated by another job: test/sub/xengsort/mouse/sub-both.bam, test/sub/xengsort/human/sub-both.bam
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp


[Mon Feb 19 15:20:55 2024]
rule filter_mm_ambiguous:
    input: test/sub/xengsort/mouse/sub-ambiguous.bam, test/sub/xengsort/human/sub-ambiguous.bam
    output: test/sub/xengsort/mouse/sub-ambiguous.filtered.bam, test/sub/xengsort/human/sub-ambiguous.filtered.bam
    jobid: 19
    reason: Missing output files: test/sub/xengsort/mouse/sub-ambiguous.filtered.bam, test/sub/xengsort/human/sub-ambiguous.filtered.bam; Input files updated by another job: test/sub/xengsort/human/sub-ambiguous.bam, test/sub/xengsort/mouse/sub-ambiguous.bam
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp

[Mon Feb 19 15:20:56 2024]
Finished job 17.
5 of 21 steps (24%) done
Removing temporary output test/sub/xengsort/mouse/sub-both.bam.
Removing temporary output test/sub/xengsort/human/sub-both.bam.
[Mon Feb 19 15:20:57 2024]
Finished job 19.
6 of 21 steps (29%) done
Removing temporary output test/sub/xengsort/mouse/sub-ambiguous.bam.
Removing temporary output test/sub/xengsort/human/sub-ambiguous.bam.
Select jobs to execute...

[Mon Feb 19 15:20:57 2024]
rule Merge_Mouse:
    input: test/sub/mouse_remaining.bam, test/sub/xengsort/mouse/sub-host.bam, test/sub/xengsort/mouse/sub-both.filtered.bam, test/sub/xengsort/mouse/sub-ambiguous.filtered.bam
    output: test/sub/mouse_merged.bam
    jobid: 22
    reason: Missing output files: test/sub/mouse_merged.bam; Input files updated by another job: test/sub/xengsort/mouse/sub-both.filtered.bam, test/sub/xengsort/mouse/sub-ambiguous.filtered.bam, test/sub/xengsort/mouse/sub-host.bam
    wildcards: OUTDIR=test, sample=sub
    threads: 4
    resources: tmpdir=/tmp

[Mon Feb 19 15:21:25 2024]
Finished job 22.
7 of 21 steps (33%) done
Removing temporary output test/sub/mouse_remaining.bam.
Removing temporary output test/sub/xengsort/mouse/sub-host.bam.
Removing temporary output test/sub/xengsort/mouse/sub-both.filtered.bam.
Removing temporary output test/sub/xengsort/mouse/sub-ambiguous.filtered.bam.
Select jobs to execute...

[Mon Feb 19 15:21:26 2024]
rule Merge_Human:
    input: test/sub/human_remaining.bam, test/sub/xengsort/human/sub-graft.bam, test/sub/xengsort/human/sub-both.filtered.bam, test/sub/xengsort/human/sub-ambiguous.filtered.bam
    output: test/sub/human_merged.bam
    jobid: 3
    reason: Missing output files: test/sub/human_merged.bam; Input files updated by another job: test/sub/xengsort/human/sub-both.filtered.bam, test/sub/xengsort/human/sub-graft.bam, test/sub/xengsort/human/sub-ambiguous.filtered.bam
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp


[Mon Feb 19 15:21:26 2024]
rule Filter_MultiMapped_Mouse:
    input: test/sub/mouse_merged.bam
    output: test/sub/mouse_final.bam
    log: test/sub/logs/filter_mm.log
    jobid: 21
    reason: Missing output files: test/sub/mouse_final.bam; Input files updated by another job: test/sub/mouse_merged.bam
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp

[Mon Feb 19 15:22:05 2024]
Finished job 21.
8 of 21 steps (38%) done
Removing temporary output test/sub/mouse_merged.bam.
Select jobs to execute...
[Mon Feb 19 15:22:33 2024]
Finished job 3.
9 of 21 steps (43%) done
Removing temporary output test/sub/human_remaining.bam.
Removing temporary output test/sub/xengsort/human/sub-graft.bam.
Removing temporary output test/sub/xengsort/human/sub-both.filtered.bam.
Removing temporary output test/sub/xengsort/human/sub-ambiguous.filtered.bam.

[Mon Feb 19 15:22:33 2024]
rule DGE_Mouse:
    input: /home/bstrope/Documents/Xenomake/xenomake/data/barcodes/visium_barcodes.txt, test/sub/mouse_final.bam
    output: test/sub/final/sub_mouse_counts.tsv.gz, test/sub/qc/mouse.dge_summary, test/sub/final/sub_CellCell_counts.tsv.gz
    log: test/sub/logs/mouse_dge.log
    jobid: 20
    reason: Missing output files: test/sub/final/sub_mouse_counts.tsv.gz; Input files updated by another job: test/sub/mouse_final.bam
    wildcards: OUTDIR=test, sample=sub
    threads: 4
    resources: tmpdir=/tmp

[Mon Feb 19 15:23:42 2024]
Finished job 20.
10 of 21 steps (48%) done
Select jobs to execute...

[Mon Feb 19 15:23:42 2024]
rule HDF5_Mouse:
    input: test/sub/final/sub_mouse_counts.tsv.gz
    output: test/sub/final/sub_mouse.hdf5
    jobid: 24
    reason: Missing output files: test/sub/final/sub_mouse.hdf5; Input files updated by another job: test/sub/final/sub_mouse_counts.tsv.gz
    wildcards: OUTDIR=test, sample=sub
    threads: 4
    resources: tmpdir=/tmp

[Mon Feb 19 15:23:50 2024]
Finished job 24.
11 of 21 steps (52%) done
Select jobs to execute...

[Mon Feb 19 15:23:50 2024]
rule Filter_MultiMapped_Human:
    input: test/sub/human_merged.bam
    output: test/sub/human_final.bam
    log: test/sub/logs/filter_mm.log
    jobid: 2
    reason: Missing output files: test/sub/human_final.bam; Input files updated by another job: test/sub/human_merged.bam
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp

[Mon Feb 19 15:24:23 2024]
Finished job 2.
12 of 21 steps (57%) done
Removing temporary output test/sub/human_merged.bam.
Select jobs to execute...

[Mon Feb 19 15:24:23 2024]
rule DGE_Human:
    input: test/sub/human_final.bam, /home/bstrope/Documents/Xenomake/xenomake/data/barcodes/visium_barcodes.txt
    output: test/sub/final/sub_human_counts.tsv.gz, test/sub/qc/human.dge_summary, test/sub/final/sub_CellInteract_counts.tsv.gz
    log: test/sub/logs/human_dge.log
    jobid: 1
    reason: Missing output files: test/sub/final/sub_human_counts.tsv.gz; Input files updated by another job: test/sub/human_final.bam
    wildcards: OUTDIR=test, sample=sub
    resources: tmpdir=/tmp

[Mon Feb 19 15:25:40 2024]
Finished job 1.
13 of 21 steps (62%) done
Select jobs to execute...

[Mon Feb 19 15:25:40 2024]
rule create_tissue_file:
    input: test/sub/final/sub_human_counts.tsv.gz
    output: test/sub/final/tissue_positions_list.csv
    jobid: 26
    reason: Missing output files: test/sub/final/tissue_positions_list.csv; Input files updated by another job: test/sub/final/sub_human_counts.tsv.gz
    wildcards: OUTDIR=test, sample=sub
    threads: 4
    resources: tmpdir=/tmp

[Mon Feb 19 15:25:47 2024]
Error in rule create_tissue_file:
    jobid: 26
    input: test/sub/final/sub_human_counts.tsv.gz
    output: test/sub/final/tissue_positions_list.csv
    shell:
        
        python /home/bstrope/Documents/Xenomake/xenomake/scripts/spatial_barcode.py --counts test/sub/final/sub_human_counts.tsv.gz         --output test/sub/final/tissue_positions_list.csv         --spatial_coordinates barcodes/visium_barcode_positions.csv
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Select jobs to execute...

[Mon Feb 19 15:25:47 2024]
rule HDF5_Human:
    input: test/sub/final/sub_human_counts.tsv.gz
    output: test/sub/final/sub_human.hdf5
    jobid: 23
    reason: Missing output files: test/sub/final/sub_human.hdf5; Input files updated by another job: test/sub/final/sub_human_counts.tsv.gz
    wildcards: OUTDIR=test, sample=sub
    threads: 4
    resources: tmpdir=/tmp

[Mon Feb 19 15:26:00 2024]
Finished job 23.
14 of 21 steps (67%) done
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2024-02-19T151940.119050.snakemake.log
