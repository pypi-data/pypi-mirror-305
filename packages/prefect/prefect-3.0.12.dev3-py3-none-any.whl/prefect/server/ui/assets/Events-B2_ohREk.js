import{d as ee,g as q,af as te,an as ne,ao as G,ap as ae,aq as se,ar as re,as as oe,at as le,au as ie,av as ue,w as Q,l as n,c as F,h as O,a as P,a8 as H,j as U,aw as ce,ax as de,o as B,k as y,K as fe,q as h,ay as me,a6 as j,az as pe,aA as ge,aB as ve,aC as ye,B as X,y as be,aD as _e,F as xe,aE as De,aF as ke}from"./index-BwaNCR84.js";import{g as Te,c as L}from"./_commonjsHelpers-Cpj98o6Y.js";import{u as Oe}from"./usePageTitle-Bm8pLAPB.js";var je="Expected a function",Z=NaN,Re="[object Symbol]",Ee=/^\s+|\s+$/g,Se=/^[-+]0x[0-9a-f]+$/i,Ie=/^0b[01]+$/i,Be=/^0o[0-7]+$/i,Ce=parseInt,Ne=typeof L=="object"&&L&&L.Object===Object&&L,Ve=typeof self=="object"&&self&&self.Object===Object&&self,Fe=Ne||Ve||Function("return this")(),Ue=Object.prototype,he=Ue.toString,Le=Math.max,ze=Math.min,W=function(){return Fe.Date.now()};function $e(e,o,u){var m,c,f,i,s,r,b=0,C=!1,_=!1,T=!0;if(typeof e!="function")throw new TypeError(je);o=J(o)||0,A(u)&&(C=!!u.leading,_="maxWait"in u,f=_?Le(J(u.maxWait)||0,o):f,T="trailing"in u?!!u.trailing:T);function x(t){var d=m,p=c;return m=c=void 0,b=t,i=e.apply(p,d),i}function R(t){return b=t,s=setTimeout(D,o),C?x(t):i}function z(t){var d=t-r,p=t-b,g=o-d;return _?ze(g,f-p):g}function E(t){var d=t-r,p=t-b;return r===void 0||d>=o||d<0||_&&p>=f}function D(){var t=W();if(E(t))return N(t);s=setTimeout(D,z(t))}function N(t){return s=void 0,T&&m?x(t):(m=c=void 0,i)}function $(){s!==void 0&&clearTimeout(s),b=0,m=r=c=s=void 0}function w(){return s===void 0?i:N(W())}function S(){var t=W(),d=E(t);if(m=arguments,c=this,r=t,d){if(s===void 0)return R(r);if(_)return s=setTimeout(D,o),x(r)}return s===void 0&&(s=setTimeout(D,o)),i}return S.cancel=$,S.flush=w,S}function A(e){var o=typeof e;return!!e&&(o=="object"||o=="function")}function we(e){return!!e&&typeof e=="object"}function Me(e){return typeof e=="symbol"||we(e)&&he.call(e)==Re}function J(e){if(typeof e=="number")return e;if(Me(e))return Z;if(A(e)){var o=typeof e.valueOf=="function"?e.valueOf():e;e=A(o)?o+"":o}if(typeof e!="string")return e===0?e:+e;e=e.replace(Ee,"");var u=Ie.test(e);return u||Be.test(e)?Ce(e.slice(2),u?2:8):Se.test(e)?Z:+e}var Pe=$e;const We=Te(Pe),Ae={class:"events__content"},Ke={class:"events__filters"},qe={class:"events__controls"},Y=6e4,Xe=ee({__name:"Events",setup(e){const o=q(()=>[{text:"Event Feed"}]),u=te(),{now:m}=ne({interval:Y});Oe("Event Feed");const c=G("resource",[]),f=G("events",[]),i=ae({type:"span",seconds:-ce}),{startDate:s,endDate:r}=se(),{selectionStart:b,selectionEnd:C}=re(),_={minRangeInSeconds:De-1,maxRangeInSeconds:ke-1},T=oe(()=>{const{startDate:g,endDate:a}=H.map("DateRangeSelectValue",i.range,"DateRange"),[k,v]=de(f.value,I=>I.endsWith("*")),M=k.map(I=>I.replace(".*",".")),l=["prefect.log.write"].filter(I=>!v.includes(I));return{occurred:{since:b.value??g,until:C.value??a},anyResource:{idPrefix:c.value},event:{prefix:M,name:v,excludeName:l}}}),{page:x,pages:R,loading:z,events:E,empty:D}=le(T,{interval:Y}),{margin:N}=ie(),$=()=>({rootMargin:N.value}),{stuck:w}=ue(u,$),S=q(()=>({chart:{"events__chart--stuck":w.value}}));let t=!1;const d=We(()=>{if(!(!s.value||!r.value)){if(t){t=!1;return}i.range={type:"range",startDate:s.value,endDate:r.value}}},1e3);Q([s,r],()=>d());function p(){var k,v;if(!i.range)return;const{startDate:g,endDate:a}=H.map("DateRangeSelectValue",i.range,"DateRange");((k=s.value)==null?void 0:k.getTime())!==g.getTime()&&(t=!0,s.value=g),((v=r.value)==null?void 0:v.getTime())!==a.getTime()&&(t=!0,r.value=a)}return Q(()=>i.range,()=>p()),p(),(g,a)=>{const k=U("p-label"),v=U("p-empty-results"),M=U("p-pager"),K=U("p-layout-default");return n(s)&&n(r)?(B(),F(K,{key:0,class:"events"},{header:O(()=>[y(n(fe),{crumbs:o.value},null,8,["crumbs"])]),default:O(()=>[h("div",Ae,[h("div",Ke,[y(k,{label:"Resource"},{default:O(({id:l})=>[y(n(me),{id:l,selected:n(c),"onUpdate:selected":a[0]||(a[0]=V=>j(c)?c.value=V:null),multiple:""},null,8,["id","selected"])]),_:1}),y(k,{label:"Events"},{default:O(({id:l})=>[y(n(pe),{id:l,selected:n(f),"onUpdate:selected":a[1]||(a[1]=V=>j(f)?f.value=V:null),multiple:""},null,8,["id","selected"])]),_:1})]),h("div",{ref_key:"chart",ref:u,class:ge(["events__chart p-background",S.value.chart])},[y(n(ve),{"start-date":n(s),"onUpdate:startDate":a[2]||(a[2]=l=>j(s)?s.value=l:null),"end-date":n(r),"onUpdate:endDate":a[3]||(a[3]=l=>j(r)?r.value=l:null),filter:T.value,"zoom-options":_},null,8,["start-date","end-date","filter"]),h("div",qe,[y(n(ye),{modelValue:n(i).range,"onUpdate:modelValue":a[4]||(a[4]=l=>n(i).range=l),max:n(m)},null,8,["modelValue","max"])])],2),n(z)&&n(D)?(B(),F(v,{key:0},{message:O(()=>a[7]||(a[7]=[X(" Loading events ")])),_:1})):(B(),be(xe,{key:1},[n(D)?(B(),F(v,{key:0},{message:O(()=>a[8]||(a[8]=[X(" No events ")])),_:1})):P("",!0),y(n(_e),{class:"events__timeline",events:n(E),"start-date":n(s),"end-date":n(r)},null,8,["events","start-date","end-date"]),n(E).length?(B(),F(M,{key:1,page:n(x),"onUpdate:page":a[5]||(a[5]=l=>j(x)?x.value=l:null),pages:n(R),"onUpdate:pages":a[6]||(a[6]=l=>j(R)?R.value=l:null),class:"events__pager"},null,8,["page","pages"])):P("",!0)],64))])]),_:1})):P("",!0)}}});export{Xe as default};
//# sourceMappingURL=Events-B2_ohREk.js.map
