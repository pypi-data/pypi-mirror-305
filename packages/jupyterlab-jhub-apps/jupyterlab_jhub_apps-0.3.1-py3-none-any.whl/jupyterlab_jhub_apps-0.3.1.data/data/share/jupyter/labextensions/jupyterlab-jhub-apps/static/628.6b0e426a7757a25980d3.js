"use strict";(self.webpackChunkjupyterlab_jhub_apps=self.webpackChunkjupyterlab_jhub_apps||[]).push([[628],{628:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var a=r(909);const s=new(r(460).LabIcon)({name:"jhub-apps:deploy-app",svgstr:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.19026 4.34976C5.15026 6.63976 3.75026 9.92976 3.62026 10.2398L1.36026 9.26976C0.71026 8.98976 0.55026 8.13976 1.05026 7.63976L4.06026 4.62976C4.53026 4.15976 5.21026 3.94976 5.87026 4.07976L7.19026 4.34976ZM8.68026 14.5098C8.98026 14.8098 9.42026 14.8898 9.80026 14.7098C10.9603 14.1698 13.4503 12.8998 15.0603 11.2898C19.6503 6.69976 19.6903 2.95976 19.4203 1.35976C19.3503 0.959761 19.0303 0.639761 18.6303 0.569761C17.0303 0.299761 13.2903 0.339761 8.70026 4.92976C7.09026 6.53976 5.83026 9.02976 5.28026 10.1898C5.10026 10.5698 5.19026 11.0198 5.48026 11.3098L8.68026 14.5098ZM15.6503 12.8098C13.3603 14.8498 10.0703 16.2498 9.76026 16.3798L10.7303 18.6398C11.0103 19.2898 11.8603 19.4498 12.3603 18.9498L15.3703 15.9398C15.8403 15.4698 16.0503 14.7898 15.9203 14.1298L15.6503 12.8098ZM6.94026 15.4098C7.14026 16.4698 6.79026 17.4498 6.12026 18.1198C5.35026 18.8898 2.96026 19.4598 1.41026 19.7598C0.720261 19.8898 0.11026 19.2798 0.24026 18.5898C0.54026 17.0398 1.10026 14.6498 1.88026 13.8798C2.55026 13.2098 3.53026 12.8598 4.59026 13.0598C5.76026 13.2798 6.72026 14.2398 6.94026 15.4098ZM11.0003 6.99976C11.0003 5.89976 11.9003 4.99976 13.0003 4.99976C14.1003 4.99976 15.0003 5.89976 15.0003 6.99976C15.0003 8.09976 14.1003 8.99976 13.0003 8.99976C11.9003 8.99976 11.0003 8.09976 11.0003 6.99976Z" fill="black" fill-opacity="0.54" class="jp-icon3"/>\n</svg>\n'});var n=r(200),o=r(256),i=r(614);function l(e){return Object.entries(e).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}const p="/services/japps/create-app",c="jupyterlab-jhub-apps:commands",d={queryParameters:{},baseUrl:p};var u;function h(e){d.queryParameters=e.get("queryParameters").composite,d.baseUrl=e.get("baseUrl").composite}!function(e){e.deployApp="jhub-apps:deploy-app"}(u||(u={}));const m=e=>{if("main-menu"!==e.origin)return s},g=[{id:c,description:"Adds additional commands used by jhub-apps.",autoStart:!0,requires:[i.ISettingRegistry],optional:[a.ILayoutRestorer],activate:async(e,t,r)=>{const{commands:a,shell:s}=e;try{const e=await t.load(c);h(e),e.changed.connect(h)}catch(e){return void console.warn(`Failed to load settings for ${c}:`,e)}const o=new n.WidgetTracker({namespace:"jhub-apps"});a.addCommand(u.deployApp,{label:"Deploy App",icon:m,execute:({origin:e,queryParameters:t=d.queryParameters,baseUrl:r=d.baseUrl,IShell:a=s,widgetTracker:i=o})=>{(({origin:e,baseUrl:t,IShell:r,widgetTracker:a,queryParameters:s={}})=>{if(!r||!a)return void console.warn("IShell and widgetTracker not defined. These are required to open the deploy app form.");const o=r.currentWidget,i=(p=o)&&p.context&&"string"==typeof p.context.path?o.context.path:"";var p;const c=void 0!==s.filepath?s.filepath:i,d=void 0===(u=s.headless)?"true":"string"==typeof u&&["true","false"].includes(u.toLowerCase())?u.toLowerCase():(console.warn(`Invalid value: ${u}. Defaulting to 'true'.`),"true");var u;const h={...s,headless:d,filepath:c};let m;if("true"===d)try{if(!m||m.isDisposed){const e=new y({baseUrl:t,queryParameters:h});m=new n.MainAreaWidget({content:e})}a.has(m)||a.add(m),e&&!m.isAttached&&r.add(m,"main")}catch(e){console.warn(`Error opening in headless mode: ${e}`)}else try{const e=`${t}?${l(h)}`;window.open(e,"_blank","noopener,noreferrer")}catch(e){console.warn(`Error opening in window: ${e}`)}})({origin:e,queryParameters:t,baseUrl:r,IShell:a,widgetTracker:i})}}),r&&r.restore(o,{command:u.deployApp,args:e=>({baseUrl:e.content.getBaseUrl(),queryParameters:e.content.getQueryParameters()}),name:e=>e.content.getCompleteUrl()})}}];class y extends o.Widget{constructor({baseUrl:e=p,queryParameters:t={}}){super(),this._baseUrl=e,this._queryParameters=t,this.addClass("jp-deploy-app-widget"),this.id="deploy-app-jupyterlab",this.title.label="Deploy App",this.title.closable=!0,this.title.icon=this._createIconRenderer(),this._iframe=new n.IFrame,this._iframe.sandbox=["allow-scripts","allow-same-origin","allow-popups","allow-forms"],this._iframe.url=this.getCompleteUrl(),this.node.appendChild(this._iframe.node)}getQueryParameters(){return this._queryParameters}getBaseUrl(){return this._baseUrl}getCompleteUrl(){return`${this._baseUrl}?${l(this._queryParameters)}`}_createIconRenderer(){return{render:e=>{s.element({container:e,width:"15px",elementPosition:"center"})}}}}}}]);