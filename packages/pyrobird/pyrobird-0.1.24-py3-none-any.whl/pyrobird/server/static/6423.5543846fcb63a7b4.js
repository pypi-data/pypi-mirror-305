"use strict";(self.webpackChunkfirebird=self.webpackChunkfirebird||[]).push([[6423],{6423:(F,X,M)=>{M.r(X),M.d(X,{drawBox:()=>k,drawEllipse:()=>L,drawJSImage:()=>R,drawMarker:()=>C,drawPie:()=>I,drawPolyLine:()=>O,drawPolyMarker:()=>B,drawText:()=>Y});var D=M(467),p=M(6998),S=M(5680),g=M(9041),m=M(6714),x=M(6370);function Y(){return E.apply(this,arguments)}function E(){return(E=(0,D.A)(function*(){const t=this.getObject(),d=this.getPadPainter(),l=d.getPadWidth(),o=d.getPadHeight(),s=this.getFramePainter();let h=t.fX,i=t.fY,r=1,n=this.matchObjectType(p.clTAnnotation);if(this.createAttText({attr:t}),n&&s?.mode3d&&(0,p.isFunc)(s?.convert3DtoPadNDC)){const e=s.convert3DtoPadNDC(t.fX,t.fY,t.fZ);h=e.x,i=e.y,this.isndc=!0,n="3d"}else t.TestBit((0,p.BIT)(14))?this.isndc=!0:d.getRootPad(!0)||(this.isndc=!0,h=i=.5,t.fTextAlign=22);this.createG(),this.draw_g.attr("transform",null),this.pos_x=this.axisToSvg("x",h,this.isndc),this.pos_y=this.axisToSvg("y",i,this.isndc);const a=this.textatt.createArg({x:this.pos_x,y:this.pos_y,text:t.fTitle,latex:0});return t._typename===p.clTLatex||n?(a.latex=1,r=.9):t._typename===p.clTMathText&&(a.latex=2,r=.8),this.startTextDrawing(this.textatt.font,this.textatt.getSize(l,o,r,.05)),this.drawText(a),this.finishTextDrawing().then(()=>(this.isBatchMode()||(this.pos_dx=this.pos_dy=0,this.moveDrag||(this.moveDrag=function(e,f){this.pos_dx+=e,this.pos_dy+=f,(0,g.bk)(this.draw_g,this.pos_dx,this.pos_dy)}),this.moveEnd||(this.moveEnd=function(e){if(e)return;const f=this.getObject();f.fX=this.svgToAxis("x",this.pos_x+this.pos_dx,this.isndc),f.fY=this.svgToAxis("y",this.pos_y+this.pos_dy,this.isndc),this.submitCanvExec(`SetX(${f.fX});;SetY(${f.fY});;`)}),"3d"!==n?(0,m.X2)(this):(s.processRender3D=!0,this.handleRender3D=()=>{const e=s.convert3DtoPadNDC(t.fX,t.fY,t.fZ),f=this.axisToSvg("x",e.x,!0),c=this.axisToSvg("y",e.y,!0);(0,g.bk)(this.draw_g,f-this.pos_x,c-this.pos_y)}),(0,x.wh)(this,x.Ew)),this))})).apply(this,arguments)}function O(){this.createG();const t=this.getObject(),d=(0,p.BIT)(14),l=t.TestBit(d),o=this.getDrawOpt()||t.fOption,s=t._typename===p.clTPolyLine&&("f"===o||"F"===o),h=this.getAxisToSvgFunc(l);this.createAttLine({attr:t}),this.createAttFill({attr:t});let i="";for(let n=0;n<=t.fLastPoint;++n)i+=`${n>0?"L":"M"}${h.x(t.fX[n])},${h.y(t.fY[n])}`;s&&(i+="Z");const r=this.draw_g.append("svg:path").attr("d",i);s?r.call(this.fillatt.func):r.call(this.lineatt.func).style("fill","none"),(0,x.wh)(this,x.Ew),(0,m.X2)(this),this.dx=this.dy=0,this.isndc=l,this.moveDrag=function(n,a){this.dx+=n,this.dy+=a,(0,g.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(n){if(n)return;const a=this.getObject(),e=this.getAxisToSvgFunc(this.isndc);let f="";for(let c=0;c<=a.fLastPoint;++c){const y=this.svgToAxis("x",e.x(a.fX[c])+this.dx,this.isndc),_=this.svgToAxis("y",e.y(a.fY[c])+this.dy,this.isndc);a.fX[c]=y,a.fY[c]=_,f+=`SetPoint(${c},${y},${_});;`}this.submitCanvExec(f+"Notify();;"),this.redraw()}}function L(){const t=this.getObject(),d=0===t.fPhimin&&360===t.fPhimax,l="TCrown"===t._typename;this.createAttLine({attr:t}),this.createAttFill({attr:t}),this.createG();const o=this.getAxisToSvgFunc(),s=o.x(t.fX1),h=o.y(t.fY1),i=l&&t.fR1<=0?o.x(t.fX1+t.fR2)-s:o.x(t.fX1+t.fR1)-s,r=h-o.y(t.fY1+t.fR2);let n="";if(l&&t.fR1>0){const a=i,e=r,f=h-o.y(t.fY1+t.fR1),c=o.x(t.fX1+t.fR2)-s;if(d)n=`M${-a},0A${a},${f},0,1,0,${a},0A${a},${f},0,1,0,${-a},0M${-c},0A${c},${e},0,1,0,${c},0A${c},${e},0,1,0,${-c},0`;else{const y=t.fPhimax-t.fPhimin>=180?1:0,_=t.fPhimin*Math.PI/180,u=t.fPhimax*Math.PI/180,T=Math.round(a*Math.cos(_)),P=Math.round(f*Math.sin(_));n=`M${Math.round(a*Math.cos(u))},${Math.round(f*Math.sin(u))}A${a},${f},0,${y},0,${T},${P}L${Math.round(c*Math.cos(_))},${Math.round(e*Math.sin(_))}A${c},${e},0,${y},1,${Math.round(c*Math.cos(u))},${Math.round(e*Math.sin(u))}Z`}}else if(0===t.fTheta)n=d?`M${-i},0A${i},${r},0,1,0,${i},0A${i},${r},0,1,0,${-i},0Z`:`M0,0L${Math.round(i*Math.cos(t.fPhimin*Math.PI/180))},${Math.round(r*Math.sin(t.fPhimin*Math.PI/180))}A${i},${r},0,1,1,${Math.round(i*Math.cos(t.fPhimax*Math.PI/180))},${Math.round(r*Math.sin(t.fPhimax*Math.PI/180))}Z`;else{const a=Math.cos(t.fTheta*Math.PI/180),e=Math.sin(t.fTheta*Math.PI/180),f=t.fPhimin*Math.PI/180,y=200,_=(t.fPhimax*Math.PI/180-f)/(y-(d?0:1));let u=0,T=0;d||(n="M0,0");for(let P=0;P<y;++P){const w=f+P*_,A=t.fR1*Math.cos(w),b=t.fR2*Math.sin(w),$=o.x(t.fX1+A*a-b*e)-s,v=o.y(t.fY1+A*e+b*a)-h;n?n+=u===$?"v"+(v-T):T===v?"h"+($-u):`l${$-u},${v-T}`:n=`M${$},${v}`,u=$,T=v}n+="Z"}this.x=s,this.y=h,(0,g.bk)(this.draw_g.append("svg:path"),s,h).attr("d",n).call(this.lineatt.func).call(this.fillatt.func),(0,x.wh)(this,x.Ew),(0,m.X2)(this),this.moveDrag=function(a,e){this.x+=a,this.y+=e,(0,g.bk)(this.draw_g.select("path"),this.x,this.y)},this.moveEnd=function(a){if(a)return;const e=this.getObject();e.fX1=this.svgToAxis("x",this.x),e.fY1=this.svgToAxis("y",this.y),this.submitCanvExec(`SetX1(${e.fX1});;SetY1(${e.fY1});;Notify();;`)}}function I(){this.createG();const t=this.getObject(),d=t.fPieSlices.length,l=this.axisToSvg("x",t.fX),o=this.axisToSvg("y",t.fY),s=this.axisToSvg("x",t.fX+t.fRadius)-l,h=this.axisToSvg("y",t.fY+t.fRadius)-o;(0,g.bk)(this.draw_g,l,o);let i=0,r=t.fAngularOffset*Math.PI/180,n=Math.round(s*Math.cos(r)),a=Math.round(h*Math.sin(r));for(let e=0;e<d;e++)i+=t.fPieSlices[e].fValue;for(let e=0;e<d;e++){const f=t.fPieSlices[e];this.createAttLine({attr:f}),this.createAttFill({attr:f}),r+=f.fValue/i*2*Math.PI;const c=Math.round(s*Math.cos(r)),y=Math.round(h*Math.sin(r));this.draw_g.append("svg:path").attr("d",`M0,0L${n},${a}A${s},${h},0,0,0,${c},${y}z`).call(this.lineatt.func).call(this.fillatt.func),n=c,a=y}}function k(){const t=this.getObject(),l=this.getDrawOpt().toUpperCase().indexOf("L")>=0;this.createAttLine({attr:t}),this.createAttFill({attr:t}),!this.fillatt.empty()&&!l&&(this.lineatt.color="none"),this.createG(),this.x1=this.axisToSvg("x",t.fX1),this.x2=this.axisToSvg("x",t.fX2),this.y1=this.axisToSvg("y",t.fY1),this.y2=this.axisToSvg("y",t.fY2),this.borderMode=t.fBorderMode&&t.fBorderSize&&this.fillatt.hasColor()?t.fBorderMode:0,this.borderSize=t.fBorderSize,this.getPathes=()=>{const s=Math.min(this.x1,this.x2),h=Math.min(this.y1,this.y2),i=Math.abs(this.x2-this.x1),r=Math.abs(this.y1-this.y2),n=`M${s},${h}h${i}v${r}h${-i}z`;if(!this.borderMode)return[n];const a=this.borderSize,e=this.borderSize,f=`M${s},${h}h${i}l${-a},${e}h${2*a-i}v${r-2*e}l${-a},${e}z`,c=`M${s+i},${h+r}v${-r}l${-a},${e}v${r-2*e}h${2*a-i}l${-a},${e}z`;return this.borderMode>0?[n,f,c]:[n,c,f]};const o=this.getPathes();this.draw_g.append("svg:path").attr("d",o[0]).call(this.lineatt.func).call(this.fillatt.func),this.borderMode&&(this.draw_g.append("svg:path").attr("d",o[1]).call(this.fillatt.func).style("fill",(0,S.Qh)(this.fillatt.color).brighter(.5).formatHex()),this.draw_g.append("svg:path").attr("d",o[2]).call(this.fillatt.func).style("fill",(0,S.Qh)(this.fillatt.color).darker(.5).formatHex())),(0,x.wh)(this,x.Ew),(0,m.X2)(this),this.moveStart=function(s,h){const i=Math.abs(this.x2-this.x1),r=Math.abs(this.y1-this.y2);this.c_x1=Math.abs(s-this.x2)>.1*i,this.c_x2=Math.abs(s-this.x1)>.1*i,this.c_y1=Math.abs(h-this.y2)>.1*r,this.c_y2=Math.abs(h-this.y1)>.1*r,this.c_x1!==this.c_x2&&this.c_y1&&this.c_y2&&(this.c_y1=this.c_y2=!1),this.c_y1!==this.c_y2&&this.c_x1&&this.c_x2&&(this.c_x1=this.c_x2=!1)},this.moveDrag=function(s,h){this.c_x1&&(this.x1+=s),this.c_x2&&(this.x2+=s),this.c_y1&&(this.y1+=h),this.c_y2&&(this.y2+=h);const i=this.draw_g.selectAll("path").nodes();this.getPathes().forEach((n,a)=>(0,S.Lt)(i[a]).attr("d",n))},this.moveEnd=function(s){if(s)return;const h=this.getObject();let i="";this.c_x1&&(h.fX1=this.svgToAxis("x",this.x1),i+=`SetX1(${h.fX1});;`),this.c_x2&&(h.fX2=this.svgToAxis("x",this.x2),i+=`SetX2(${h.fX2});;`),this.c_y1&&(h.fY1=this.svgToAxis("y",this.y1),i+=`SetY1(${h.fY1});;`),this.c_y2&&(h.fY2=this.svgToAxis("y",this.y2),i+=`SetY2(${h.fY2});;`),this.submitCanvExec(i+"Notify();;")}}function C(){const t=this.getObject(),d=(0,p.BIT)(14);this.isndc=t.TestBit(d),this.createAttMarker({attr:t}),this.createG();const l=this.axisToSvg("x",t.fX,this.isndc),o=this.axisToSvg("y",t.fY,this.isndc),s=this.markeratt.create(l,o);s&&this.draw_g.append("svg:path").attr("d",s).call(this.markeratt.func),(0,x.wh)(this,x.Ew),(0,m.X2)(this),this.dx=this.dy=0,this.moveDrag=function(h,i){this.dx+=h,this.dy+=i,(0,g.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(h){if(h)return;const i=this.getObject();i.fX=this.svgToAxis("x",this.axisToSvg("x",i.fX,this.isndc)+this.dx,this.isndc),i.fY=this.svgToAxis("y",this.axisToSvg("y",i.fY,this.isndc)+this.dy,this.isndc),this.submitCanvExec(`SetX(${i.fX});;SetY(${i.fY});;Notify();;`),this.redraw()}}function B(){const t=this.getObject(),d=this.getAxisToSvgFunc();this.createAttMarker({attr:t}),this.createG();let l="";for(let o=0;o<=t.fLastPoint;++o)l+=this.markeratt.create(d.x(t.fX[o]),d.y(t.fY[o]));l&&this.draw_g.append("svg:path").attr("d",l).call(this.markeratt.func),(0,x.wh)(this,x.Ew),(0,m.X2)(this),this.dx=this.dy=0,this.moveDrag=function(o,s){this.dx+=o,this.dy+=s,(0,g.bk)(this.draw_g.select("path"),this.dx,this.dy)},this.moveEnd=function(o){if(o)return;const s=this.getObject(),h=this.getAxisToSvgFunc();let i="";for(let r=0;r<=s.fLastPoint;++r){const n=this.svgToAxis("x",h.x(s.fX[r])+this.dx),a=this.svgToAxis("y",h.y(s.fY[r])+this.dy);s.fX[r]=n,s.fY[r]=a,i+=`SetPoint(${r},${n},${a});;`}this.submitCanvExec(i+"Notify();;"),this.redraw()}}function R(t,d,l){const o=new g.b8(t),s=o.selectDom(),h=s.append("img").attr("src",d.fName).attr("title",d.fTitle||d.fName);return l&&l.indexOf("scale")>=0?h.style("width","100%").style("height","100%"):l&&l.indexOf("center")>=0&&(s.style("position","relative"),h.attr("style","margin: 0; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);")),o.setTopPainter(),o}}}]);