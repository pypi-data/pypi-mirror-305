"use strict";(self.webpackChunk_jupyrdf_jupyter_elk=self.webpackChunk_jupyrdf_jupyter_elk||[]).push([[625],{8674:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ServerActionHandlerRegistry=void 0,t.ServerActionHandlerRegistry=class{constructor(){this.handlers=new Map}getHandler(e){return this.handlers.get(e)}onAction(e,t){this.handlers.has(e)?this.handlers.get(e).push(t):this.handlers.set(e,[t])}removeActionHandler(e,t){const s=this.handlers.get(e);if(s){const e=s.indexOf(t);e>=0&&s.splice(e,1)}}}},238:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagramServer=void 0;const i=s(3130),o=s(4675),r=s(9494);t.DiagramServer=class{constructor(e,t){this.state={currentRoot:{type:"NONE",id:"ROOT"},revision:0},this.requests=new Map,this.dispatch=e,this.diagramGenerator=t.DiagramGenerator,this.layoutEngine=t.ModelLayoutEngine,this.actionHandlerRegistry=t.ServerActionHandlerRegistry}setModel(e){return e.revision=++this.state.revision,this.state.currentRoot=e,this.submitModel(e,!1)}updateModel(e){return e.revision=++this.state.revision,this.state.currentRoot=e,this.submitModel(e,!0)}get needsClientLayout(){return!this.state.options||void 0===this.state.options.needsClientLayout||!!this.state.options.needsClientLayout}get needsServerLayout(){return!(!this.state.options||void 0===this.state.options.needsServerLayout||!this.state.options.needsServerLayout)}accept(e){if((0,i.isResponseAction)(e)){const t=e.responseId,s=this.requests.get(t);if(s){if(this.requests.delete(t),e.kind===i.RejectAction.KIND){const t=e;s.reject(new Error(t.message)),console.warn(`Request with id ${e.responseId} failed: ${t.message}`,t.detail)}else s.resolve(e);return Promise.resolve()}console.info("No matching request for response:",e)}return this.handleAction(e)}request(e){e.requestId||(e.requestId="server_"+(0,i.generateRequestId)());const t=new o.Deferred;return this.requests.set(e.requestId,t),this.dispatch(e).catch((s=>{this.requests.delete(e.requestId),t.reject(s)})),t.promise}rejectRemoteRequest(e,t){e&&(0,i.isRequestAction)(e)&&this.dispatch({kind:i.RejectAction.KIND,responseId:e.requestId,message:t.message,detail:t.stack})}handleAction(e){var t,s;const o=null===(t=this.actionHandlerRegistry)||void 0===t?void 0:t.getHandler(e.kind);if(o&&1===o.length)return null!==(s=o[0](e,this.state,this))&&void 0!==s?s:Promise.resolve();if(o&&o.length>1)return Promise.all(o.map((t=>{var s;return null!==(s=t(e,this.state,this))&&void 0!==s?s:Promise.resolve()})));switch(e.kind){case i.RequestModelAction.KIND:return this.handleRequestModel(e);case i.ComputedBoundsAction.KIND:return this.handleComputedBounds(e);case i.LayoutAction.KIND:return this.handleLayout(e)}return console.warn(`Unhandled action from client: ${e.kind}`),Promise.resolve()}async handleRequestModel(e){var t;this.state.options=e.options;try{const s=await this.diagramGenerator.generate({options:null!==(t=this.state.options)&&void 0!==t?t:{},state:this.state});s.revision=++this.state.revision,this.state.currentRoot=s,await this.submitModel(this.state.currentRoot,!1,e)}catch(t){this.rejectRemoteRequest(e,t),console.error("Failed to generate diagram:",t)}}async submitModel(e,t,s){if(this.needsClientLayout)if(this.needsServerLayout){const o=i.RequestBoundsAction.create(e),n=await this.request(o),a=this.state.currentRoot;n.revision===a.revision?((0,r.applyBounds)(a,n),await this.doSubmitModel(a,t,s)):this.rejectRemoteRequest(s,new Error(`Model revision does not match: ${n.revision}`))}else this.dispatch({kind:i.RequestBoundsAction.KIND,newRoot:e});else await this.doSubmitModel(e,t,s)}async doSubmitModel(e,t,s){if(e.revision!==this.state.revision)return;this.needsServerLayout&&this.layoutEngine&&(e=await this.layoutEngine.layout(e));const o=e.type;if(s&&s.kind===i.RequestModelAction.KIND){const t=s.requestId,o=i.SetModelAction.create(e,t);await this.dispatch(o)}else t&&o===this.state.lastSubmittedModelType?await this.dispatch({kind:i.UpdateModelAction.KIND,newRoot:e,cause:s}):await this.dispatch({kind:i.SetModelAction.KIND,newRoot:e});this.state.lastSubmittedModelType=o}handleComputedBounds(e){return e.revision!==this.state.currentRoot.revision?Promise.reject():((0,r.applyBounds)(this.state.currentRoot,e),Promise.resolve())}async handleLayout(e){if(this.layoutEngine){if(!this.needsServerLayout){let e=(0,r.cloneModel)(this.state.currentRoot);e=await this.layoutEngine.layout(e),e.revision=++this.state.revision,this.state.currentRoot=e}await this.doSubmitModel(this.state.currentRoot,!0,e)}}}},1169:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9625:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,o)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),o=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),o(s(8674),t),o(s(3130),t),o(s(238),t),o(s(1169),t),o(s(9348),t),o(s(4675),t),o(s(8039),t),o(s(5165),t),o(s(9494),t),o(s(5508),t)},9348:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isZoomable=t.isScrollable=void 0;const i=s(5508);t.isScrollable=function(e){return(0,i.hasOwnProperty)(e,"scroll")},t.isZoomable=function(e){return(0,i.hasOwnProperty)(e,"zoom")}},5165:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})}}]);
//# sourceMappingURL=625.1744f8766b777079f65a.js.map?v=1744f8766b777079f65a